{"version":3,"file":"panel-teamdropdown.js","names":["PSTeambuilder","exportPackedTeam","team","newFormat","sets","Teams","unpack","packedTeam","dex","Dex","forFormat","format","splitPrefix","buffer","delimiter","prefixOffset","arguments","length","undefined","delimIndex","indexOf","slice","splitLast","lastIndexOf","importTeamBackup","teams","lines","split","curTeam","curSet","shift","pop","_i2","line","trim","startsWith","pack","push","name","folder","key","iconCache","isBox","_ref","_this$splitPrefix","includes","PS","unpackLine","species","gender","moves","parseExportedTeamLine","dragStart","ev","_ev$currentTarget","href","currentTarget","getAttribute","byKey","dataTransfer","effectAllowed","setData","filename","$","replace","urlprefix","contents","downloadurl","encodeURIComponent","window","btoa","unescape","console","log","dragging","type","draggedTeam","TeamBox","props","unpackSpeciesOnly","map","pokemon","PSIcon","preact","h","modid","className","button","value","noLink","draggable","onDragStart","onClick","TeamDropdownPanel","_PSRoomPanel","_this","_len","args","Array","_key","call","apply","concat","gen","setFormat","target","preventDefault","stopImmediatePropagation","forceUpdate","click","e","curTarget","tagName","parentElement","loadTeam","chooseParentValue","_inheritsLoose","_proto","prototype","getTeams","_this2","list","filter","render","_this3","room","parentElem","PSPanelWrapper","baseFormat","isFirstLoad","availableWidth","document","body","offsetWidth","width","teamBuckets","_i4","_teams2","teamList","baseGen","genList","_i6","_PS$teams$list2","hasOtherGens","sort","isEmpty","style","display","PSRoomPanel","id","routes","location","noURL","FormatDropdownPanel","_PSRoomPanel2","_this4","_len2","_key2","search","_curTarget","updateSearch","toggleGen","_proto2","_this5","formatsLoaded","BattleFormats","i","curGen","searchBar","placeholder","autocomplete","onInput","onChange","selectType","curFormat","toID","formats","Object","values","challengeShow","searchShow","tournamentShow","curSection","curColumnNum","curColumn","columns","searchID","_i8","column","section","unshift","Math","max","noResults","starredPrefs","prefs","starredformats","starred","keys","reverse","starredDone","test","addRoomType"],"sources":["../src/panel-teamdropdown.tsx"],"sourcesContent":["/**\r\n * Team Selector Panel\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\nimport { PS, type Team } from \"./client-main\";\r\nimport { PSIcon, PSPanelWrapper, PSRoomPanel } from \"./panels\";\r\nimport { Dex, toID, type ID } from \"./battle-dex\";\r\nimport { Teams } from \"./battle-teams\";\r\n\r\nexport class PSTeambuilder {\r\n\tstatic exportPackedTeam(team: Team, newFormat?: boolean) {\r\n\t\tconst sets = Teams.unpack(team.packedTeam);\r\n\t\tconst dex = Dex.forFormat(team.format);\r\n\t\treturn Teams.export(sets, dex, newFormat);\r\n\t}\r\n\tstatic splitPrefix(buffer: string, delimiter: string, prefixOffset = 0): [string, string] {\r\n\t\tconst delimIndex = buffer.indexOf(delimiter);\r\n\t\tif (delimIndex < 0) return ['', buffer];\r\n\t\treturn [buffer.slice(prefixOffset, delimIndex), buffer.slice(delimIndex + delimiter.length)];\r\n\t}\r\n\tstatic splitLast(buffer: string, delimiter: string): [string, string] {\r\n\t\tconst delimIndex = buffer.lastIndexOf(delimiter);\r\n\t\tif (delimIndex < 0) return [buffer, ''];\r\n\t\treturn [buffer.slice(0, delimIndex), buffer.slice(delimIndex + delimiter.length)];\r\n\t}\r\n\tstatic importTeamBackup(buffer: string): Team[] {\r\n\t\tconst teams: Team[] = [];\r\n\t\tconst lines = buffer.split(\"\\n\");\r\n\r\n\t\tlet curTeam: Team | null = null;\r\n\t\tlet sets: Dex.PokemonSet[] | null = null;\r\n\r\n\t\tlet curSet: Dex.PokemonSet | null = null;\r\n\r\n\t\twhile (lines.length && !lines[0]) lines.shift();\r\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\r\n\r\n\t\tfor (let line of lines) {\r\n\t\t\tline = line.trim();\r\n\t\t\tif (line === '' || line === '---') {\r\n\t\t\t\tcurSet = null;\r\n\t\t\t} else if (line.startsWith('===')) {\r\n\t\t\t\tif (curTeam) {\r\n\t\t\t\t\t// not the first team, store the previous team\r\n\t\t\t\t\tcurTeam.packedTeam = Teams.pack(sets);\r\n\t\t\t\t\tteams.push(curTeam);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurTeam = {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tformat: '' as ID,\r\n\t\t\t\t\tpackedTeam: '',\r\n\t\t\t\t\tfolder: '',\r\n\t\t\t\t\tkey: '',\r\n\t\t\t\t\ticonCache: '',\r\n\t\t\t\t\tisBox: false,\r\n\t\t\t\t};\r\n\t\t\t\tsets = [];\r\n\r\n\t\t\t\tline = line.slice(3, -3).trim();\r\n\t\t\t\t[curTeam.format, line] = this.splitPrefix(line, ']', 1) as [ID, string];\r\n\t\t\t\tif (!curTeam.format) curTeam.format = 'gen8' as ID;\r\n\t\t\t\telse if (!curTeam.format.startsWith('gen')) curTeam.format = `gen6${curTeam.format}` as ID;\r\n\r\n\t\t\t\t[curTeam.folder, curTeam.name] = this.splitPrefix(line, '/');\r\n\t\t\t} else if (line.includes('|')) {\r\n\t\t\t\tif (curTeam) {\r\n\t\t\t\t\t// not the first team, store the previous team\r\n\t\t\t\t\tcurTeam.packedTeam = Teams.pack(sets);\r\n\t\t\t\t\tteams.push(curTeam);\r\n\t\t\t\t}\r\n\t\t\t\tcurTeam = null;\r\n\t\t\t\tcurSet = null;\r\n\t\t\t\tconst team = PS.teams.unpackLine(line);\r\n\t\t\t\tif (team) teams.push(team);\r\n\t\t\t} else if (!curSet) {\r\n\t\t\t\tif (!sets) continue; // corruption\r\n\t\t\t\tcurSet = {\r\n\t\t\t\t\tname: '', species: '', gender: '',\r\n\t\t\t\t\tmoves: [],\r\n\t\t\t\t};\r\n\t\t\t\tsets.push(curSet);\r\n\t\t\t\tTeams.parseExportedTeamLine(line, true, curSet);\r\n\t\t\t} else {\r\n\t\t\t\tTeams.parseExportedTeamLine(line, false, curSet);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (curTeam) {\r\n\t\t\tcurTeam.packedTeam = Teams.pack(sets);\r\n\t\t\tteams.push(curTeam);\r\n\t\t}\r\n\t\treturn teams;\r\n\t}\r\n\r\n\tstatic draggedTeam: Team | null = null;\r\n\tstatic dragStart(ev: DragEvent) {\r\n\t\tconst href = (ev.currentTarget as HTMLAnchorElement)?.getAttribute('href');\r\n\t\tconst team = href ? PS.teams.byKey[href.slice(5)] : null;\r\n\t\tif (!team) return;\r\n\r\n\t\tconst dataTransfer = ev.dataTransfer;\r\n\t\tif (dataTransfer) {\r\n\t\t\tdataTransfer.effectAllowed = 'copyMove';\r\n\t\t\tdataTransfer.setData(\"text/plain\", \"[Team] \" + team.name);\r\n\t\t\tlet filename = team.name;\r\n\t\t\tif (team.format) filename = '[' + team.format + '] ' + filename;\r\n\t\t\tfilename = $.trim(filename).replace(/[\\\\/]+/g, '') + '.txt';\r\n\t\t\tconst urlprefix = \"data:text/plain;base64,\";\r\n\t\t\tconst contents = PSTeambuilder.exportPackedTeam(team).replace(/\\n/g, '\\r\\n');\r\n\t\t\tconst downloadurl = \"text/plain:\" + filename + \":\" + urlprefix + encodeURIComponent(window.btoa(unescape(encodeURIComponent(contents))));\r\n\t\t\tconsole.log(downloadurl);\r\n\t\t\tdataTransfer.setData(\"DownloadURL\", downloadurl);\r\n\t\t}\r\n\r\n\t\tPS.dragging = { type: 'team', team, folder: null };\r\n\t\t// app.draggingRoom = this.id;\r\n\t\t// app.draggingLoc = parseInt(e.currentTarget.dataset.value, 10);\r\n\t\t// var elOffset = $(e.currentTarget).offset();\r\n\t\t// app.draggingOffsetX = e.originalEvent.pageX - elOffset.left;\r\n\t\t// app.draggingOffsetY = e.originalEvent.pageY - elOffset.top;\r\n\t\t// this.finalOffset = null;\r\n\t\t// setTimeout(function () {\r\n\t\t// \t$(e.currentTarget).parent().addClass('dragging');\r\n\t\t// }, 0);\r\n\t}\r\n}\r\n\r\nexport function TeamBox(props: {\r\n\tteam: Team | null,\r\n\tnoLink?: boolean,\r\n\tbutton?: boolean,\r\n\tonClick?: () => void,\r\n}) {\r\n\tconst team = props.team;\r\n\tlet contents;\r\n\tif (team) {\r\n\t\tteam.iconCache ||= team.packedTeam ? (\r\n\t\t\tTeams.unpackSpeciesOnly(team.packedTeam).map(\r\n\t\t\t\t// can't use <PSIcon>, weird interaction with iconCache\r\n\t\t\t\t// don't try this at home; I'm a trained professional\r\n\t\t\t\tpokemon => PSIcon({ pokemon })\r\n\t\t\t)\r\n\t\t) : (\r\n\t\t\t<em>(empty {team.isBox ? 'box' : 'team'})</em>\r\n\t\t);\r\n\t\tlet format = team.format as string;\r\n\t\tif (format.startsWith(Dex.modid)) format = format.slice(4);\r\n\t\tformat = (format ? `[${format}] ` : ``) + (team.folder ? `${team.folder}/` : ``);\r\n\t\tcontents = [\r\n\t\t\t<strong>{team.isBox && <i class=\"fa fa-archive\"></i>} {format && <span>{format}</span>}{team.name}</strong>,\r\n\t\t\t<small>{team.iconCache}</small>,\r\n\t\t];\r\n\t} else {\r\n\t\tcontents = [\r\n\t\t\t<em>Select a team</em>,\r\n\t\t];\r\n\t}\r\n\tconst className = `team${team?.isBox ? ' pc-box' : ''}`;\r\n\tif (props.button) {\r\n\t\treturn <button class={className} value={team ? team.key : ''}>\r\n\t\t\t{contents}\r\n\t\t</button>;\r\n\t}\r\n\tif (props.noLink) {\r\n\t\treturn <div class={className}>\r\n\t\t\t{contents}\r\n\t\t</div>;\r\n\t}\r\n\treturn <a\r\n\t\thref={`team-${team ? team.key : ''}`} class={className} draggable\r\n\t\tonDragStart={PSTeambuilder.dragStart} onClick={props.onClick}\r\n\t>\r\n\t\t{contents}\r\n\t</a>;\r\n}\r\n\r\n/**\r\n * Team selector popup\r\n */\r\n\r\nclass TeamDropdownPanel extends PSRoomPanel {\r\n\tstatic readonly id = 'teamdropdown';\r\n\tstatic readonly routes = ['teamdropdown'];\r\n\tstatic readonly location = 'semimodal-popup';\r\n\tstatic readonly noURL = true;\r\n\tgen = '';\r\n\tformat: string | null = null;\r\n\tgetTeams() {\r\n\t\tif (!this.format && !this.gen) return PS.teams.list;\r\n\t\treturn PS.teams.list.filter(team => {\r\n\t\t\tif (this.gen && !team.format.startsWith(this.gen)) return false;\r\n\t\t\tif (this.format && team.format !== this.format) return false;\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\tsetFormat = (ev: MouseEvent) => {\r\n\t\tconst target = ev.currentTarget as HTMLButtonElement;\r\n\t\tthis.format = (target.name === 'format' && target.value) || '';\r\n\t\tthis.gen = (target.name === 'gen' && target.value) || '';\r\n\t\tev.preventDefault();\r\n\t\tev.stopImmediatePropagation();\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\tclick = (e: MouseEvent) => {\r\n\t\tlet curTarget = e.target as HTMLElement | null;\r\n\t\tlet target;\r\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\r\n\t\t\tif (curTarget.tagName === 'BUTTON') {\r\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\r\n\t\t\t}\r\n\t\t\tcurTarget = curTarget.parentElement;\r\n\t\t}\r\n\t\tif (!target) return;\r\n\r\n\t\tPS.teams.loadTeam(PS.teams.byKey[target.value], true);\r\n\t\tthis.chooseParentValue(target.value);\r\n\t};\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\tif (!room.parentElem) {\r\n\t\t\treturn <PSPanelWrapper room={room}>\r\n\t\t\t\t<p>Error: You tried to open a team selector, but you have nothing to select a team for.</p>\r\n\t\t\t</PSPanelWrapper>;\r\n\t\t}\r\n\t\tconst baseFormat = room.parentElem.getAttribute('data-format') || Dex.modid;\r\n\t\tlet isFirstLoad = this.format === null;\r\n\t\tif (isFirstLoad) {\r\n\t\t\tthis.format = baseFormat;\r\n\t\t}\r\n\t\tlet teams = this.getTeams();\r\n\t\tif (!teams.length && this.format && isFirstLoad) {\r\n\t\t\tthis.gen = this.format.slice(0, 4);\r\n\t\t\tthis.format = '';\r\n\t\t\tteams = this.getTeams();\r\n\t\t}\r\n\t\tif (!teams.length && this.gen && isFirstLoad) {\r\n\t\t\tthis.gen = '';\r\n\t\t\tteams = this.getTeams();\r\n\t\t}\r\n\r\n\t\tlet availableWidth = document.body.offsetWidth;\r\n\t\tlet width = 307;\r\n\t\tif (availableWidth > 636) width = 613;\r\n\t\tif (availableWidth > 945) width = 919;\r\n\r\n\t\tlet teamBuckets: { [folder: string]: Team[] } = {};\r\n\t\tfor (const team of teams) {\r\n\t\t\tconst list = teamBuckets[team.folder] || (teamBuckets[team.folder] = []);\r\n\t\t\tlist.push(team);\r\n\t\t}\r\n\r\n\t\tlet teamList = [];\r\n\r\n\t\tconst baseGen = baseFormat.slice(0, 4);\r\n\t\tlet genList: string[] = [];\r\n\t\tfor (const team of PS.teams.list) {\r\n\t\t\tconst gen = team.format.slice(0, 4);\r\n\t\t\tif (gen && !genList.includes(gen)) genList.push(gen);\r\n\t\t}\r\n\t\tconst hasOtherGens = genList.length > 1 || genList[0] !== baseGen;\r\n\r\n\t\tteamList.push(<p>\r\n\t\t\t{baseFormat.length > 4 && (\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass={'button' + (baseFormat === this.format ? ' disabled' : '')}\r\n\t\t\t\t\tonClick={this.setFormat} name=\"format\" value={baseFormat}\r\n\t\t\t\t>\r\n\t\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseFormat.slice(0, 4)}] {baseFormat.slice(4)}\r\n\t\t\t\t</button>\r\n\t\t\t)} {}\r\n\t\t\t<button\r\n\t\t\t\tclass={'button' + (baseGen === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseGen}\r\n\t\t\t>\r\n\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseGen}] <em>(uncategorized)</em>\r\n\t\t\t</button> {}\r\n\t\t\t<button\r\n\t\t\t\tclass={'button' + (baseGen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={baseGen}\r\n\t\t\t>\r\n\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseGen}] <em>(all)</em>\r\n\t\t\t</button> {}\r\n\t\t\t{hasOtherGens && !this.gen && (\r\n\t\t\t\t<button class=\"button\" onClick={this.setFormat} name=\"gen\" value={baseGen}>Other gens</button>\r\n\t\t\t)}\r\n\t\t</p>);\r\n\r\n\t\tif (hasOtherGens && this.gen) {\r\n\t\t\tteamList.push(<h2>Other gens</h2>);\r\n\t\t\tteamList.push(<p>{genList.sort().map(gen => [\r\n\t\t\t\t<button class={'button' + (gen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={gen}>\r\n\t\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{gen}] <em>(all)</em>\r\n\t\t\t\t</button>,\r\n\t\t\t\t\" \",\r\n\t\t\t])}</p>);\r\n\t\t}\r\n\r\n\t\tlet isEmpty = true;\r\n\t\tfor (let folder in teamBuckets) {\r\n\t\t\tif (folder && (this.gen || this.format)) {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open\" aria-hidden></i> {folder} + {}\r\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> {this.format || this.gen}\r\n\t\t\t\t</h2>);\r\n\t\t\t} else if (folder) {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open\" aria-hidden></i> {folder}\r\n\t\t\t\t</h2>);\r\n\t\t\t} else if (this.gen || this.format) {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> {this.format || this.gen}\r\n\t\t\t\t</h2>);\r\n\t\t\t} else {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> Teams not in any folders\r\n\t\t\t\t</h2>);\r\n\t\t\t}\r\n\t\t\tteamList.push(<ul class=\"teamdropdown\" onClick={this.click}>\r\n\t\t\t\t{teamBuckets[folder].map(team => <li key={team.key} style={{ display: 'inline-block' }}>\r\n\t\t\t\t\t<TeamBox team={team} button />\r\n\t\t\t\t</li>)}\r\n\t\t\t</ul>);\r\n\t\t\tisEmpty = false;\r\n\t\t}\r\n\r\n\t\treturn <PSPanelWrapper room={room} width={width}><div class=\"pad\">\r\n\t\t\t{teamList}\r\n\t\t\t{isEmpty && <p><em>No teams found</em></p>}\r\n\t\t</div></PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nexport interface FormatData {\r\n\tid: ID;\r\n\tname: string;\r\n\tteam?: 'preset' | null;\r\n\tsection: string;\r\n\tcolumn: number;\r\n\tsearchShow?: boolean;\r\n\tchallengeShow?: boolean;\r\n\ttournamentShow?: boolean;\r\n\trated: boolean;\r\n\tteambuilderLevel?: number | null;\r\n\tteambuilderFormat?: ID;\r\n\tbattleFormat?: string;\r\n\tisTeambuilderFormat: boolean;\r\n\teffectType: 'Format';\r\n}\r\n\r\ndeclare const BattleFormats: { [id: string]: FormatData };\r\n\r\nexport type SelectType = 'teambuilder' | 'challenge' | 'search' | 'tournament';\r\nclass FormatDropdownPanel extends PSRoomPanel {\r\n\tstatic readonly id = 'formatdropdown';\r\n\tstatic readonly routes = ['formatdropdown'];\r\n\tstatic readonly location = 'semimodal-popup';\r\n\tstatic readonly noURL = true;\r\n\tgen = '' as ID;\r\n\tformat: string | null = null;\r\n\tsearch = '';\r\n\tclick = (e: MouseEvent) => {\r\n\t\tlet curTarget = e.target as HTMLElement | null;\r\n\t\tlet target;\r\n\t\tif (curTarget?.tagName === 'I') return;\r\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\r\n\t\t\tif (curTarget.tagName === 'BUTTON') {\r\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\r\n\t\t\t}\r\n\t\t\tcurTarget = curTarget.parentElement;\r\n\t\t}\r\n\t\tif (!target) return;\r\n\r\n\t\tthis.chooseParentValue(target.value);\r\n\t};\r\n\tupdateSearch = (ev: Event) => {\r\n\t\tthis.search = (ev.currentTarget as HTMLInputElement).value;\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\ttoggleGen = (ev: Event) => {\r\n\t\tconst target = ev.currentTarget as HTMLButtonElement;\r\n\t\tthis.gen = this.gen === target.value ? '' as ID : target.value as ID;\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\tif (!room.parentElem) {\r\n\t\t\treturn <PSPanelWrapper room={room}>\r\n\t\t\t\t<p>Error: You tried to open a format selector, but you have nothing to select a format for.</p>\r\n\t\t\t</PSPanelWrapper>;\r\n\t\t}\r\n\r\n\t\tlet formatsLoaded = !!window.BattleFormats;\r\n\t\tif (formatsLoaded) {\r\n\t\t\tformatsLoaded = false;\r\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\t\tfor (let i in window.BattleFormats) {\r\n\t\t\t\tformatsLoaded = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst curGen = (gen: string) => this.gen === gen ? ' cur' : '';\r\n\t\tconst searchBar = <div style=\"margin-bottom: 0.5em\">\r\n\t\t\t<input\r\n\t\t\t\ttype=\"search\" name=\"search\" placeholder=\"Search formats\" class=\"textbox autofocus\" autocomplete=\"off\"\r\n\t\t\t\tonInput={this.updateSearch} onChange={this.updateSearch}\r\n\t\t\t/> {}\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen9\" class={`button button-first${curGen('gen9')}`}>Gen 9</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen8\" class={`button button-middle${curGen('gen8')}`}>8</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen7\" class={`button button-middle${curGen('gen7')}`}>7</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen6\" class={`button button-middle${curGen('gen6')}`}>6</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen5\" class={`button button-middle${curGen('gen5')}`}>5</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen4\" class={`button button-middle${curGen('gen4')}`}>4</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen3\" class={`button button-middle${curGen('gen3')}`}>3</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen2\" class={`button button-middle${curGen('gen2')}`}>2</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen1\" class={`button button-last${curGen('gen1')}`}>1</button>\r\n\t\t</div>;\r\n\t\tif (!formatsLoaded) {\r\n\t\t\treturn <PSPanelWrapper room={room}><div class=\"pad\">\r\n\t\t\t\t{searchBar}\r\n\t\t\t\t<p>Loading...</p>\r\n\t\t\t</div></PSPanelWrapper>;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * 'challenge' hides search-only formats, and 'search' hides challenge-only\r\n\t\t * formats. 'teambuilder' shows teambuilder formats (removing parentheses\r\n\t\t * from format names).\r\n\t\t */\r\n\t\tconst selectType: SelectType = (\r\n\t\t\troom.parentElem.getAttribute('data-selecttype') as any || 'challenge'\r\n\t\t);\r\n\t\tconst curFormat = toID((room.parentElem as HTMLButtonElement).value);\r\n\t\tconst formats = Object.values(BattleFormats).filter(format => {\r\n\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return false;\r\n\t\t\tif (selectType === 'search' && format.searchShow === false) return false;\r\n\t\t\tif (selectType === 'tournament' && format.tournamentShow === false) return false;\r\n\t\t\tif (selectType === 'teambuilder' && format.team) return false;\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tlet curSection = '';\r\n\t\tlet curColumnNum = 0;\r\n\t\tlet curColumn: ({ id: ID, name: string, section: string } | { id: null, section: string })[] = [];\r\n\t\tconst columns = [curColumn];\r\n\t\tconst searchID = toID(this.search);\r\n\t\tfor (const format of formats) {\r\n\t\t\tif (searchID && !toID(format.name).includes(searchID)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (this.gen && !format.id.startsWith(this.gen)) continue;\r\n\r\n\t\t\tif (format.column !== curColumnNum) {\r\n\t\t\t\tif (curColumn.length) {\r\n\t\t\t\t\tcurColumn = [];\r\n\t\t\t\t\tcolumns.push(curColumn);\r\n\t\t\t\t}\r\n\t\t\t\tcurColumnNum = format.column;\r\n\t\t\t}\r\n\t\t\tif (format.section !== curSection) {\r\n\t\t\t\tcurSection = format.section;\r\n\t\t\t\tif (curSection) {\r\n\t\t\t\t\tcurColumn.push({ id: null, section: curSection });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcurColumn.push(format);\r\n\t\t}\r\n\t\tif (this.gen && selectType === 'teambuilder') {\r\n\t\t\tcolumns[0].unshift({\r\n\t\t\t\tid: this.gen,\r\n\t\t\t\tname: `[Gen ${this.gen.slice(3)}]`,\r\n\t\t\t\tsection: 'No Format',\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst width = Math.max(columns.length, 2.1) * 225 + 30;\r\n\t\tconst noResults = curColumn.length === 0;\r\n\t\tconst starredPrefs = PS.prefs.starredformats || {};\r\n\t\t// reverse because the newest starred format should be the default\r\n\t\tconst starred = Object.keys(starredPrefs).filter(id => starredPrefs[id] === true).reverse();\r\n\t\tlet starredDone = false;\r\n\r\n\t\treturn <PSPanelWrapper room={room} width={width}><div class=\"pad\">\r\n\t\t\t{searchBar}\r\n\t\t\t{columns.map(column => (\r\n\t\t\t\t<ul class=\"options\" onClick={this.click}>\r\n\t\t\t\t\t{!starredDone && starred?.map((id, i) => {\r\n\t\t\t\t\t\tif (this.gen && !id.startsWith(this.gen)) return null;\r\n\t\t\t\t\t\tlet format = BattleFormats[id] as FormatData | undefined;\r\n\t\t\t\t\t\tif (/^gen[1-9]$/.test(id)) {\r\n\t\t\t\t\t\t\tformat ||= {\r\n\t\t\t\t\t\t\t\tid: id as ID,\r\n\t\t\t\t\t\t\t\tname: `[Gen ${id.slice(3)}]`,\r\n\t\t\t\t\t\t\t\tsection: 'No Format',\r\n\t\t\t\t\t\t\t\tchallengeShow: false,\r\n\t\t\t\t\t\t\t\tsearchShow: false,\r\n\t\t\t\t\t\t\t} as any;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!format) return null;\r\n\t\t\t\t\t\tif (i === starred.length - 1) starredDone = true;\r\n\t\t\t\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return null;\r\n\t\t\t\t\t\tif (selectType === 'search' && format.searchShow === false) return null;\r\n\t\t\t\t\t\tif (selectType === 'teambuilder' && format.team) return null;\r\n\t\t\t\t\t\treturn <li><button value={format.name} class={`option${curFormat === format.id ? ' cur' : ''}`}>\r\n\t\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\r\n\t\t\t\t\t\t\t{format.section === 'No Format' && <em> (uncategorized)</em>}\r\n\t\t\t\t\t\t\t<i class=\"star fa fa-star cur\" data-cmd={`/unstar ${format.id}`}></i>\r\n\t\t\t\t\t\t</button></li>;\r\n\t\t\t\t\t})}\r\n\t\t\t\t\t{column.map(format => {\r\n\t\t\t\t\t\t// do not include starred formats\r\n\t\t\t\t\t\tif (starred.includes(format.id || '')) return '';\r\n\t\t\t\t\t\tif (format.id) {\r\n\t\t\t\t\t\t\treturn <li><button\r\n\t\t\t\t\t\t\t\tvalue={format.name}\r\n\t\t\t\t\t\t\t\tclass={`option${curFormat === format.id ? ' cur' : ''}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\r\n\t\t\t\t\t\t\t\t{format.section === 'No Format' && <em> (uncategorized)</em>}\r\n\t\t\t\t\t\t\t\t<i class=\"star fa fa-star-o\" data-cmd={`/star ${format.id}`}></i>\r\n\t\t\t\t\t\t\t</button></li>;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn <li><h3>{format.section}</h3></li>;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t))}\r\n\t\t\t{noResults && <p>\r\n\t\t\t\t<em>No formats{!!searchID && ` matching \"${searchID}\"`} found</em>\r\n\t\t\t</p>}\r\n\t\t\t<div style=\"float: left\"></div>\r\n\t\t</div></PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nPS.addRoomType(TeamDropdownPanel, FormatDropdownPanel);\r\n"],"mappings":"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","ignoreList":[]}