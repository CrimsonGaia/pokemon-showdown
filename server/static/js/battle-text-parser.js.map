{"version":3,"file":"battle-text-parser.js","names":["getBattleTextDict","_bt$default","bt","globalThis","BattleText","getBattleTextDefault","_dict$default","dict","BattleTextParser","perspective","arguments","length","undefined","p1","p2","p3","p4","gen","turn","curLineSection","lowercaseRegExp","pokemonName","pokemon","startsWith","charAt","escapeReplace","slice","trim","parseLine","line","noDefault","index","indexOf","cmd","index2a","index2b","index3b","split","parseBattleLine","args","kwArgs","lastArg","bracketPos","key","value","slot","pop","upgradeArgs","parseNameParts","text","group","test","name","atIndex","status","away","_ref","item","move","number","ability","_args","effect","arg3","arg4","target","of","id","effectId","block","from","includes","ability2","_args2","_proto","prototype","extractMessage","buf","out","_i2","_buf$split2","_BattleTextParser$par","parseArgs","fixLowercase","input","prefixes","map","templateId","def","template","toUpperCase","bracketIndex","filter","prefix","escapeRegExp","join","RegExp","replace","match","side","isNear","allyID","pokemonFull","details","nickname","species","trainer","sideid","team","isFar","opposingTeam","own","party","opposingParty","toID","type","_len","namespaces","Array","_key","_i4","namespace","i","Dex","curTemplate","maybeAbility","holder","abilityActivation","stat","entry","statName","lineSection","premajor","postmajor","major","sectionBreak","prevSection","curSection","noSectionBreak","parseArgsInner","num","parseInt","Number","_this$pokemonFull","fullname","_this$pokemonFull2","arg2","newSpecies","newSpeciesId","templateName","msg","line1","isNaN","zeffect","message","_kwArgs$from","already","fatigue","damage","upkeep","_kwArgs$from2","oldAbility","fail","_ref2","hasTarget","eat","weaken","_kwArgs$from3","_kwArgs$from4","thaw","weather","_ref3","fromitem","source","percentage","partiallytrapped","wisher","_kwArgs$from5","amount","multiple","spread","attacker","blocker","heavy","weak","forme","ohko","template2","require","global"],"sources":["../src/battle-text-parser.ts"],"sourcesContent":["/**\r\n * Text parser\r\n *\r\n * No dependencies\r\n * Optional dependency: BattleText\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\n\r\nimport { Dex, toID, type ID } from \"./battle-dex\";\r\n// Optional global dependency provided by PS client builds.\r\n// Normalize different bundler outputs.\r\ndeclare const BattleText: any;\r\n\r\nfunction getBattleTextDict(): any | null {\r\n  const bt = (globalThis as any).BattleText;\r\n  if (!bt) return null;\r\n  return bt.default ?? bt; // support both shapes\r\n}\r\n\r\nfunction getBattleTextDefault(): any | null {\r\n  const dict = getBattleTextDict();\r\n  if (!dict) return null;\r\n  return dict.default ?? null;\r\n}\r\nexport type Args = [string, ...string[]];\r\nexport type KWArgs = { [kw: string]: string };\r\nexport type SideID = 'p1' | 'p2' | 'p3' | 'p4';\r\n\r\nexport class BattleTextParser {\r\n\t/** escaped for string.replace */\r\n\tp1 = \"Player 1\";\r\n\t/** escaped for string.replace */\r\n\tp2 = \"Player 2\";\r\n\t/** escaped for string.replace */\r\n\tp3 = \"Player 3\";\r\n\t/** escaped for string.replace */\r\n\tp4 = \"Player 4\";\r\n\tperspective: SideID;\r\n\tgen = 9;\r\n\tturn = 0;\r\n\tcurLineSection: 'break' | 'preMajor' | 'major' | 'postMajor' = 'break';\r\n\tlowercaseRegExp: RegExp | null | undefined = undefined;\r\n\r\n\tconstructor(perspective: SideID = 'p1') {\r\n\t\tthis.perspective = perspective;\r\n\t}\r\n\r\n\tstatic parseLine(line: string, noDefault: true): Args | null;\r\n\tstatic parseLine(line: string): Args;\r\n\tstatic parseLine(line: string, noDefault?: boolean): Args | null {\r\n\t\tif (!line.startsWith('|')) {\r\n\t\t\treturn ['', line];\r\n\t\t}\r\n\t\tif (line === '|') {\r\n\t\t\treturn ['done'];\r\n\t\t}\r\n\t\tconst index = line.indexOf('|', 1);\r\n\t\tconst cmd = line.slice(1, index);\r\n\t\tswitch (cmd) {\r\n\t\tcase 'chatmsg': case 'chatmsg-raw': case 'raw': case 'error': case 'html':\r\n\t\tcase 'inactive': case 'inactiveoff': case 'warning':\r\n\t\tcase 'fieldhtml': case 'controlshtml': case 'pagehtml': case 'bigerror':\r\n\t\tcase 'debug': case 'tier': case 'challstr': case 'popup': case '':\r\n\t\t\treturn [cmd, line.slice(index + 1)];\r\n\t\tcase 'c': case 'chat': case 'uhtml': case 'uhtmlchange': case 'queryresponse': case 'showteam':\r\n\t\t\t// three parts\r\n\t\t\tconst index2a = line.indexOf('|', index + 1);\r\n\t\t\treturn [cmd, line.slice(index + 1, index2a), line.slice(index2a + 1)];\r\n\t\tcase 'c:': case 'pm':\r\n\t\t\t// four parts\r\n\t\t\tconst index2b = line.indexOf('|', index + 1);\r\n\t\t\tconst index3b = line.indexOf('|', index2b + 1);\r\n\t\t\treturn [cmd, line.slice(index + 1, index2b), line.slice(index2b + 1, index3b), line.slice(index3b + 1)];\r\n\t\t}\r\n\t\tif (noDefault) return null;\r\n\t\treturn line.slice(1).split('|') as [string, ...string[]];\r\n\t}\r\n\r\n\tstatic parseBattleLine(line: string): { args: Args, kwArgs: KWArgs } {\r\n\t\tlet args = this.parseLine(line, true);\r\n\t\tif (args) return { args, kwArgs: {} };\r\n\r\n\t\targs = line.slice(1).split('|') as [string, ...string[]];\r\n\t\tconst kwArgs: KWArgs = {};\r\n\t\twhile (args.length > 1) {\r\n\t\t\tconst lastArg = args[args.length - 1];\r\n\t\t\tif (!lastArg.startsWith('[')) break;\r\n\t\t\tconst bracketPos = lastArg.indexOf(']');\r\n\t\t\tif (bracketPos <= 0) break;\r\n\t\t\t// default to '.' so it evaluates to boolean true\r\n\t\t\tconst key = lastArg.slice(1, bracketPos);\r\n\t\t\tconst value = lastArg.slice(bracketPos + 1).trim();\r\n\r\n\t\t\t// Special-case [slot]2 so it never becomes '.' and stays numeric-like\r\n\t\t\tif (key === 'slot') { kwArgs.slot = value || '1'; } \r\n\t\t\telse { kwArgs[key] = value || '.'; } // default to '.' so it evaluates to boolean true\r\n\t\t\targs.pop();\r\n\t\t}\r\n\t\treturn BattleTextParser.upgradeArgs({ args, kwArgs });\r\n\t}\r\n\r\n\tstatic parseNameParts(text: string) {\r\n\t\tlet group = '';\r\n\t\t// names can't start with a symbol\r\n\t\tif (!/[A-Za-z0-9]/.test(text.charAt(0))) {\r\n\t\t\tgroup = text.charAt(0);\r\n\t\t\ttext = text.slice(1);\r\n\t\t}\r\n\r\n\t\tlet name = text;\r\n\t\tconst atIndex = text.indexOf('@');\r\n\t\tlet status = '';\r\n\t\tlet away = false;\r\n\t\tif (atIndex > 0) {\r\n\t\t\tname = text.slice(0, atIndex);\r\n\t\t\tstatus = text.slice(atIndex + 1);\r\n\t\t\tif (status.startsWith('!')) {\r\n\t\t\t\taway = true;\r\n\t\t\t\tstatus = status.slice(1);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { group, name, away, status };\r\n\t}\r\n\r\n\t/**\r\n\t * Old replays may use syntax we no longer use, so this function upgrades\r\n\t * them to modern versions. Used to keep battle.ts itself cleaner. Not\r\n\t * guaranteed to mutate or not mutate its inputs.\r\n\t */\r\n\tstatic upgradeArgs({ args, kwArgs }: { args: Args, kwArgs: KWArgs }): { args: Args, kwArgs: KWArgs } {\r\n\t\tswitch (args[0]) {\r\n\t\tcase '-activate': {\r\n\t\t\tif (kwArgs.item || kwArgs.move || kwArgs.number || kwArgs.ability) return { args, kwArgs };\r\n\t\t\tlet [, pokemon, effect, arg3, arg4] = args;\r\n\t\t\tlet target = kwArgs.of;\r\n\t\t\tconst id = BattleTextParser.effectId(effect);\r\n\r\n\t\t\tif (kwArgs.block) return { args: ['-fail', pokemon], kwArgs };\r\n\r\n\t\t\tif (id === 'wonderguard') return { args: ['-immune', pokemon], kwArgs: { from: 'ability:Wonder Guard' } };\r\n\r\n\t\t\tif (id === 'beatup' && kwArgs.of) return { args, kwArgs: { name: kwArgs.of } };\r\n\r\n\t\t\tif ([\r\n\t\t\t\t'ingrain', 'quickguard', 'wideguard', 'craftyshield', 'matblock', 'protect', 'mist', 'safeguard',\r\n\t\t\t\t'electricterrain', 'mistyterrain', 'psychicterrain', 'telepathy', 'stickyhold', 'suctioncups', 'aromaveil',\r\n\t\t\t\t'flowerveil', 'sweetveil', 'disguise', 'safetygoggles', 'protectivepads',\r\n\t\t\t].includes(id)) {\r\n\t\t\t\tif (target) {\r\n\t\t\t\t\tkwArgs.of = pokemon;\r\n\t\t\t\t\treturn { args: ['-block', target, effect, arg3], kwArgs };\r\n\t\t\t\t}\r\n\t\t\t\treturn { args: ['-block', pokemon, effect, arg3], kwArgs };\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'charge') {\r\n\t\t\t\treturn { args: ['-singlemove', pokemon, effect], kwArgs: { of: target } };\r\n\t\t\t}\r\n\t\t\tif ([\r\n\t\t\t\t'bind', 'wrap', 'clamp', 'whirlpool', 'firespin', 'magmastorm', 'sandtomb', 'infestation', 'snaptrap', 'thundercage', 'trapped',\r\n\t\t\t].includes(id)) {\r\n\t\t\t\treturn { args: ['-start', pokemon, effect], kwArgs: { of: target } };\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'fairylock') {\r\n\t\t\t\treturn { args: ['-fieldactivate', effect], kwArgs: {} };\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'symbiosis' || id === 'poltergeist') {\r\n\t\t\t\tkwArgs.item = arg3;\r\n\t\t\t} else if (id === 'magnitude') {\r\n\t\t\t\tkwArgs.number = arg3;\r\n\t\t\t} else if (id === 'skillswap' || id === 'mummy' || id === 'lingeringaroma' || id === 'wanderingspirit') {\r\n\t\t\t\tkwArgs.ability = arg3;\r\n\t\t\t\tkwArgs.ability2 = arg4;\r\n\t\t\t} else if ([\r\n\t\t\t\t'eeriespell', 'gmaxdepletion', 'spite', 'grudge', 'forewarn', 'sketch', 'leppaberry', 'mysteryberry',\r\n\t\t\t].includes(id)) {\r\n\t\t\t\tkwArgs.move = arg3;\r\n\t\t\t\tkwArgs.number = arg4;\r\n\t\t\t}\r\n\t\t\targs = ['-activate', pokemon, effect, target || ''];\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-fail': {\r\n\t\t\tif (kwArgs.from === 'ability: Flower Veil') {\r\n\t\t\t\treturn { args: ['-block', kwArgs.of, 'ability: Flower Veil'], kwArgs: { of: args[1] } };\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-start': {\r\n\t\t\tif (kwArgs.from === 'Protean' || kwArgs.from === 'Color Change') kwArgs.from = 'ability:' + kwArgs.from;\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase 'move': {\r\n\t\t\tif (kwArgs.from === 'Magic Bounce') kwArgs.from = 'ability:Magic Bounce';\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase 'cant': {\r\n\t\t\tlet [, pokemon, effect, move] = args;\r\n\t\t\tif (['ability: Damp', 'ability: Dazzling', 'ability: Queenly Majesty', 'ability: Armor Tail'].includes(effect)) {\r\n\t\t\t\targs[0] = '-block';\r\n\t\t\t\treturn { args: ['-block', pokemon, effect, move, kwArgs.of], kwArgs: {} };\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-heal': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (['dryskin', 'eartheater', 'voltabsorb', 'waterabsorb'].includes(id)) kwArgs.of = '';\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-restoreboost': {\r\n\t\t\targs[0] = '-clearnegativeboost';\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-weather': {\r\n\t\t\tif (args[1] === 'Snow') args[1] = 'Snowscape';\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-ability': {\r\n\t\t\tif (args[3] && (args[3].startsWith('p1') || args[3].startsWith('p2') || args[3] === 'boost')) {\r\n\t\t\t\targs[4] = args[3];\r\n\t\t\t\targs[3] = '';\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-nothing':\r\n\t\t\t// OLD: |-nothing\r\n\t\t\t// NEW: |-activate||move:Splash\r\n\t\t\treturn { args: ['-activate', '', 'move:Splash'], kwArgs };\r\n\t\t}\r\n\t\treturn { args, kwArgs };\r\n\t}\r\n\r\n\textractMessage(buf: string) {\r\n\t\tlet out = '';\r\n\t\tfor (const line of buf.split('\\n')) {\r\n\t\t\tconst { args, kwArgs } = BattleTextParser.parseBattleLine(line);\r\n\t\t\tout += this.parseArgs(args, kwArgs) || '';\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\r\n\tfixLowercase(input: string) {\r\n\t\tif (this.lowercaseRegExp === undefined) {\r\n\t\t\tconst prefixes = ['pokemon', 'opposingPokemon', 'team', 'opposingTeam', 'party', 'opposingParty'].map(templateId => {\r\n\t\t\t\tconst def = getBattleTextDefault();\r\n\t\t\t\tif (!def) return input;\r\n\t\t\t\tconst template = def[templateId];\r\n\t\t\t\tif (template.startsWith(template.charAt(0).toUpperCase())) return '';\r\n\t\t\t\tconst bracketIndex = template.indexOf('[');\r\n\t\t\t\tif (bracketIndex >= 0) return template.slice(0, bracketIndex);\r\n\t\t\t\treturn template;\r\n\t\t\t}).filter(prefix => prefix);\r\n\t\t\tif (prefixes.length) {\r\n\t\t\t\tlet buf = `((?:^|\\n)(?:  |  \\\\(|\\\\[)?)(` +\r\n\t\t\t\t\tprefixes.map(BattleTextParser.escapeRegExp).join('|') +\r\n\t\t\t\t\t`)`;\r\n\t\t\t\tthis.lowercaseRegExp = new RegExp(buf, 'g');\r\n\t\t\t} else {\r\n\t\t\t\tthis.lowercaseRegExp = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!this.lowercaseRegExp) return input;\r\n\t\treturn input.replace(this.lowercaseRegExp, (match, p1, p2) => (\r\n\t\t\tp1 + p2.charAt(0).toUpperCase() + p2.slice(1)\r\n\t\t));\r\n\t}\r\n\r\n\tstatic escapeRegExp(input: string) {\r\n\t\treturn input.replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&');\r\n\t}\r\n\tstatic escapeReplace(input: string) {\r\n\t\treturn input.replace(/\\$/g, '$$$$');\r\n\t}\r\n\r\n\t/** Returns a pokemon name escaped for passing into the second argument of string.replace */\r\n\tpokemonName = (pokemon: string) => {\r\n\t\tif (!pokemon) return '';\r\n\t\tif (!pokemon.startsWith('p')) return `???pokemon:${pokemon}???`;\r\n\t\tif (pokemon.charAt(3) === ':') return BattleTextParser.escapeReplace(pokemon.slice(4).trim());\r\n\t\telse if (pokemon.charAt(2) === ':') return BattleTextParser.escapeReplace(pokemon.slice(3).trim());\r\n\t\treturn `???pokemon:${pokemon}???`;\r\n\t};\r\n\r\n\t/** Returns a string escaped for passing into the second argument of string.replace */\r\n\tpokemon(pokemon: string) {\r\n\t\tif (!pokemon) return '';\r\n\t\tlet side = pokemon.slice(0, 2);\r\n\t\tif (!['p1', 'p2', 'p3', 'p4'].includes(side)) return `???pokemon:${pokemon}???`;\r\n\t\tconst name = this.pokemonName(pokemon);\r\n\t\tconst isNear = side === this.perspective || side === BattleTextParser.allyID(side as SideID);\r\n\t\tconst template = BattleText.default[isNear ? 'pokemon' : 'opposingPokemon'];\r\n\t\treturn template.replace('[NICKNAME]', name).replace(/\\$/g, '$$$$');\r\n\t}\r\n\r\n\t/** Returns a string escaped for passing into the second argument of string.replace */\r\n\tpokemonFull(pokemon: string, details: string): [string, string] {\r\n\t\tconst nickname = this.pokemonName(pokemon);\r\n\r\n\t\tconst species = details.split(',')[0];\r\n\t\tif (nickname === species) return [pokemon.slice(0, 2), `**${species}**`];\r\n\t\treturn [pokemon.slice(0, 2), `${nickname} (**${species}**)`];\r\n\t}\r\n\r\n\ttrainer(side: string) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === 'p1') return this.p1;\r\n\t\tif (side === 'p2') return this.p2;\r\n\t\tif (side === 'p3') return this.p3;\r\n\t\tif (side === 'p4') return this.p4;\r\n\t\treturn `???side:${side}???`;\r\n\t}\r\n\r\n\tstatic allyID(sideid: SideID): SideID | '' {\r\n\t\tif (sideid === 'p1') return 'p3';\r\n\t\tif (sideid === 'p2') return 'p4';\r\n\t\tif (sideid === 'p3') return 'p1';\r\n\t\tif (sideid === 'p4') return 'p2';\r\n\t\treturn '';\r\n\t}\r\n\r\n\tteam(side: string, isFar = false) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === this.perspective || side === BattleTextParser.allyID(side as SideID)) {\r\n\t\t\treturn !isFar ? BattleText.default.team : BattleText.default.opposingTeam;\r\n\t\t}\r\n\t\treturn isFar ? BattleText.default.team : BattleText.default.opposingTeam;\r\n\t}\r\n\r\n\town(side: string) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === this.perspective) {\r\n\t\t\treturn 'OWN';\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tparty(side: string) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === this.perspective || side === BattleTextParser.allyID(side as SideID)) {\r\n\t\t\treturn BattleText.default.party;\r\n\t\t}\r\n\t\treturn BattleText.default.opposingParty;\r\n\t}\r\n\r\n\tstatic effectId(effect?: string) {\r\n\t\tif (!effect) return '';\r\n\t\tif (effect.startsWith('item:') || effect.startsWith('move:')) {\r\n\t\t\teffect = effect.slice(5);\r\n\t\t} else if (effect.startsWith('ability:')) {\r\n\t\t\teffect = effect.slice(8);\r\n\t\t}\r\n\t\treturn toID(effect);\r\n\t}\r\n\r\n\teffect(effect?: string) {\r\n\t\tif (!effect) return '';\r\n\t\tif (effect.startsWith('item:') || effect.startsWith('move:')) {\r\n\t\t\teffect = effect.slice(5);\r\n\t\t} else if (effect.startsWith('ability:')) {\r\n\t\t\teffect = effect.slice(8);\r\n\t\t}\r\n\t\treturn effect.trim();\r\n\t}\r\n\r\n\ttemplate(type: string, ...namespaces: (string | undefined)[]) {\r\n\t\tfor (const namespace of namespaces) {\r\n\t\t\tif (!namespace) continue;\r\n\t\t\tif (namespace === 'OWN') {\r\n\t\t\t\treturn BattleText.default[type + 'Own'] + '\\n';\r\n\t\t\t}\r\n\t\t\tif (namespace === 'NODEFAULT') {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tlet id = BattleTextParser.effectId(namespace);\r\n\t\t\tif (BattleText[id] && type in BattleText[id]) {\r\n\t\t\t\tif (BattleText[id][type].charAt(1) === '.') type = BattleText[id][type].slice(2) as ID;\r\n\t\t\t\tif (BattleText[id][type].startsWith('#')) id = BattleText[id][type].slice(1) as ID;\r\n\t\t\t\tif (!BattleText[id][type]) return '';\r\n\t\t\t\tlet template = BattleText[id][type];\r\n\t\t\t\tfor (let i = Dex.gen - 1; i >= this.gen; i--) {\r\n\t\t\t\t\tlet curTemplate = BattleText[id][`${type}Gen${i}`];\r\n\t\t\t\t\tif (curTemplate) template = curTemplate;\r\n\t\t\t\t}\r\n\t\t\t\treturn template + '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!BattleText.default[type]) return '';\r\n\t\tlet template = BattleText.default[type];\r\n\t\tfor (let i = Dex.gen - 1; i >= this.gen; i--) {\r\n\t\t\tlet curTemplate = BattleText.default[`${type}Gen${i}`];\r\n\t\t\tif (curTemplate) template = curTemplate;\r\n\t\t}\r\n\t\treturn template + '\\n';\r\n\t}\r\n\r\n\tmaybeAbility(effect: string | undefined, holder: string) {\r\n\t\tif (!effect) return '';\r\n\t\tif (!effect.startsWith('ability:')) return '';\r\n\t\treturn this.ability(effect.slice(8).trim(), holder);\r\n\t}\r\n\r\n\tability(name: string | undefined, holder: string) {\r\n\t\tif (!name) return '';\r\n\t\treturn BattleText.default.abilityActivation.replace('[POKEMON]', this.pokemon(holder)).replace('[ABILITY]', this.effect(name)) + '\\n';\r\n\t}\r\n\r\n\tstatic stat(stat: string) {\r\n\t\tconst entry = BattleText[stat || \"stats\"];\r\n\t\tif (!entry?.statName) return `???stat:${stat}???`;\r\n\t\treturn entry.statName;\r\n\t}\r\n\r\n\tlineSection(args: Args, kwArgs: KWArgs) {\r\n\t\tif (kwArgs.premajor) return 'preMajor';\r\n\t\tif (kwArgs.postmajor) return 'postMajor';\r\n\t\tif (kwArgs.major) return 'major';\r\n\r\n\t\tconst cmd = args[0];\r\n\t\tswitch (cmd) {\r\n\t\tcase 'done' : case 'turn':\r\n\t\t\treturn 'break';\r\n\t\tcase 'move' : case 'cant': case 'switch': case 'drag': case 'upkeep': case 'start':\r\n\t\tcase '-mega': case '-candynamax': case '-terastallize':\r\n\t\t\treturn 'major';\r\n\t\tcase 'switchout': case 'faint':\r\n\t\t\treturn 'preMajor';\r\n\t\tcase '-zpower':\r\n\t\t\treturn 'postMajor';\r\n\t\tcase '-damage': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'confusion') return 'major';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\tcase '-curestatus': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'naturalcure') return 'preMajor';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\tcase '-start': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'protean') return 'preMajor';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\tcase '-activate': {\r\n\t\t\tconst id = BattleTextParser.effectId(args[2]);\r\n\t\t\tif (id === 'confusion' || id === 'attract') return 'preMajor';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\t}\r\n\t\treturn (cmd.startsWith('-') ? 'postMajor' : '');\r\n\t}\r\n\r\n\tsectionBreak(args: Args, kwArgs: KWArgs) {\r\n\t\tconst prevSection = this.curLineSection;\r\n\t\tconst curSection = this.lineSection(args, kwArgs);\r\n\t\tif (!curSection) return false;\r\n\t\tthis.curLineSection = curSection;\r\n\t\tswitch (curSection) {\r\n\t\tcase 'break':\r\n\t\t\tif (prevSection !== 'break') return true;\r\n\t\t\treturn false;\r\n\t\tcase 'preMajor':\r\n\t\tcase 'major':\r\n\t\t\tif (prevSection === 'postMajor' || prevSection === 'major') return true;\r\n\t\t\treturn false;\r\n\t\tcase 'postMajor':\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tparseArgs(args: Args, kwArgs: KWArgs, noSectionBreak?: boolean) {\r\n\t\tlet buf = !noSectionBreak && this.sectionBreak(args, kwArgs) ? '\\n' : '';\r\n\t\treturn buf + this.fixLowercase(this.parseArgsInner(args, kwArgs) || '');\r\n\t}\r\n\r\n\tparseArgsInner(args: Args, kwArgs: KWArgs) {\r\n\t\tlet cmd = args[0];\r\n\t\tswitch (cmd) {\r\n\t\tcase 'player': {\r\n\t\t\tconst [, side, name] = args;\r\n\t\t\tif (side === 'p1' && name) {\r\n\t\t\t\tthis.p1 = BattleTextParser.escapeReplace(name);\r\n\t\t\t} else if (side === 'p2' && name) {\r\n\t\t\t\tthis.p2 = BattleTextParser.escapeReplace(name);\r\n\t\t\t} else if (side === 'p3' && name) {\r\n\t\t\t\tthis.p3 = BattleTextParser.escapeReplace(name);\r\n\t\t\t} else if (side === 'p4' && name) {\r\n\t\t\t\tthis.p4 = BattleTextParser.escapeReplace(name);\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tcase 'gen': {\r\n\t\t\tconst [, num] = args;\r\n\t\t\tthis.gen = parseInt(num, 10);\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tcase 'turn': {\r\n\t\t\tconst [, num] = args;\r\n\t\t\tthis.turn = Number.parseInt(num, 10);\r\n\t\t\treturn this.template('turn').replace('[NUMBER]', num) + '\\n';\r\n\t\t}\r\n\r\n\t\tcase 'start': {\r\n\t\t\treturn this.template('startBattle').replace('[TRAINER]', this.p1).replace('[TRAINER]', this.p2);\r\n\t\t}\r\n\r\n\t\tcase 'win': case 'tie': {\r\n\t\t\tconst [, name] = args;\r\n\t\t\tif (cmd === 'tie' || !name) {\r\n\t\t\t\treturn this.template('tieBattle').replace('[TRAINER]', this.p1).replace('[TRAINER]', this.p2);\r\n\t\t\t}\r\n\t\t\treturn this.template('winBattle').replace('[TRAINER]', name);\r\n\t\t}\r\n\r\n\t\tcase 'switch': {\r\n\t\t\tconst [, pokemon, details] = args;\r\n\t\t\tconst [side, fullname] = this.pokemonFull(pokemon, details);\r\n\t\t\tconst template = this.template('switchIn', this.own(side));\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[FULLNAME]', fullname);\r\n\t\t}\r\n\r\n\t\tcase 'drag': {\r\n\t\t\tconst [, pokemon, details] = args;\r\n\t\t\tconst [side, fullname] = this.pokemonFull(pokemon, details);\r\n\t\t\tconst template = this.template('drag');\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[FULLNAME]', fullname);\r\n\t\t}\r\n\r\n\t\tcase 'detailschange': case '-transform': case '-formechange': {\r\n\t\t\tconst [, pokemon, arg2, arg3] = args;\r\n\t\t\tlet newSpecies = '';\r\n\t\t\tswitch (cmd) {\r\n\t\t\tcase 'detailschange': newSpecies = arg2.split(',')[0].trim(); break;\r\n\t\t\tcase '-transform': newSpecies = arg3; break;\r\n\t\t\tcase '-formechange': newSpecies = arg2; break;\r\n\t\t\t}\r\n\t\t\tlet newSpeciesId = toID(newSpecies);\r\n\t\t\tlet id = '';\r\n\t\t\tlet templateName = 'transform';\r\n\t\t\tif (cmd !== '-transform') {\r\n\t\t\t\tswitch (newSpeciesId) {\r\n\t\t\t\tcase 'greninjaash': id = 'battlebond'; break;\r\n\t\t\t\tcase 'mimikyubusted': id = 'disguise'; break;\r\n\t\t\t\tcase 'zygardecomplete': id = 'powerconstruct'; break;\r\n\t\t\t\tcase 'necrozmaultra': id = 'ultranecroziumz'; break;\r\n\t\t\t\tcase 'darmanitanzen': id = 'zenmode'; break;\r\n\t\t\t\tcase 'darmanitan': id = 'zenmode'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'darmanitangalarzen': id = 'zenmode'; break;\r\n\t\t\t\tcase 'darmanitangalar': id = 'zenmode'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'aegislashblade': id = 'stancechange'; break;\r\n\t\t\t\tcase 'aegislash': id = 'stancechange'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'wishiwashischool': id = 'schooling'; break;\r\n\t\t\t\tcase 'wishiwashi': id = 'schooling'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'miniormeteor': id = 'shieldsdown'; break;\r\n\t\t\t\tcase 'minior': id = 'shieldsdown'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'eiscuenoice': id = 'iceface'; break;\r\n\t\t\t\tcase 'eiscue': id = 'iceface'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'terapagosterastal': id = 'terashift'; break;\r\n\t\t\t\t}\r\n\t\t\t} else if (newSpecies) {\r\n\t\t\t\tid = 'transform';\r\n\t\t\t}\r\n\t\t\tconst template = this.template(templateName, id, kwArgs.msg ? '' : 'NODEFAULT');\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SPECIES]', newSpecies);\r\n\t\t}\r\n\r\n\t\tcase 'switchout': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst side = pokemon.slice(0, 2);\r\n\t\t\tconst template = this.template('switchOut', kwArgs.from, this.own(side));\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[NICKNAME]', this.pokemonName(pokemon)).replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase 'faint': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('faint');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase 'swap': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tif (!target || !isNaN(Number(target))) {\r\n\t\t\t\tconst template = this.template('swapCenter');\r\n\t\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('swap');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase 'move': {\r\n\t\t\tconst [, pokemon, move] = args;\r\n\t\t\tlet line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.zeffect) {\r\n\t\t\t\tline1 = this.template('zEffect').replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('move', kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', move);\r\n\t\t}\r\n\r\n\t\tcase 'cant': {\r\n\t\t\tlet [, pokemon, effect, move] = args;\r\n\t\t\tconst template = this.template('cant', effect, 'NODEFAULT') ||\r\n\t\t\t\tthis.template(move ? 'cant' : 'cantNoMove');\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', move);\r\n\t\t}\r\n\r\n\t\tcase '-candynamax': {\r\n\t\t\tlet [, side] = args;\r\n\t\t\tconst own = this.own(side);\r\n\t\t\tlet template = '';\r\n\t\t\tif (this.turn === 1) {\r\n\t\t\t\tif (own) template = this.template('canDynamax', own);\r\n\t\t\t} else {\r\n\t\t\t\ttemplate = this.template('canDynamax', own);\r\n\t\t\t}\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side));\r\n\t\t}\r\n\r\n\t\tcase 'message': {\r\n\t\t\tlet [, message] = args;\r\n\t\t\treturn '' + message + '\\n';\r\n\t\t}\r\n\r\n\t\tcase '-start': {\r\n\t\t\tlet [, pokemon, effect, arg3] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, pokemon) || this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'typechange') {\r\n\t\t\t\tconst template = this.template('typeChange', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TYPE]', arg3)\r\n\t\t\t\t\t.replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (id === 'typeadd') {\r\n\t\t\t\tconst template = this.template('typeAdd', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TYPE]', arg3);\r\n\t\t\t}\r\n\t\t\tif (id.startsWith('stockpile')) {\r\n\t\t\t\tconst num = id.slice(9);\r\n\t\t\t\tconst template = this.template('start', 'stockpile');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[NUMBER]', num);\r\n\t\t\t}\r\n\t\t\tif (id.startsWith('perish')) {\r\n\t\t\t\tconst num = id.slice(6);\r\n\t\t\t\tconst template = this.template('activate', 'perishsong');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[NUMBER]', num);\r\n\t\t\t}\r\n\t\t\tif (id.startsWith('protosynthesis') || id.startsWith('quarkdrive')) {\r\n\t\t\t\tconst stat = id.slice(-3);\r\n\t\t\t\tconst template = this.template('start', id.slice(0, id.length - 3));\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat));\r\n\t\t\t}\r\n\t\t\tlet templateId = 'start';\r\n\t\t\tif (kwArgs.already) templateId = 'alreadyStarted';\r\n\t\t\tif (kwArgs.fatigue) templateId = 'startFromFatigue';\r\n\t\t\tif (kwArgs.zeffect) templateId = 'startFromZEffect';\r\n\t\t\tif (kwArgs.damage) templateId = 'activate';\r\n\t\t\tif (kwArgs.block) templateId = 'block';\r\n\t\t\tif (kwArgs.upkeep) templateId = 'upkeep';\r\n\t\t\tif (templateId === 'start' && kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\ttemplateId += 'FromItem';\r\n\t\t\t}\r\n\t\t\tconst template = this.template(templateId, kwArgs.from, effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(effect))\r\n\t\t\t\t.replace('[MOVE]', arg3).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t}\r\n\r\n\t\tcase '-end': {\r\n\t\t\tlet [, pokemon, effect] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, pokemon) || this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'doomdesire' || id === 'futuresight') {\r\n\t\t\t\tconst template = this.template('activate', effect);\r\n\t\t\t\treturn line1 + template.replace('[TARGET]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tlet templateId = 'end';\r\n\t\t\tlet template = '';\r\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\ttemplate = this.template('endFromItem', effect);\r\n\t\t\t}\r\n\t\t\tif (!template) template = this.template(templateId, effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(effect))\r\n\t\t\t\t.replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t}\r\n\r\n\t\tcase '-ability': {\r\n\t\t\tlet [, pokemon, ability, oldAbility] = args;\r\n\t\t\tlet line1 = '';\r\n\t\t\tif (oldAbility) line1 += this.ability(oldAbility, pokemon);\r\n\t\t\tline1 += this.ability(ability, pokemon);\r\n\t\t\tif (kwArgs.fail) {\r\n\t\t\t\tconst template = this.template('block', kwArgs.from);\r\n\t\t\t\treturn line1 + template;\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from) {\r\n\t\t\t\tif (!oldAbility) line1 = this.maybeAbility(kwArgs.from, pokemon) + line1;\r\n\t\t\t\tconst template = this.template('changeAbility', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ABILITY]', this.effect(ability))\r\n\t\t\t\t\t.replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tconst id = BattleTextParser.effectId(ability);\r\n\t\t\tif (id === 'unnerve') {\r\n\t\t\t\tconst template = this.template('start', ability);\r\n\t\t\t\treturn line1 + template.replace('[TEAM]', this.team(pokemon.slice(0, 2), true));\r\n\t\t\t}\r\n\t\t\tlet templateId = 'start';\r\n\t\t\tif (id === 'anticipation' || id === 'sturdy') templateId = 'activate';\r\n\t\t\tconst template = this.template(templateId, ability, 'NODEFAULT');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-endability': {\r\n\t\t\tlet [, pokemon, ability] = args;\r\n\t\t\tif (ability) return this.ability(ability, pokemon);\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('start', 'Gastro Acid');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-item': {\r\n\t\t\tconst [, pokemon, item] = args;\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tlet target = '';\r\n\t\t\tif (['magician', 'pickpocket'].includes(id)) {\r\n\t\t\t\t[target, kwArgs.of] = [kwArgs.of, ''];\r\n\t\t\t}\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (['thief', 'covet', 'bestow', 'magician', 'pickpocket'].includes(id)) {\r\n\t\t\t\tconst template = this.template('takeItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item))\r\n\t\t\t\t\t.replace('[SOURCE]', this.pokemon(target || kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (id === 'frisk') {\r\n\t\t\t\tconst hasTarget = kwArgs.of && pokemon && kwArgs.of !== pokemon;\r\n\t\t\t\tconst template = this.template(hasTarget ? 'activate' : 'activateNoTarget', \"Frisk\");\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(item))\r\n\t\t\t\t\t.replace('[TARGET]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from) {\r\n\t\t\t\tconst template = this.template('addItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('start', item, 'NODEFAULT');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-enditem': {\r\n\t\t\tlet [, pokemon, item] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.eat) {\r\n\t\t\t\tconst template = this.template('eatItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'gem') {\r\n\t\t\t\tconst template = this.template('useGem', item);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item))\r\n\t\t\t\t\t.replace('[MOVE]', kwArgs.move);\r\n\t\t\t}\r\n\t\t\tif (id === 'stealeat') {\r\n\t\t\t\tconst template = this.template('removeItem', \"Bug Bite\");\r\n\t\t\t\treturn line1 + template.replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from) {\r\n\t\t\t\tconst template = this.template('removeItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item))\r\n\t\t\t\t\t.replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.weaken) {\r\n\t\t\t\tconst template = this.template('activateWeaken');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tlet template = this.template('end', item, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('activateItem').replace('[ITEM]', this.effect(item));\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(kwArgs.of));\r\n\t\t}\r\n\r\n\t\tcase '-status': {\r\n\t\t\tconst [, pokemon, status] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\tconst template = this.template('startFromItem', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'rest') {\r\n\t\t\t\tconst template = this.template('startFromRest', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('start', status);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-curestatus': {\r\n\t\t\tconst [, pokemon, status] = args;\r\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'naturalcure') {\r\n\t\t\t\tconst template = this.template('activate', kwArgs.from);\r\n\t\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\tconst template = this.template('endFromItem', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.thaw) {\r\n\t\t\t\tconst template = this.template('endFromMove', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tlet template = this.template('end', status, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('end').replace('[EFFECT]', status);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-cureteam': {\r\n\t\t\treturn this.template('activate', kwArgs.from);\r\n\t\t}\r\n\r\n\t\tcase '-singleturn': case '-singlemove': {\r\n\t\t\tconst [, pokemon, effect] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon) ||\r\n\t\t\t\tthis.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'instruct') {\r\n\t\t\t\tconst template = this.template('activate', effect);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[TARGET]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tlet template = this.template('start', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('start').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(kwArgs.of))\r\n\t\t\t\t.replace('[TEAM]', this.team(pokemon.slice(0, 2)));\r\n\t\t}\r\n\r\n\t\tcase '-sidestart': {\r\n\t\t\tlet [, side, effect] = args;\r\n\t\t\tlet template = this.template('start', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('startTeamEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn template.replace('[TEAM]', this.team(side)).replace('[PARTY]', this.party(side));\r\n\t\t}\r\n\r\n\t\tcase '-sideend': {\r\n\t\t\tlet [, side, effect] = args;\r\n\t\t\tlet template = this.template('end', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('endTeamEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn template.replace('[TEAM]', this.team(side)).replace('[PARTY]', this.party(side));\r\n\t\t}\r\n\r\n\t\tcase '-weather': {\r\n\t\t\tconst [, weather] = args;\r\n\t\t\tif (!weather || weather === 'none') {\r\n\t\t\t\tconst template = this.template('end', kwArgs.from, 'NODEFAULT');\r\n\t\t\t\tif (!template) return this.template('endFieldEffect').replace('[EFFECT]', this.effect(weather));\r\n\t\t\t\treturn template;\r\n\t\t\t}\r\n\t\t\tif (kwArgs.upkeep) {\r\n\t\t\t\treturn this.template('upkeep', weather, 'NODEFAULT');\r\n\t\t\t}\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of);\r\n\t\t\tlet template = this.template('start', weather, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('startFieldEffect').replace('[EFFECT]', this.effect(weather));\r\n\t\t\treturn line1 + template;\r\n\t\t}\r\n\r\n\t\tcase '-fieldstart': case '-fieldactivate': {\r\n\t\t\tconst [, effect] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of);\r\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'hadronengine') {\r\n\t\t\t\treturn line1 + this.template('start', 'hadronengine').replace('[POKEMON]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tlet templateId = cmd.slice(6);\r\n\t\t\tif (BattleTextParser.effectId(effect) === 'perishsong') templateId = 'start';\r\n\t\t\tlet template = this.template(templateId, effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('startFieldEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of));\r\n\t\t}\r\n\r\n\t\tcase '-fieldend': {\r\n\t\t\tlet [, effect] = args;\r\n\t\t\tlet template = this.template('end', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('endFieldEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn template;\r\n\t\t}\r\n\r\n\t\tcase '-sethp': {\r\n\t\t\tlet effect = kwArgs.from;\r\n\t\t\treturn this.template('activate', effect);\r\n\t\t}\r\n\r\n\t\tcase '-message': {\r\n\t\t\tlet [, message] = args;\r\n\t\t\treturn '  ' + message + '\\n';\r\n\t\t}\r\n\r\n\t\tcase '-hint': {\r\n\t\t\tlet [, message] = args;\r\n\t\t\treturn '  (' + message + ')\\n';\r\n\t\t}\r\n\r\n\t\tcase '-activate': {\r\n\t\t\tlet [, pokemon, effect, target] = args;\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'celebrate') {\r\n\t\t\t\treturn this.template('activate', 'celebrate').replace('[TRAINER]', this.trainer(pokemon.slice(0, 2)));\r\n\t\t\t}\r\n\t\t\tif (!target &&\r\n\t\t\t\t['hyperdrill', 'hyperspacefury', 'hyperspacehole', 'phantomforce', 'shadowforce', 'feint'].includes(id)) {\r\n\t\t\t\t[pokemon, target] = [kwArgs.of, pokemon];\r\n\t\t\t\tif (!pokemon) pokemon = target;\r\n\t\t\t}\r\n\t\t\tif (!target) target = kwArgs.of || pokemon;\r\n\r\n\t\t\tlet line1 = this.maybeAbility(effect, pokemon);\r\n\r\n\t\t\tif (id === 'lockon' || id === 'mindreader') {\r\n\t\t\t\tconst template = this.template('start', effect);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[SOURCE]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\r\n\t\t\tif ((id === 'mummy' || id === 'lingeringaroma') && kwArgs.ability) {\r\n\t\t\t\tline1 += this.ability(kwArgs.ability, target);\r\n\t\t\t\tline1 += this.ability(id === 'mummy' ? 'Mummy' : 'Lingering Aroma', target);\r\n\t\t\t\tconst template = this.template('changeAbility', id);\r\n\t\t\t\treturn line1 + template.replace('[TARGET]', this.pokemon(target));\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'commander') {\r\n\t\t\t\t// Commander didn't have a message prior to v1.2.0 of SV\r\n\t\t\t\t// so this is for backwards compatibility\r\n\t\t\t\tif (target === pokemon) return line1;\r\n\t\t\t\tconst template = this.template('activate', id);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace(/\\[TARGET\\]/g, this.pokemon(target));\r\n\t\t\t}\r\n\r\n\t\t\tlet templateId = 'activate';\r\n\t\t\tif (id === 'forewarn' && pokemon === target) {\r\n\t\t\t\ttemplateId = 'activateNoTarget';\r\n\t\t\t}\r\n\t\t\tif ((id === 'protosynthesis' || id === 'quarkdrive') && kwArgs.fromitem) {\r\n\t\t\t\ttemplateId = 'activateFromItem';\r\n\t\t\t}\r\n\t\t\tif (id === 'orichalcumpulse' && kwArgs.source) {\r\n\t\t\t\ttemplateId = 'start';\r\n\t\t\t}\r\n\t\t\tlet template = this.template(templateId, effect, 'NODEFAULT');\r\n\t\t\tif (!template) {\r\n\t\t\t\tif (line1) return line1; // Abilities don't have a default template\r\n\t\t\t\ttemplate = this.template('activate');\r\n\t\t\t\treturn line1 + template.replace('[EFFECT]', this.effect(effect));\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'brickbreak') {\r\n\t\t\t\ttemplate = template.replace('[TEAM]', this.team(target.slice(0, 2)));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.ability) {\r\n\t\t\t\tline1 += this.ability(kwArgs.ability, pokemon);\r\n\t\t\t}\r\n\t\t\tif (kwArgs.ability2) {\r\n\t\t\t\tline1 += this.ability(kwArgs.ability2, target);\r\n\t\t\t}\r\n\t\t\tif (kwArgs.move || kwArgs.number || kwArgs.item || kwArgs.name) {\r\n\t\t\t\ttemplate = template.replace('[MOVE]', kwArgs.move).replace('[NUMBER]', kwArgs.number)\r\n\t\t\t\t\t.replace('[ITEM]', kwArgs.item).replace('[NAME]', kwArgs.name);\r\n\t\t\t}\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target))\r\n\t\t\t\t.replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t}\r\n\r\n\t\tcase '-prepare': {\r\n\t\t\tconst [, pokemon, effect, target] = args;\r\n\t\t\tconst template = this.template('prepare', effect);\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-damage': {\r\n\t\t\tlet [, pokemon, , percentage] = args;\r\n\t\t\tlet template = this.template('damage', kwArgs.from, 'NODEFAULT');\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (template) {\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\r\n\t\t\tif (!kwArgs.from) {\r\n\t\t\t\ttemplate = this.template(percentage ? 'damagePercentage' : 'damage');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[PERCENTAGE]', percentage);\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from.startsWith('item:')) {\r\n\t\t\t\ttemplate = this.template(kwArgs.of ? 'damageFromPokemon' : 'damageFromItem');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from))\r\n\t\t\t\t\t.replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.partiallytrapped || id === 'bind' || id === 'wrap') {\r\n\t\t\t\ttemplate = this.template('damageFromPartialTrapping');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\r\n\t\t\ttemplate = this.template('damage');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-heal': {\r\n\t\t\tlet [, pokemon] = args;\r\n\t\t\tlet template = this.template('heal', kwArgs.from, 'NODEFAULT');\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (template) {\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(kwArgs.of))\r\n\t\t\t\t\t.replace('[NICKNAME]', kwArgs.wisher);\r\n\t\t\t}\r\n\r\n\t\t\tif (kwArgs.from && !kwArgs.from.startsWith('ability:')) {\r\n\t\t\t\ttemplate = this.template('healFromEffect');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\r\n\t\t\ttemplate = this.template('heal');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-boost': case '-unboost': {\r\n\t\t\tlet [, pokemon, stat, num] = args;\r\n\t\t\tif (stat === 'spa' && this.gen === 1) stat = 'spc';\r\n\t\t\tconst amount = parseInt(num, 10);\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tif (amount >= 3) templateId += '3';\r\n\t\t\telse if (amount >= 2) templateId += '2';\r\n\t\t\telse if (amount === 0) templateId += '0';\r\n\t\t\tif (amount && kwArgs.zeffect) {\r\n\t\t\t\ttemplateId += (kwArgs.multiple ? 'MultipleFromZEffect' : 'FromZEffect');\r\n\t\t\t} else if (amount && kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\tconst template = this.template(templateId + 'FromItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat))\r\n\t\t\t\t\t.replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tconst template = this.template(templateId, kwArgs.from);\r\n\t\t\treturn line1 + template.replace(/\\[POKEMON\\]/g, this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat));\r\n\t\t}\r\n\r\n\t\tcase '-setboost': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst effect = kwArgs.from;\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('boost', effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-swapboost': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tlet templateId = 'swapBoost';\r\n\t\t\tif (id === 'guardswap') templateId = 'swapDefensiveBoost';\r\n\t\t\tif (id === 'powerswap') templateId = 'swapOffensiveBoost';\r\n\t\t\tconst template = this.template(templateId, kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-copyboost': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('copyBoost', kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-clearboost': case '-clearpositiveboost': case '-clearnegativeboost': {\r\n\t\t\tconst [, pokemon, source] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet templateId = 'clearBoost';\r\n\t\t\tif (kwArgs.zeffect) templateId = 'clearBoostFromZEffect';\r\n\t\t\tconst template = this.template(templateId, kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(source));\r\n\t\t}\r\n\r\n\t\tcase '-invertboost': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('invertBoost', kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-clearallboost': {\r\n\t\t\treturn this.template('clearAllBoost', kwArgs.from);\r\n\t\t}\r\n\r\n\t\tcase '-crit': case '-supereffective': case '-resisted': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tif (templateId === 'supereffective') templateId = 'superEffective';\r\n\t\t\tif (kwArgs.spread) templateId += 'Spread';\r\n\t\t\tconst template = this.template(templateId);\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-block': {\r\n\t\t\tlet [, pokemon, effect, move, attacker] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('block', effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon))\r\n\t\t\t\t.replace('[SOURCE]', this.pokemon(attacker || kwArgs.of)).replace('[MOVE]', move);\r\n\t\t}\r\n\r\n\t\tcase '-fail': {\r\n\t\t\tlet [, pokemon, effect, stat] = args;\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tlet blocker = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet templateId = 'block';\r\n\t\t\tif (['desolateland', 'primordialsea'].includes(blocker) &&\r\n\t\t\t\t!['sunnyday', 'raindance', 'sandstorm', 'hail', 'snowscape', 'chillyreception'].includes(id)) {\r\n\t\t\t\ttemplateId = 'blockMove';\r\n\t\t\t} else if (blocker === 'uproar' && kwArgs.msg) {\r\n\t\t\t\ttemplateId = 'blockSelf';\r\n\t\t\t}\r\n\t\t\tlet template = this.template(templateId, kwArgs.from);\r\n\t\t\tif (template) {\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'unboost') {\r\n\t\t\t\ttemplate = this.template(stat ? 'failSingular' : 'fail', 'unboost');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', stat);\r\n\t\t\t}\r\n\r\n\t\t\ttemplateId = 'fail';\r\n\t\t\tif (['brn', 'frz', 'par', 'psn', 'slp', 'substitute', 'shedtail'].includes(id)) {\r\n\t\t\t\ttemplateId = 'alreadyStarted';\r\n\t\t\t}\r\n\t\t\tif (kwArgs.heavy) templateId = 'failTooHeavy';\r\n\t\t\tif (kwArgs.weak) templateId = 'fail';\r\n\t\t\tif (kwArgs.forme) templateId = 'failWrongForme';\r\n\t\t\ttemplate = this.template(templateId, id);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-immune': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet template = this.template('block', kwArgs.from);\r\n\t\t\tif (!template) {\r\n\t\t\t\tconst templateId = kwArgs.ohko ? 'immuneOHKO' : 'immune';\r\n\t\t\t\ttemplate = this.template(pokemon ? templateId : 'immuneNoPokemon', kwArgs.from);\r\n\t\t\t}\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-miss': {\r\n\t\t\tconst [, source, pokemon] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (!pokemon) {\r\n\t\t\t\tconst template = this.template('missNoPokemon');\r\n\t\t\t\treturn line1 + template.replace('[SOURCE]', this.pokemon(source));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('miss');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-center': case '-ohko': case '-combine': {\r\n\t\t\treturn this.template(cmd.slice(1));\r\n\t\t}\r\n\r\n\t\tcase '-notarget': {\r\n\t\t\treturn this.template('noTarget');\r\n\t\t}\r\n\r\n\t\tcase '-mega': case '-primal': {\r\n\t\t\tconst [, pokemon, species, item] = args;\r\n\t\t\tlet id = '';\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tif (species === 'Rayquaza') {\r\n\t\t\t\tid = 'dragonascent';\r\n\t\t\t\ttemplateId = 'megaNoItem';\r\n\t\t\t}\r\n\t\t\tif (!item && cmd === '-mega') templateId = 'megaNoItem';\r\n\t\t\tlet template = this.template(templateId, id);\r\n\t\t\tconst side = pokemon.slice(0, 2);\r\n\t\t\tconst pokemonName = this.pokemon(pokemon);\r\n\t\t\tif (cmd === '-mega') {\r\n\t\t\t\tconst template2 = this.template('transformMega');\r\n\t\t\t\ttemplate += template2.replace('[POKEMON]', pokemonName).replace('[SPECIES]', species);\r\n\t\t\t}\r\n\t\t\treturn template.replace('[POKEMON]', pokemonName).replace('[ITEM]', item).replace('[TRAINER]', this.trainer(side));\r\n\t\t}\r\n\r\n\t\tcase '-terastallize': {\r\n\t\t\tconst [, pokemon, type] = args;\r\n\t\t\tlet id = '';\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tlet template = this.template(templateId, id);\r\n\t\t\tconst pokemonName = this.pokemon(pokemon);\r\n\t\t\treturn template.replace('[POKEMON]', pokemonName).replace('[TYPE]', type);\r\n\t\t}\r\n\r\n\t\tcase '-zpower': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('zPower');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-burst': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('activate', \"Ultranecrozium Z\");\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-zbroken': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('zBroken');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-hitcount': {\r\n\t\t\tconst [, , num] = args;\r\n\t\t\tif (num === '1') {\r\n\t\t\t\treturn this.template('hitCountSingular');\r\n\t\t\t}\r\n\t\t\treturn this.template('hitCount').replace('[NUMBER]', num);\r\n\t\t}\r\n\r\n\t\tcase '-waiting': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tconst template = this.template('activate', \"Water Pledge\");\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-anim': {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tdefault: {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\ndeclare const require: any;\r\ndeclare const global: any;\r\nif (typeof require === 'function') {\r\n\t// in Node\r\n\tglobal.BattleTextParser = BattleTextParser;\r\n}\r\n"],"mappings":"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","ignoreList":[]}