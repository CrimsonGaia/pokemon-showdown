{"version":3,"file":"battle-dex-search.js","names":["DexSearch","searchType","arguments","length","undefined","formatid","species","query","dex","Dex","typedSearch","results","prependResults","exactMatch","firstPokemonColumn","sortCol","reverseSort","filters","setType","_proto","prototype","getTypedSearch","format","speciesOrSet","BattlePokemonSearch","BattleItemSearch","BattleMoveSearch","BattleFlagSearch","BattleAbilitySearch","BattleTypeSearch","BattleCategorySearch","find","toID","_this$typedSearch","getResults","concat","textSearch","_this$typedSearch2","capitalizeFirst","str","charAt","toUpperCase","slice","addFilter","entry","type","includes","tagMap","id","abilities","get","name","tierTable","uber","caplc","capnfe","_i2","_this$filters2","filter","push","classId","_i4","_this$filters4","removeFilter","filterid","join","deleted","i","splice","pop","toggleSort","filterLabel","filterType","illegalLabel","_this$typedSearch3","illegalReasons","getTier","_this$typedSearch4","_this$typedSearch5","_this$typedSearch6","_this$typedSearch7","_this","baseResults","console","log","Object","keys","offsetTable","BattleSearchIndexOffset","searchTypeIndex","typeTable","qFilterType","endsWith","window","BattleTypeChart","getClosest","BattleSearchIndex","passType","searchPasses","queryAlias","BattleAliases","startsWith","aliasPassType","unshift","substr","matchLength","matchQuery","bufs","topbufIndex","count","nearMatch","instafilter","instafilterSort","illegal","searchPass","shift","typeIndex","matchStart","matchEnd","originalIndex","_BattleSearchIndexOff","offsetRow","charCodeAt","originalEntry","typeName","curBufLength","topbuf","Array","apply","legalSet","Set","_i6","_this$typedSearch$bas2","_ref","add","_ref2","has","fType","fId","_this$typedSearch8","buf","illegalBuf","BattlePokedex","types","ability","hasAbility","flagName","tags","isMega","BattleMovedex","m","type2","category","BattleFlags","move","flags","className","classNames","fragile","consumable","berry","pokeball","evolution","tradeevo","BattleItems","item","items","itemClass","getItemClass","left","right","mid","Math","floor","pokemon","tier","egggroup","article","flag","itemclass","BattleTypedSearch","set","formatType","isDoubles","baseIllegalResults","sortRow","gen","Number","forGen","mod","_proto2","_this2","_illegalResults","getDefaultResults","call","getBaseResults","legalityFilter","_i8","_this$baseResults2","_ref3","resultType","value","getTable","illegalResults","_i10","_this$baseResults4","result","_i12","_this$baseIllegalResu2","defaultFilter","_ref4","rowType","sort","_ref5","firstLearnsetid","speciesid","_this$formatType","table","BattleTeambuilderTable","learnsets","exists","baseLearnsetid","baseSpecies","battleOnly","nextLearnsetid","learnsetid","checkingMoves","lsetSpecies","next","changesFrom","prevo","baseEvo","canLearn","moveid","moves","isNonstandard","genChar","_this$formatType2","learnset","eggMovesOnly","_table","num","String","tableKey","overrideTier","child","father","_BattleTypedSearch2","_this3","_len","args","_key","_inheritsLoose","_proto3","_this$formatType3","_this$formatType4","_this$formatType5","_this$formatType6","_this$formatType7","_this$formatType8","_this4","isVGCOrBS","isHackmons","isDoublesOrBS","_table2","_table3","_table4","tiers","formatSlices","error","tierSet","map","r","_ref6","sp","bs","ns","slices","getStage","stage","cur","prev","canEvolve","evos","isBabyLeague","isNFELeague","isSingleStage","isSecondStageLeague","_i14","_this$getDefaultResul2","row","base","Uber","_this$formatType9","Regular","_ref7","_ref8","OU","UUBL","UU","RU","NU","PU","ZU","LC","AG","DUber","DOU","DUU","_slices$RegΔ","_slices$RegΙ","_slices$RegΒ","_slices$RegΖ","_slices$RegΓ","_slices$RegΘ","_slices$RegΕ","_slices$RegΛ","_slices$RegΨ","_slices$RegΝ","_slices$RegΦ","sA","sD","sI","sB","sZ","sG","sT","sE","sL","sP","sN","sF","start","end","_ref9","test","_ref10","_i16","_ref11","eggGroups","_this5","sortOrder","_ref12","_ref13","rowType1","id1","rowType2","id2","stat1","baseStats","stat2","_ref14","_ref15","base1","base2","bst1","hp","atk","def","spa","spd","spe","bst2","_ref16","_ref17","name1","name2","Error","_BattleTypedSearch3","_proto4","BattleAbilities","reverse","isAAA","modid","abilitySet","a0","a1","aH","aS","goodAbilities","poorAbilities","badAbilities","_i18","_abilities$sort$map2","abil","rating","_i20","_ref18","_BattleTypedSearch4","_proto5","_this$formatType10","_this$formatType11","itemSet","_this$set","speciesName","speciesSpecific","abilitySpecific","abilityItem","protosynthesis","quarkdrive","_i22","_item$itemUser","itemUser","nfe","findIndex","fragileItems","volatileItems","pokeballItems","berryItems","tradeEvoItems","evolutionItems","consumableItems","_i24","_ref19","v","_BattleTypedSearch5","_this6","_len2","_key2","_proto6","getFlagWeightsForTypes","TypeAffinityAversion","weights","_i26","affinity","w","aversion","getMoveAffinityScore","flagWeights","score","moveIsNotUseless","_this$formatType12","abilityid","itemid","weightkg","GOOD_DOUBLES_MOVES","GOOD_STATUS_MOVES","basePower","GOOD_WEAK_MOVES","BAD_STRONG_MOVES","_this$formatType13","_this$formatType14","_this$formatType15","_this$formatType16","_lsetTable","isSTABmons","isTradebacks","regionBornLegality","sketchMoves","sketch","lsetTable","_this$formatType17","_BattleTeambuilderTab","_this$formatType18","_BattleTeambuilderTab2","_this$formatType19","_BattleTeambuilderTab3","learnsetEntry","minGenCode","nonstandardMoves","isMax","isZ","speciesTypes","moveTypes","genDex","prevoSpecies","excludedForme","s","forme","otherFormes","_i28","_baseSpecies$otherFor2","formeName","valid","_i30","neutral","allMoveIds","x","_i32","a","b","out","_i34","_ref20","_this7","powerTable","frustration","spitup","trumpcard","naturalgift","grassknot","lowkick","gyroball","electroball","flail","reversal","present","wringout","crushgrip","heatcrash","heavyslam","fling","magnitude","beatup","punishment","psywave","nightshade","seismictoss","dragonrage","sonicboom","superfang","endeavor","sheercold","fissure","horndrill","guillotine","_ref21","_ref22","move1","move2","pow1","pow2","_ref23","_ref24","accuracy1","accuracy","accuracy2","_ref25","_ref26","_m1$critRatio","_m2$critRatio","m1","m2","c1","critRatio","c2","_ref27","_ref28","pp1","pp","pp2","_ref29","_ref30","f1","f2","_ref31","_ref32","_BattleTypedSearch6","_proto7","physical","special","status","_BattleTypedSearch7","_proto8","contact","binding","bite","bomb","bullet","drain","explosive","fist","powder","pulse","slicing","sound","wind","airborne","aura","beam","breath","claw","crash","crush","kick","launch","light","lunar","magic","pierce","shadow","solar","spin","sweep","weapon","wing","bypassprotect","nonreflectable","nonmirror","nonsnatchable","bypasssubstitute","maxmove","gmaxmove","zmove","_BattleTypedSearch8","_proto9"],"sources":["../src/battle-dex-search.ts"],"sourcesContent":["/**\r\n * Search code for searching for dex information, used by the Dex and Teambuilder.\r\n * Dependencies: battledata, search-index\r\n * Optional dependencies: pokedex, moves, items, abilities\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\nimport { Dex, type ModdedDex, toID, type ID } from \"./battle-dex\";\r\nexport type SearchType = ( 'pokemon' | 'type' | 'tier' | 'move' | 'flag' | 'item' | 'ability' | 'egggroup' | 'category' | 'article' | 'itemclass' );\r\nexport type SearchRow = ( [SearchType, ID, number?, number?] | ['sortpokemon' | 'sortmove', ''] | ['header' | 'html', string] );\r\ntype SearchFilter = [string, string];\r\n/** ID, SearchType, index (if alias), offset (if offset alias) */\r\ndeclare const BattleSearchIndex: [ID, SearchType, number?, number?][];\r\ndeclare const BattleSearchIndexOffset: any;\r\ndeclare const BattleTeambuilderTable: any;\r\n// Backend for search UIs.\r\nexport class DexSearch {\r\n\tquery = '';\r\n\t// Dex for the mod/generation to search.\r\n\tdex: ModdedDex = Dex;\r\n\ttypedSearch: BattleTypedSearch<SearchType> | null = null;\r\n\tresults: SearchRow[] | null = null;\r\n\tprependResults: SearchRow[] | null = null;\r\n\texactMatch = false;\r\n\tstatic typeTable = {\r\n\t\tpokemon: 1,\r\n\t\ttype: 2,\r\n\t\ttier: 3,\r\n\t\tmove: 4,\r\n\t\titem: 5,\r\n\t\tability: 6,\r\n\t\tegggroup: 7,\r\n\t\tcategory: 8,\r\n\t\tarticle: 9,\r\n\t\tflag: 10,\r\n\t\titemclass: 11,\r\n\t};\r\n\tstatic typeName = {\r\n\t\tpokemon: 'Pok\\u00e9mon',\r\n\t\ttype: 'Type',\r\n\t\ttier: 'Tiers',\r\n\t\tmove: 'Moves',\r\n\t\tflag: 'Flags',\r\n\t\titem: 'Items',\r\n\t\tability: 'Abilities',\r\n\t\tegggroup: 'Egg group',\r\n\t\tcategory: 'Category',\r\n\t\tarticle: 'Article',\r\n\t\titemclass: 'Item Class',\r\n\t};\r\n\tfirstPokemonColumn: 'Tier' | 'Number' = 'Number';\r\n\t/**\r\n\t * Column to sort by. Default is `null`, a smart sort determined by how good\r\n\t * things are according to the base filters, falling back to dex number (for Pokemon) and name (for everything else).\r\n\t */\r\n\tsortCol: string | null = null;\r\n\treverseSort = false;\r\n\t// Filters for the search result. Does not include the two base filters (format and species).\r\n\tfilters: SearchFilter[] | null = null;\r\n\tconstructor(searchType: SearchType | '' = '', formatid = '' as ID, species = '' as ID) { this.setType(searchType, formatid, species); }\r\n\tgetTypedSearch(searchType: SearchType | '', format = '' as ID, speciesOrSet: ID | Dex.PokemonSet = '' as ID) {\r\n\t\tif (!searchType) return null;\r\n\t\tswitch (searchType) {\r\n\t\tcase 'pokemon': return new BattlePokemonSearch('pokemon', format, speciesOrSet);\r\n\t\tcase 'item': return new BattleItemSearch('item', format, speciesOrSet);\r\n\t\tcase 'move': return new BattleMoveSearch('move', format, speciesOrSet);\r\n\t\tcase 'flag': return new BattleFlagSearch('flag', format, speciesOrSet);\r\n\t\tcase 'ability': return new BattleAbilitySearch('ability', format, speciesOrSet);\r\n\t\tcase 'type': return new BattleTypeSearch('type', format, speciesOrSet);\r\n\t\tcase 'category': return new BattleCategorySearch('category', format, speciesOrSet);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tfind(query: string) {\r\n\t\tquery = toID(query);\r\n\t\tif (this.query === query && this.results && this.results.length > 0) { return false; }\r\n\t\tthis.query = query;\r\n\t\tif (!query) {\r\n\t\t\tthis.results = this.typedSearch?.getResults(this.filters, this.sortCol, this.reverseSort) || [];\r\n\t\t\tif (!this.filters && !this.sortCol && this.prependResults) { this.results = [...this.prependResults, ...this.results]; }\r\n\t\t} else { this.results = this.textSearch(query); }\r\n\t\treturn true;\r\n\t}\r\n\tsetType(searchType: SearchType | '', format = '' as ID, speciesOrSet: ID | Dex.PokemonSet = '' as ID) {\r\n\t\t// invalidate caches\r\n\t\tthis.results = null;\r\n\t\tif (searchType !== this.typedSearch?.searchType) {\r\n\t\t\tthis.filters = null;\r\n\t\t\tthis.sortCol = null;\r\n\t\t}\r\n\t\tthis.typedSearch = this.getTypedSearch(searchType, format, speciesOrSet);\r\n\t\tif (this.typedSearch) this.dex = this.typedSearch.dex;\r\n\t}\r\n\tcapitalizeFirst(str: string) { return str.charAt(0).toUpperCase() + str.slice(1); }\r\n\taddFilter(entry: SearchFilter | SearchRow): boolean {\r\n\t\tif (!this.typedSearch) return false;\r\n\t\tlet [type] = entry;\r\n\t\tif (this.typedSearch.searchType === 'pokemon') {\r\n\t\t\tif (type === this.sortCol) this.sortCol = null;\r\n\t\t\tif (!['type', 'move', 'flag', 'ability', 'tier'].includes(type)) return false;\r\n\t\t\tif (type === 'type') entry[1] = this.capitalizeFirst(entry[1]);\r\n\t\t\tif (type === 'move') entry[1] = toID(entry[1]);\r\n\t\t\tif (type === 'flag') {\r\n\t\t\t\t// Map flag IDs to tag names for Pokemon\r\n\t\t\t\tconst tagMap: {[id: string]: string} = {\r\n\t\t\t\t\t'legendary': 'Legendary',\r\n\t\t\t\t\t'restrictedlegendary': 'Restricted Legendary',\r\n\t\t\t\t\t'mythical': 'Mythical',\r\n\t\t\t\t\t'restrictedmythical': 'Restricted Mythical',\r\n\t\t\t\t\t'paradox': 'Paradox',\r\n\t\t\t\t\t'restrictedparadox': 'Restricted Paradox',\r\n\t\t\t\t\t'sublegendary': 'Sub-Legendary',\r\n\t\t\t\t\t'mega': 'Mega',\r\n\t\t\t\t\t'powerhouse': 'Powerhouse',\r\n\t\t\t\t};\r\n\t\t\t\tconst id = toID(entry[1]);\r\n\t\t\t\tentry[1] = tagMap[id] || this.capitalizeFirst(entry[1]);\r\n\t\t\t}\r\n\t\t\tif (type === 'ability') entry[1] = this.dex.abilities.get(entry[1]).name;\r\n\t\t\tif (type === 'tier') { // very hardcode\r\n\t\t\t\tconst tierTable: { [id: string]: string } = {\r\n\t\t\t\t\tuber: \"Uber\",\r\n\t\t\t\t\tcaplc: \"CAP LC\",\r\n\t\t\t\t\tcapnfe: \"CAP NFE\",\r\n\t\t\t\t};\r\n\t\t\t\tentry[1] = toID(entry[1]);\r\n\t\t\t\tentry[1] = tierTable[entry[1]] || entry[1].toUpperCase();\r\n\t\t\t}\r\n\t\t\tif (!this.filters) this.filters = [];\r\n\t\t\tthis.results = null;\r\n\t\t\tfor (const filter of this.filters) { if (filter[0] === type && filter[1] === entry[1]) { return true; } }\r\n\t\t\tthis.filters.push(entry.slice(0, 2) as SearchFilter);\r\n\t\t\treturn true;\r\n\t\t} else if (this.typedSearch.searchType === 'move') {\r\n\t\t\tif (type === this.sortCol) this.sortCol = null;\r\n\t\t\tif (!['type', 'category', 'flag', 'pokemon'].includes(type)) return false;\r\n\t\t\tif (type === 'type') entry[1] = this.capitalizeFirst(entry[1]);\r\n\t\t\tif (type === 'category') entry[1] = this.capitalizeFirst(entry[1]);\r\n\t\t\tif (type === 'flag') entry[1] = toID(entry[1]);\r\n\t\t\tif (type === 'pokemon') entry[1] = toID(entry[1]);\r\n\t\t\tif (!this.filters) this.filters = [];\r\n\t\t\tthis.filters.push(entry.slice(0, 2) as SearchFilter);\r\n\t\t\tthis.results = null;\r\n\t\t\treturn true;\r\n\t\t} else if (this.typedSearch.searchType === 'item') {\r\n\t\t\tif (type === this.sortCol) this.sortCol = null;\r\n\t\t\tif (!['itemclass'].includes(type)) return false;\r\n\t\t\tif (type === 'itemclass') {\r\n\t// store canonical ID (as ID type)\r\n\tlet classId = toID(entry[1]) as ID;\r\n\tif (classId === 'berries') classId = 'berry' as ID; // back-compat\r\n\tentry[1] = classId;\r\n}\r\n\t\t\tif (!this.filters) this.filters = [];\r\n\t\t\tthis.results = null;\r\n\t\t\tfor (const filter of this.filters) { if (filter[0] === type && filter[1] === entry[1]) { return true; } }\r\n\t\t\tthis.filters.push(entry.slice(0, 2) as SearchFilter);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tremoveFilter(entry?: SearchFilter): boolean {\r\n\t\tif (!this.filters) return false;\r\n\t\tif (entry) {\r\n\t\t\tconst filterid = entry.join(':');\r\n\t\t\tlet deleted: string[] | null = null;\r\n\t\t\t// delete specific filter\r\n\t\t\tfor (let i = 0; i < this.filters.length; i++) {\r\n\t\t\t\tif (filterid === this.filters[i].join(':')) {\r\n\t\t\t\t\tdeleted = this.filters[i];\r\n\t\t\t\t\tthis.filters.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!deleted) return false;\r\n\t\t} else { this.filters.pop(); }\r\n\t\tif (!this.filters.length) this.filters = null;\r\n\t\tthis.results = null;\r\n\t\treturn true;\r\n\t}\r\n\ttoggleSort(sortCol: string) {\r\n\t\tif (this.sortCol === sortCol) {\r\n\t\t\tif (!this.reverseSort) { this.reverseSort = true; } \r\n\t\t\telse {\r\n\t\t\t\tthis.sortCol = null;\r\n\t\t\t\tthis.reverseSort = false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.sortCol = sortCol;\r\n\t\t\tthis.reverseSort = false;\r\n\t\t}\r\n\t\tthis.results = null;\r\n\t}\r\n\tfilterLabel(filterType: string) {\r\n\t\tif (this.typedSearch && this.typedSearch.searchType !== filterType) { return 'Filter'; }\r\n\t\treturn null;\r\n\t}\r\n\tillegalLabel(id: ID) { return this.typedSearch?.illegalReasons?.[id] || null; }\r\n\tgetTier(species: Dex.Species) { return this.typedSearch?.getTier(species) || ''; }\r\n\ttextSearch(query: string): SearchRow[] {\r\n\t\t// Ensure baseResults and illegalReasons are populated\r\n\t\tif (this.typedSearch && !this.typedSearch.baseResults) { this.typedSearch.getResults(null, null); }\r\n\t\tif (this.typedSearch?.illegalReasons) { console.log('[DEBUG] illegalReasons count:', Object.keys(this.typedSearch.illegalReasons).length); }\r\n\t\t\r\n\t\tquery = toID(query);\r\n\t\t// BattleSearchIndexOffset may not exist in some builds; guard against it\r\n\t\tconst offsetTable: any = (typeof BattleSearchIndexOffset !== 'undefined' && BattleSearchIndexOffset) ? BattleSearchIndexOffset : [];\r\n\t\tthis.exactMatch = false;\r\n\t\tlet searchType: SearchType | '' = this.typedSearch?.searchType || '';\r\n\r\n\t\t// If searchType exists, we're searching mainly for results of that type.\r\n\t\t// We'll still search for results of other types, but those results\r\n\t\t// will only be used to filter results for that type.\r\n\t\tlet searchTypeIndex = (searchType ? DexSearch.typeTable[searchType] : -1);\r\n\r\n\t\t/** searching for \"Psychic type\" will make the type come up over the move */\r\n\t\tlet qFilterType: 'type' | '' = '';\r\n\t\tif (query.endsWith('type')) {\r\n\t\t\tif (query.slice(0, -4) in window.BattleTypeChart) {\r\n\t\t\t\tquery = query.slice(0, -4);\r\n\t\t\t\tqFilterType = 'type';\r\n\t\t\t}\r\n\t\t}\r\n\t\t// i represents the location of the search index we're looking at\r\n\t\tlet i = DexSearch.getClosest(query);\r\n\t\tthis.exactMatch = (BattleSearchIndex[i][0] === query);\r\n\t\t// Even with output buffer buckets, we make multiple passes through\r\n\t\t// the search index. searchPasses is a queue of which pass we're on:\r\n\t\t// [passType, i, query]\r\n\t\t// By doing an alias pass after the normal pass, we ensure that\r\n\t\t// mid-word matches only display after start matches.\r\n\t\tlet passType: SearchPassType | '' = '';\r\n\t\t/**\r\n\t\t * pass types:\r\n\t\t * * '': time to pop the next pass off the searchPasses queue\r\n\t\t * * 'normal': start at i and stop when results no longer start with query\r\n\t\t * * 'alias': like normal, but output aliases instead of non-alias results\r\n\t\t * * 'fuzzy': start at i and stop when you have two results\r\n\t\t * * 'exact': like normal, but stop at i\r\n\t\t */\r\n\t\ttype SearchPassType = 'normal' | 'alias' | 'fuzzy' | 'exact';\r\n\t\t/**\r\n\t\t * [passType, i, query]\r\n\t\t *\r\n\t\t * i = index of BattleSearchIndex to start from\r\n\t\t *\r\n\t\t * By doing an alias pass after the normal pass, we ensure that\r\n\t\t * mid-word matches only display after start matches.\r\n\t\t */\r\n\t\ttype SearchPass = [SearchPassType, number, string];\r\n\t\tlet searchPasses: SearchPass[] = [['normal', i, query]];\r\n\r\n\t\t// For performance reasons, only do an alias pass if query is at\r\n\t\t// least 2 chars long\r\n\t\tif (query.length > 1) searchPasses.push(['alias', i, query]);\r\n\r\n\t\t// If the query matches an official alias in BattleAliases: These are\r\n\t\t// different from the aliases in the search index and are given\r\n\t\t// higher priority. We'll do a normal pass through the index with\r\n\t\t// the alias text before any other passes.\r\n\t\tlet queryAlias;\r\n\t\tif (query in BattleAliases) {\r\n\t\t\tif (['sub', 'tr'].includes(query) || !toID(BattleAliases[query]).startsWith(query)) {\r\n\t\t\t\tqueryAlias = toID(BattleAliases[query]);\r\n\t\t\t\tlet aliasPassType: SearchPassType = (queryAlias === 'hiddenpower' ? 'exact' : 'normal');\r\n\t\t\t\tsearchPasses.unshift([aliasPassType, DexSearch.getClosest(queryAlias), queryAlias]);\r\n\t\t\t}\r\n\t\t\tthis.exactMatch = true;\r\n\t\t}\r\n\t\t// If there are no matches starting with query: Do a fuzzy match pass\r\n\t\t// Fuzzy matches will still be shown after alias matches\r\n\t\tif (!this.exactMatch && BattleSearchIndex[i][0].substr(0, query.length) !== query) {\r\n\t\t\t// No results start with this. Do a fuzzy match pass.\r\n\t\t\tlet matchLength = query.length - 1;\r\n\t\t\tif (!i) i++;\r\n\t\t\twhile (matchLength &&\r\n\t\t\t\tBattleSearchIndex[i][0].substr(0, matchLength) !== query.substr(0, matchLength) &&\r\n\t\t\t\tBattleSearchIndex[i - 1][0].substr(0, matchLength) !== query.substr(0, matchLength)) {\r\n\t\t\t\tmatchLength--;\r\n\t\t\t}\r\n\t\t\tlet matchQuery = query.substr(0, matchLength);\r\n\t\t\twhile (i >= 1 && BattleSearchIndex[i - 1][0].substr(0, matchLength) === matchQuery) i--;\r\n\t\t\tsearchPasses.push(['fuzzy', i, '']);\r\n\t\t}\r\n\t\t// We split the output buffers into 8 buckets. Bucket 0 is usually unused, and buckets 1-7 represent pokemon, types, moves, etc (see typeTable).\r\n\t\t// When we're done, the buffers are concatenated together to form our results, with each buffer getting its own header, unlike\r\n\t\t// multiple-pass results, which have no header.\r\n\t\t// Notes: if we have a searchType, that searchType's buffer will be on top\r\n\t\tlet bufs: SearchRow[][] = [[], [], [], [], [], [], [], [], [], [], [], []];\r\n\t\tlet topbufIndex = -1;\r\n\t\tlet count = 0;\r\n\t\tlet nearMatch = false;\r\n\t\t/** [type, id, typeIndex] */\r\n\t\tlet instafilter: [SearchType, ID, number] | null = null;\r\n\t\tlet instafilterSort = [0, 1, 2, 5, 4, 3, 6, 7, 8];\r\n\t\tlet illegal = this.typedSearch?.illegalReasons;\r\n\t\t// We aren't actually looping through the entirety of the searchIndex\r\n\t\tfor (i = 0; i < BattleSearchIndex.length; i++) {\r\n\t\t\tif (!passType) {\r\n\t\t\t\tlet searchPass = searchPasses.shift();\r\n\t\t\t\tif (!searchPass) break;\r\n\t\t\t\tpassType = searchPass[0];\r\n\t\t\t\ti = searchPass[1];\r\n\t\t\t\tquery = searchPass[2];\r\n\t\t\t}\r\n\t\t\tlet entry = BattleSearchIndex[i];\r\n\t\t\tif (!entry) { passType = ''; continue; }\r\n\t\t\tlet id = entry[0];\r\n\t\t\tlet type = entry[1];\r\n\t\t\tif (!id) { passType = ''; continue; }\r\n\t\t\tif (passType === 'fuzzy') {\r\n\t\t\t\t// fuzzy match pass; stop after 2 results\r\n\t\t\t\tif (count >= 2) {\r\n\t\t\t\t\tpassType = '';\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tnearMatch = true;\r\n\t\t\t} else if (passType === 'exact') {\r\n\t\t\t\t// exact pass; stop after 1 result\r\n\t\t\t\tif (count >= 1) {\r\n\t\t\t\t\tpassType = '';\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t} else if (id.substr(0, query.length) !== query) {\r\n\t\t\t\t// regular pass, time to move onto our next match\r\n\t\t\t\tpassType = '';\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (entry.length > 2) { if (passType !== 'alias') continue; } // alias entry\r\n\t\t\telse { if (passType === 'alias') continue; } // normal entry\r\n\t\t\tlet typeIndex = DexSearch.typeTable[type];\r\n\t\t\t// For performance, with a query length of 1, we only fill the first bucket\r\n\t\t\tif (query.length === 1 && typeIndex !== (searchType ? searchTypeIndex : 1)) continue;\r\n\t\t\t// For pokemon queries, accept types/tier/abilities/moves/eggroups/flags as filters\r\n\t\t\tif (searchType === 'pokemon' && (typeIndex === 5 || (typeIndex > 7 && typeIndex !== 10))) continue;\r\n\t\t\t// For move queries, accept types/categories/flags as filters\r\n\t\t\tif (searchType === 'move' && ((typeIndex !== 8 && typeIndex !== 10 && typeIndex > 4) || typeIndex === 3)) continue;\r\n\t\t\t// For move queries in the teambuilder, don't accept pokemon as filters\r\n\t\t\tif (searchType === 'move' && illegal && typeIndex === 1) continue;\r\n\t\t\t// For item queries, accept itemclass as a filter\r\n\t\t\tif (searchType === 'item' && typeIndex !== searchTypeIndex && typeIndex !== 11) continue;\r\n\t\t\t// For ability queries, don't accept anything else as a filter\r\n\t\t\tif (searchType === 'ability' && typeIndex !== searchTypeIndex) continue;\r\n\t\t\t// Query was a type name followed 'type'; only show types\r\n\t\t\tif (qFilterType === 'type' && typeIndex !== 2) continue;\r\n\t\t\t// For flag queries, accept flags/moves as filters\r\n\t\t\tif (searchType === 'flag' && ((typeIndex !== 10 && typeIndex !== 4))) continue;\r\n\t\t\t// hardcode cases of duplicate non-consecutive aliases\r\n\t\t\tif ((id === 'megax' || id === 'megay') && 'mega'.startsWith(query)) continue;\r\n\t\t\tlet matchStart = 0;\r\n\t\t\tlet matchEnd = 0;\r\n\t\t\tif (passType === 'alias') {\r\n\t\t\t\t// alias entry\r\n\t\t\t\t// [aliasid, type, originalid, matchStart, originalindex]\r\n\t\t\t\tmatchStart = entry[3]!;\r\n\t\t\t\tlet originalIndex = entry[2]!;\r\n\t\t\t\tif (matchStart) {\r\n\t\t\t\t\tmatchEnd = matchStart + query.length;\r\n\t\t\t\t\tconst offsetRow = BattleSearchIndexOffset?.[originalIndex] || '';\r\n\t\t\t\t\tmatchStart += (offsetRow[matchStart] || '0').charCodeAt(0) - 48;\r\n\t\t\t\t\tmatchEnd += (offsetRow[matchEnd - 1] || '0').charCodeAt(0) - 48;\r\n\t\t\t\t}\r\n\t\t\t\tconst originalEntry = BattleSearchIndex[originalIndex];\r\n\t\t\t\tif (!originalEntry) { passType = ''; continue; }\r\n\t\t\t\tid = originalEntry[0];\r\n\t\t\t} else {\r\n\t\t\t\tmatchEnd = query.length;\r\n\t\t\t\tconst offsetRow = BattleSearchIndexOffset[i] || '';\r\n\t\t\t\tif (matchEnd) matchEnd += (offsetRow[matchEnd - 1] || '0').charCodeAt(0) - 48;\r\n\t\t\t}\r\n\t\t\t// some aliases are substrings\r\n\t\t\tif (queryAlias === id && query !== id) continue;\r\n\t\t\t// This is a filter, set it as an instafilter candidate\r\n\t\t\tif (searchType && searchTypeIndex !== typeIndex) { if (!instafilter || instafilterSort[typeIndex] < instafilterSort[instafilter[2]]) { instafilter = [type, id, typeIndex]; } }\r\n\t\t\t// show types above Arceus formes\r\n\t\t\tif (topbufIndex < 0 && searchTypeIndex < 2 && passType === 'alias' && !bufs[1].length && bufs[2].length) { topbufIndex = 2; }\r\n\t\t\tif (illegal && typeIndex === searchTypeIndex) {\r\n\t\t\t\t// Always show illegal results under legal results.\r\n\t\t\t\t// This is done by putting legal results (and the type header)\r\n\t\t\t\t// in bucket 0, and illegal results in the searchType's bucket.\r\n\t\t\t\t// searchType buckets are always on top (but under bucket 0), so\r\n\t\t\t\t// illegal results will be seamlessly right under legal results.\r\n\t\t\t\tif (!bufs[typeIndex].length && !bufs[0].length) { bufs[0] = [['header', DexSearch.typeName[type]]]; }\r\n\t\t\t\tif (!(id in illegal)) typeIndex = 0;\r\n\t\t\t} else { if (!bufs[typeIndex].length) { bufs[typeIndex] = [['header', DexSearch.typeName[type]]]; } }\r\n\t\t\t// don't match duplicate aliases\r\n\t\t\tlet curBufLength = (passType === 'alias' && bufs[typeIndex].length);\r\n\t\t\tif (curBufLength && bufs[typeIndex][curBufLength - 1][1] === id) continue;\r\n\t\t\tbufs[typeIndex].push([type, id, matchStart, matchEnd]);\r\n\t\t\tcount++;\r\n\t\t}\r\n\t\tlet topbuf: SearchRow[] = [];\r\n\t\tif (nearMatch) { topbuf = [['html', `<em>No exact match found. The closest matches alphabetically are:</em>`]]; }\r\n\t\tif (topbufIndex >= 0) {\r\n\t\t\ttopbuf = topbuf.concat(bufs[topbufIndex]);\r\n\t\t\tbufs[topbufIndex] = [];\r\n\t\t}\r\n\t\tif (searchTypeIndex >= 0) {\r\n\t\t\ttopbuf = topbuf.concat(bufs[0]);\r\n\t\t\ttopbuf = topbuf.concat(bufs[searchTypeIndex]);\r\n\t\t\tbufs[searchTypeIndex] = [];\r\n\t\t\tbufs[0] = [];\r\n\t\t}\r\n\t\tif (instafilter && count < 20) {\r\n\t\t\t// Result count is less than 20, so we can instafilter\r\n\t\t\tbufs.push(this.instafilter(searchType, instafilter[0], instafilter[1]));\r\n\t\t}\r\n\t\tthis.results = Array.prototype.concat.apply(topbuf, bufs);\r\n\t\t// Filter results against baseResults for format legality\r\n\t\t// Only filter Pokemon, not other types like flags, types, abilities, etc.\r\n\t\tif (this.typedSearch && this.typedSearch.baseResults) {\r\n\t\t\tconst legalSet = new Set<string>();\r\n\t\t\tfor (const [type, id] of this.typedSearch.baseResults) { if (type !== 'header') { legalSet.add(id); } }\r\n\t\t\tthis.results = this.results.filter(([type, id]) => {\r\n\t\t\t\tif (type === 'header' || type === 'html') return true;\r\n\t\t\t\t// Only apply legality filtering to Pokemon, not to filters like flags\r\n\t\t\t\tif (type === this.typedSearch!.searchType) return legalSet.has(id);\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.results;\r\n\t}\r\n\tprivate instafilter(searchType: SearchType | '', fType: SearchType, fId: ID): SearchRow[] {\r\n\t\tlet buf: SearchRow[] = [];\r\n\t\tlet illegalBuf: SearchRow[] = [];\r\n\t\tlet illegal = this.typedSearch?.illegalReasons;\r\n\t\tif (searchType === 'pokemon') {\r\n\t\t\tswitch (fType) {\r\n\t\t\tcase 'type':\r\n\t\t\t\tlet type = fId.charAt(0).toUpperCase() + fId.slice(1) as Dex.TypeName;\r\n\t\t\t\tbuf.push(['header', `${type}-type Pok\\u00e9mon`]);\r\n\t\t\t\tfor (let id in BattlePokedex) {\r\n\t\t\t\t\tif (!BattlePokedex[id].types) continue;\r\n\t\t\t\t\tif (this.dex.species.get(id).types.includes(type)) { (illegal && id in illegal ? illegalBuf : buf).push(['pokemon', id as ID]); }\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'ability':\r\n\t\t\t\tlet ability = Dex.abilities.get(fId).name;\r\n\t\t\t\tbuf.push(['header', `${ability} Pok\\u00e9mon`]);\r\n\t\t\t\tfor (let id in BattlePokedex) {\r\n\t\t\t\t\tif (!BattlePokedex[id].abilities) continue;\r\n\t\t\t\t\tif (Dex.hasAbility(this.dex.species.get(id), ability)) { (illegal && id in illegal ? illegalBuf : buf).push(['pokemon', id as ID]); }\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'flag':\r\n\t\t\t\t// Map flag IDs to tag names (Pokemon tags)\r\n\t\t\t\tconst tagMap: {[id: string]: string} = {\r\n\t\t\t\t\t'legendary': 'Legendary',\r\n\t\t\t\t\t'restrictedlegendary': 'Restricted Legendary',\r\n\t\t\t\t\t'mythical': 'Mythical',\r\n\t\t\t\t\t'restrictedmythical': 'Restricted Mythical',\r\n\t\t\t\t\t'paradox': 'Paradox',\r\n\t\t\t\t\t'restrictedparadox': 'Restricted Paradox',\r\n\t\t\t\t\t'sublegendary': 'Sub-Legendary',\r\n\t\t\t\t\t'mega': 'Mega',\r\n\t\t\t\t\t'powerhouse': 'Powerhouse',\r\n\t\t\t\t};\r\n\t\t\t\tlet flagName = tagMap[fId] || fId.charAt(0).toUpperCase() + fId.slice(1);\r\n\t\t\t\tbuf.push(['header', `${flagName} Pok\\u00e9mon`]);\r\n\t\t\t\tfor (let id in BattlePokedex) {\r\n\t\t\t\t\tconst species = this.dex.species.get(id);\r\n\t\t\t\t\t// Check tags array or special properties like isMega\r\n\t\t\t\t\tif ((species.tags && species.tags.includes(flagName)) || (flagName === 'Mega' && species.isMega)) { (illegal && id in illegal ? illegalBuf : buf).push(['pokemon', id as ID]); }\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else if (searchType === 'move') {\r\n\t\t\tswitch (fType) {\r\n\t\t\tcase 'type':\r\n\t\t\t\tlet type = fId.charAt(0).toUpperCase() + fId.slice(1);\r\n\t\t\t\tbuf.push(['header', `${type}-type moves`]);\r\n\t\t\t\tfor (let id in BattleMovedex) {\r\n\t\t\t\t\tconst m: any = BattleMovedex[id];\r\n\t\t\t\t\tif (m.type === type || m.type2 === type) { (illegal && id in illegal ? illegalBuf : buf).push(['move', id as ID]); }\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'category':\r\n\t\t\t\tlet category = fId.charAt(0).toUpperCase() + fId.slice(1);\r\n\t\t\t\tbuf.push(['header', `${category} moves`]);\r\n\t\t\t\tfor (let id in BattleMovedex) { if (BattleMovedex[id].category === category) { (illegal && id in illegal ? illegalBuf : buf).push(['move', id as ID]); } }\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'flag':\r\n\t\t\t\tlet flagName = BattleFlags && BattleFlags[fId] ? BattleFlags[fId].name : fId.charAt(0).toUpperCase() + fId.slice(1);\r\n\t\t\t\tbuf.push(['header', `${flagName} moves`]);\r\n\t\t\t\tfor (let id in BattleMovedex) {\r\n\t\t\t\t\tconst move = BattleMovedex[id];\r\n\t\t\t\t\tif (move.flags && move.flags[fId]) { (illegal && id in illegal ? illegalBuf : buf).push(['move', id as ID]); }\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else if (searchType === 'item') {\r\n\t\t\tswitch (fType) {\r\n\t\t\tcase 'itemclass' as any:\r\n\t\t\t\tconst classId = (fId === 'berries' ? 'berry' : fId);\r\n\t\t\t\tlet className = fId.charAt(0).toUpperCase() + fId.slice(1);\r\n\t\t\t\t// Map the IDs to display names\r\n\t\t\t\tconst classNames: {[k: string]: string} = {\r\n\t\t\t\t\tfragile: 'Fragile',\r\n\t\t\t\t\tvolatile: 'Volatile',\r\n\t\t\t\t\tconsumable: 'Consumable',\r\n\t\t\t\t\tberry: 'Berry',\r\n\t\t\t\t\tpokeball: 'Pokéball',\r\n\t\t\t\t\tevolution: 'Evolution',\r\n\t\t\t\t\ttradeevo: 'Trade Evo',\r\n\t\t\t\t};\r\n\t\t\t\tclassName = classNames[classId] || className;\r\n\t\t\t\tbuf.push(['header', `${className} items`]);\r\n\t\t\t\tfor (let id in BattleItems) {\r\n\t\t\t\t\tconst item = this.dex.items.get(id);\r\n\t\t\t\t\tconst itemClass = BattleItemSearch.prototype.getItemClass(item);\r\n\t\t\t\t\tif (itemClass === classId) { buf.push(['item', id as ID]); }\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn [...buf, ...illegalBuf];\r\n\t}\r\n\tstatic getClosest(query: string) {\r\n\t\t// binary search through the index!\r\n\t\tlet left = 0;\r\n\t\tlet right = BattleSearchIndex.length - 1;\r\n\t\twhile (right > left) {\r\n\t\t\tlet mid = Math.floor((right - left) / 2 + left);\r\n\t\t\tif (BattleSearchIndex[mid][0] === query && (mid === 0 || BattleSearchIndex[mid - 1][0] !== query)) {\r\n\t\t\t\t// that's us\r\n\t\t\t\treturn mid;\r\n\t\t\t} else if (BattleSearchIndex[mid][0] < query) {\r\n\t\t\t\tleft = mid + 1;\r\n\t\t\t} else {\r\n\t\t\t\tright = mid - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (left >= BattleSearchIndex.length - 1) left = BattleSearchIndex.length - 1;\r\n\t\telse if (BattleSearchIndex[left + 1][0] && BattleSearchIndex[left][0] < query) left++;\r\n\t\tif (left && BattleSearchIndex[left - 1][0] === query) left--;\r\n\t\treturn left;\r\n\t}\r\n}\r\n//region Typed Search\r\nabstract class BattleTypedSearch<T extends SearchType> {\r\n\tsearchType: T;\r\n\t// Dex for the mod/generation to search.\r\n\tdex: ModdedDex = Dex;\r\n\t/**\r\n\t * Format is the first of two base filters. It constrains results to things\r\n\t * legal in the format, and affects the default sort.\r\n\t * This string specifically normalizes out generation number and the words\r\n\t * \"Doubles\" and \"Let's Go\" from the name.\r\n\t */\r\n\tformat = '' as ID;\r\n\t// `species` is the second of two base filters. It constrains results to things that species can use, and affects the default sort.\r\n\tspecies = '' as ID;\r\n\t/**\r\n\t * `set` is a pseudo-base filter; it has minor effects on move sorting.\r\n\t * (Abilities/items can affect what moves are sorted as usable.)\r\n\t */\r\n\tset: Dex.PokemonSet | null = null;\r\n\tprotected formatType: 'doubles' | 'bdsp' | 'bdspdoubles' | 'rs' | 'bw1' | 'letsgo' | 'metronome' | 'natdex' | 'nfe' |\r\n\t\t'ssdlc1' | 'ssdlc1doubles' | 'predlc' | 'predlcdoubles' | 'predlcnatdex' | 'svdlc1' | 'svdlc1doubles' |\r\n\t\t'svdlc1natdex' | 'stadium' | 'lc' | 'indigostarstorm' | null = null;\r\n\tisDoubles = false;\r\n\r\n\t// Cached copy of what the results list would be with only base filters (i.e. with an empty `query` and `filters`)\r\n\tbaseResults: SearchRow[] | null = null;\r\n\t// Cached copy of all results not in `baseResults` - mostly in case a user is wondering why a specific result isn't showing up.\r\n\tbaseIllegalResults: SearchRow[] | null = null;\r\n\tillegalReasons: { [id: string]: string } | null = null;\r\n\tresults: SearchRow[] | null = null;\r\n\tprotected readonly sortRow: SearchRow | null = null;\r\n\tconstructor(searchType: T, format = '' as ID, speciesOrSet: ID | Dex.PokemonSet = '' as ID) {\r\n\t\tthis.searchType = searchType;\r\n\t\tthis.baseResults = null;\r\n\t\tthis.baseIllegalResults = null;\r\n\r\n\t\tif (format.startsWith('gen')) {\r\n\t\t\tconst gen = (Number(format.charAt(3)) || 6);\r\n\t\t\tformat = (format.slice(4) || 'customgame') as ID;\r\n\t\t\tthis.dex = Dex.forGen(gen);\r\n\t\t} else if (!format) { this.dex = Dex; }\r\n\r\n\t\tif (format.startsWith('dlc1') && this.dex.gen === 8) {\r\n\t\t\tif (format.includes('doubles')) {\r\n\t\t\t\tthis.formatType = 'ssdlc1doubles';\r\n\t\t\t\tthis.isDoubles = true;\r\n\t\t\t} else { this.formatType = 'ssdlc1'; }\r\n\t\t\tformat = format.slice(4) as ID;\r\n\t\t}\r\n\t\tif (format.startsWith('predlc')) {\r\n\t\t\tif (format.includes('doubles') && !format.includes('nationaldex')) {\r\n\t\t\t\tthis.formatType = 'predlcdoubles';\r\n\t\t\t\tthis.isDoubles = true;\r\n\t\t\t} else if (format.includes('nationaldex')) { this.formatType = 'predlcnatdex'; } \r\n\t\t\telse { this.formatType = 'predlc'; }\r\n\t\t\tformat = format.slice(6) as ID;\r\n\t\t}\r\n\t\tif (format.startsWith('dlc1') && this.dex.gen === 9) {\r\n\t\t\tif (format.includes('doubles') && !format.includes('nationaldex')) {\r\n\t\t\t\tthis.formatType = 'svdlc1doubles';\r\n\t\t\t\tthis.isDoubles = true;\r\n\t\t\t} else if (format.includes('nationaldex')) { this.formatType = 'svdlc1natdex'; }\r\n\t\t\t else { this.formatType = 'svdlc1'; }\r\n\t\t\tformat = format.slice(4) as ID;\r\n\t\t}\r\n\t\tif (format.startsWith('stadium')) {\r\n\t\t\tthis.formatType = 'stadium';\r\n\t\t\tformat = format.slice(7) as ID;\r\n\t\t\tif (!format) format = 'ou' as ID;\r\n\t\t}\r\n\t\tif (format.startsWith('vgc')) {\r\n\t\t\tthis.formatType = 'doubles';\r\n\t\t\tthis.isDoubles = true;\r\n\t\t}\r\n\t\tif (format === 'vgc2020') { this.formatType = 'ssdlc1doubles'; }\r\n\t\tif (format.startsWith('vgc2023')) { this.formatType = format.endsWith('rege') ? 'svdlc1doubles' : 'predlcdoubles'; }\r\n\t\tif (format.includes('bdsp')) {\r\n\t\t\tif (format.includes('doubles')) {\r\n\t\t\t\tthis.formatType = 'bdspdoubles';\r\n\t\t\t\tthis.isDoubles = true;\r\n\t\t\t} else { this.formatType = 'bdsp'; }\r\n\t\t\tformat = format.slice(4) as ID;\r\n\t\t\tthis.dex = Dex.mod('gen8bdsp' as ID);\r\n\t\t}\r\n\t\tif (format.includes('bw1')) {\r\n\t\t\tthis.formatType = 'bw1';\r\n\t\t\tthis.dex = Dex.mod('gen5bw1' as ID);\r\n\t\t}\r\n\t\tif (format.includes('adv200')) {\r\n\t\t\tthis.formatType = 'rs';\r\n\t\t\tthis.dex = Dex.mod('gen3rs' as ID);\r\n\t\t}\r\n\t\tif (format === 'partnersincrime') this.formatType = 'doubles';\r\n\t\tif (format.startsWith('ffa') || format === 'freeforall') this.formatType = 'doubles';\r\n\t\tif (format.includes('letsgo')) {\r\n\t\t\tthis.formatType = 'letsgo';\r\n\t\t\tthis.dex = Dex.mod('gen7letsgo' as ID);\r\n\t\t}\r\n\t\t// must happen AFTER the \"gen9\" stripping block, so format is like \"indigostarstormou\" or \"indigostarstorm\"\r\nif (format.startsWith('indigostarstorm') || format.startsWith('isl')) {\r\n\tconsole.log('[DEBUG] ISL format detected, original format:', format);\r\n\tthis.formatType = 'indigostarstorm';\r\n\tthis.dex = Dex.mod('gen9indigostarstorm' as ID);\r\n\t// normalize: remove the mod marker so the remaining format is the actual tier (ou/uu/etc)\r\n\tif (format.startsWith('indigostarstorm')) {\r\n\t\tformat = format.slice('indigostarstorm'.length) as ID;\r\n\t} else {\r\n\t\tformat = format.slice('isl'.length) as ID;\r\n\t}\r\n\tif (!format) format = 'ou' as ID; // pick a sane default if someone selects just \"gen9indigostarstorm\"\r\n}\r\n\t\tif (format.includes('nationaldex') || format.startsWith('nd') || format.includes('natdex')) {\r\n\t\t\tformat = (format.startsWith('nd') ? format.slice(2) : format.includes('natdex') ? format.slice(6) : format.slice(11)) as ID;\r\n\t\t\tthis.formatType = 'natdex';\r\n\t\t\tif (!format) format = 'ou' as ID;\r\n\t\t\tthis.isDoubles = format.includes('doubles');\r\n\t\t}\r\n\t\tif (format.includes('doubles') && this.dex.gen > 4 && !this.formatType) {\r\n\t\t\tthis.formatType = 'doubles';\r\n\t\t\tthis.isDoubles = true;\r\n\t\t}\r\n\t\tif (this.formatType === 'letsgo') format = format.slice(6) as ID;\r\n\t\tif (format.includes('metronome')) {\r\n\t\t\tthis.formatType = 'metronome';\r\n\t\t}\r\n\t\tif (format.endsWith('nfe')) {\r\n\t\t\tformat = format.slice(3) as ID;\r\n\t\t\tthis.formatType = 'nfe';\r\n\t\t\tif (!format) format = 'ou' as ID;\r\n\t\t}\r\n\t\tif ((format.endsWith('lc') || format.startsWith('lc')) && format !== 'caplc' && !this.formatType) {\r\n\t\t\tthis.formatType = 'lc';\r\n\t\t\tformat = 'lc' as ID;\r\n\t\t}\r\n\t\tif (format.endsWith('draft')) {\r\n\t\t\tformat = format.slice(0, -5) as ID;\r\n\t\t\tif (!format) format = 'anythinggoes' as ID;\r\n\t\t}\r\n\t\tthis.format = format;\r\n\t\tthis.species = '' as ID;\r\n\t\tthis.set = null;\r\n\t\tif (typeof speciesOrSet === 'string') {\r\n\t\t\tif (speciesOrSet) this.species = speciesOrSet;\r\n\t\t} else {\r\n\t\t\tthis.set = speciesOrSet;\r\n\t\t\tthis.species = toID(this.set.species);\r\n\t\t}\r\n\t\t// if (!searchType || !this.set) return;\r\n\t}\r\n\tgetResults(filters?: SearchFilter[] | null, sortCol?: string | null, reverseSort?: boolean): SearchRow[] {\r\n\t\tif (sortCol === 'type') { return [this.sortRow!, ...BattleTypeSearch.prototype.getDefaultResults.call(this, reverseSort)]; } \r\n\t\telse if (sortCol === 'category') { return [this.sortRow!, ...BattleCategorySearch.prototype.getDefaultResults.call(this, reverseSort)]; } \r\n\t\telse if (sortCol === 'ability') { return [this.sortRow!, ...BattleAbilitySearch.prototype.getDefaultResults.call(this, reverseSort)]; } \r\n\t\telse if (sortCol === 'flag') { return [this.sortRow!, ...BattleFlagSearch.prototype.getDefaultResults.call(this, reverseSort)]; }\r\n\t\tif (!this.baseResults) { this.baseResults = this.getBaseResults(); }\r\n\t\tif (!this.baseIllegalResults) {\r\n\t\t\tconst legalityFilter: { [id: string]: 1 } = {};\r\n\t\t\tfor (const [resultType, value] of this.baseResults) { if (resultType === this.searchType) legalityFilter[value] = 1; }\r\n\t\t\tthis.baseIllegalResults = [];\r\n\t\t\tthis.illegalReasons = {};\r\n\t\t\tfor (const id in this.getTable()) {\r\n\t\t\t\tif (!(id in legalityFilter)) {\r\n\t\t\t\t\tthis.baseIllegalResults.push([this.searchType, id as ID]);\r\n\t\t\t\t\tthis.illegalReasons[id] = 'Illegal';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet results: SearchRow[];\r\n\t\tlet illegalResults: SearchRow[] | null;\r\n\t\tif (filters) {\r\n\t\t\tresults = [];\r\n\t\t\tillegalResults = [];\r\n\t\t\tfor (const result of this.baseResults) {\r\n\t\t\t\tif (this.filter(result, filters)) {\r\n\t\t\t\t\tif (results.length && result[0] === 'header' && results[results.length - 1][0] === 'header') { results[results.length - 1] = result; } \r\n\t\t\t\t\telse { results.push(result); }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (results.length && results[results.length - 1][0] === 'header') { results.pop(); }\r\n\t\t\tfor (const result of this.baseIllegalResults) { if (this.filter(result, filters)) { illegalResults.push(result); } }\r\n\t\t} else {\r\n\t\t\tresults = [...this.baseResults];\r\n\t\t\tillegalResults = null;\r\n\t\t}\r\n\t\tif (this.defaultFilter) { results = this.defaultFilter(results); }\r\n\t\tif (sortCol) {\r\n\t\t\tresults = results.filter(([rowType]) => rowType === this.searchType);\r\n\t\t\tresults = this.sort(results, sortCol, reverseSort);\r\n\t\t\tif (illegalResults) {\r\n\t\t\t\tillegalResults = illegalResults.filter(([rowType]) => rowType === this.searchType);\r\n\t\t\t\tillegalResults = this.sort(illegalResults, sortCol, reverseSort);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.sortRow) { results = [this.sortRow, ...results]; }\r\n\t\tif (illegalResults?.length) { results = [...results, ['header', \"Illegal results\"], ...illegalResults]; }\r\n\t\treturn results;\r\n\t}\r\n\tprotected firstLearnsetid(speciesid: ID) {\r\n\t\tlet table = BattleTeambuilderTable;\r\n\t\tif (this.formatType?.startsWith('bdsp')) table = table['gen8bdsp'];\r\n\t\tif (this.formatType === 'letsgo') table = table['gen7letsgo'];\r\n\t\tif (this.formatType === 'bw1') table = table['gen5bw1'];\r\n\t\tif (this.formatType === 'rs') table = table['gen3rs'];\r\n\t\tif ((this.formatType as any) === 'indigostarstorm') table = table['gen9indigostarstorm'] || table;\r\n\t\tif (table && table.learnsets && speciesid in table.learnsets) return speciesid;\r\n\t\tconst species = this.dex.species.get(speciesid);\r\n\t\tif (!species.exists) return '' as ID;\r\n\t\tlet baseLearnsetid = toID(species.baseSpecies);\r\n\t\tif (typeof species.battleOnly === 'string' && species.battleOnly !== species.baseSpecies) { baseLearnsetid = toID(species.battleOnly); }\r\n\t\tif (table && table.learnsets && baseLearnsetid in table.learnsets) return baseLearnsetid;\r\n\t\treturn '' as ID;\r\n\t}\r\n\tprotected nextLearnsetid(learnsetid: ID, speciesid: ID, checkingMoves = false) {\r\n\t\tif (learnsetid === 'lycanrocdusk' || (speciesid === 'rockruff' && learnsetid === 'rockruff')) { return 'rockruffdusk' as ID; }\r\n\t\tconst lsetSpecies = this.dex.species.get(learnsetid);\r\n\t\tif (!lsetSpecies.exists) return '' as ID;\r\n\t\tif (lsetSpecies.id === 'gastrodoneast') return 'gastrodon' as ID;\r\n\t\tif (lsetSpecies.id === 'pumpkaboosuper') return 'pumpkaboo' as ID;\r\n\t\tif (lsetSpecies.id === 'sinisteaantique') return 'sinistea' as ID;\r\n\t\tif (lsetSpecies.id === 'tatsugiristretchy') return 'tatsugiri' as ID;\r\n\t\tconst next = lsetSpecies.battleOnly || lsetSpecies.changesFrom || lsetSpecies.prevo;\r\n\t\tif (next) return toID(next);\r\n\t\tif (checkingMoves && !lsetSpecies.prevo && lsetSpecies.baseSpecies && this.dex.species.get(lsetSpecies.baseSpecies).prevo) {\r\n\t\t\tlet baseEvo = this.dex.species.get(lsetSpecies.baseSpecies);\r\n\t\t\twhile (baseEvo.prevo) { baseEvo = this.dex.species.get(baseEvo.prevo); }\r\n\t\t\treturn toID(baseEvo);\r\n\t\t}\r\n\t\treturn '' as ID;\r\n\t}\r\n\tprotected canLearn(speciesid: ID, moveid: ID) {\r\n\t\tconst move = this.dex.moves.get(moveid);\r\n\t\tif (this.formatType === 'natdex' && move.isNonstandard && move.isNonstandard !== 'Past') { return false; }\r\n\t\tconst gen = this.dex.gen;\r\n\t\tlet genChar = `${gen}`;\r\n\t\tif (\r\n\t\t\tthis.format.startsWith('vgc') ||\r\n\t\t\tthis.format.startsWith('bss') ||\r\n\t\t\tthis.format.startsWith('battlespot') ||\r\n\t\t\tthis.format.startsWith('battlestadium') ||\r\n\t\t\tthis.format.startsWith('battlefestival') ||\r\n\t\t\t(this.dex.gen === 9 && this.formatType !== 'natdex')\r\n\t\t) {\r\n\t\t\tif (gen === 9) { genChar = 'a'; } \r\n\t\t\telse if (gen === 8) { genChar = 'g'; } \r\n\t\t\telse if (gen === 7) { genChar = 'q'; } \r\n\t\t\telse if (gen === 6) { genChar = 'p'; }\r\n\t\t}\r\n\t\tconsole.log('[DEBUG canLearn]', {speciesid, moveid, gen, genChar, formatType: this.formatType});\r\n\t\tlet learnsetid = this.firstLearnsetid(speciesid);\r\n\t\tconsole.log('[DEBUG canLearn] firstLearnsetid:', learnsetid);\r\n\t\twhile (learnsetid) {\r\n\t\t\tlet table = BattleTeambuilderTable;\r\n\t\t\tif (this.formatType?.startsWith('bdsp')) table = table['gen8bdsp'];\r\n\t\t\tif (this.formatType === 'letsgo') table = table['gen7letsgo'];\r\n\t\t\tif (this.formatType === 'bw1') table = table['gen5bw1'];\r\n\t\t\tif (this.formatType === 'rs') table = table['gen3rs'];\r\n\t\t\tif ((this.formatType as any) === 'indigostarstorm') table = table['gen9indigostarstorm'] || table;\r\n\t\t\tif (!table || !table.learnsets) {\r\n\t\t\t\tconsole.log('[DEBUG canLearn] No table or learnsets');\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tlet learnset = table.learnsets[learnsetid];\r\n\t\t\tconsole.log('[DEBUG canLearn] learnset for', learnsetid, ':', learnset ? Object.keys(learnset).slice(0, 5) : 'undefined');\r\n\t\t\tif (learnset && moveid in learnset) { console.log('[DEBUG canLearn] Move found!', moveid, 'data:', learnset[moveid], 'checking for genChar:', genChar); }\r\n\t\t\tconst eggMovesOnly = this.eggMovesOnly(learnsetid, speciesid);\r\n\t\t\tif (learnset && (moveid in learnset) && (!this.format.startsWith('tradebacks') ? learnset[moveid].includes(genChar) :\r\n\t\t\t\tlearnset[moveid].includes(genChar) || (learnset[moveid].includes(`${gen + 1}`) && move.gen === gen)) && (!eggMovesOnly || (learnset[moveid].includes('e') && this.dex.gen === 9))\r\n\t\t\t) { return true; }\r\n\t\t\tlearnsetid = this.nextLearnsetid(learnsetid, speciesid, true);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tgetTier(pokemon: Dex.Species) {\r\n\t\tif (this.formatType === 'metronome') { return pokemon.num >= 0 ? String(pokemon.num) : pokemon.tier; }\r\n\t\tlet table = window.BattleTeambuilderTable;\r\n\t\tconst gen = this.dex.gen;\r\n\t\tconst tableKey = this.formatType === 'doubles' ? `gen${gen}doubles` :\r\n\t\t\tthis.formatType === 'letsgo' ? 'gen7letsgo' :\r\n\t\t\tthis.formatType === 'bdsp' ? 'gen8bdsp' :\r\n\t\t\tthis.formatType === 'bdspdoubles' ? 'gen8bdspdoubles' :\r\n\t\t\tthis.formatType === 'bw1' ? 'gen5bw1' :\r\n\t\t\tthis.formatType === 'rs' ? 'gen3rs' :\r\n\t\t\t(this.formatType as any) === 'indigostarstorm' ? 'gen9indigostarstorm' :\r\n\t\t\tthis.formatType === 'nfe' ? `gen${gen}nfe` :\r\n\t\t\tthis.formatType === 'lc' ? `gen${gen}lc` :\r\n\t\t\tthis.formatType === 'ssdlc1' ? 'gen8dlc1' :\r\n\t\t\tthis.formatType === 'ssdlc1doubles' ? 'gen8dlc1doubles' :\r\n\t\t\tthis.formatType === 'predlc' ? 'gen9predlc' :\r\n\t\t\tthis.formatType === 'predlcdoubles' ? 'gen9predlcdoubles' :\r\n\t\t\tthis.formatType === 'predlcnatdex' ? 'gen9predlcnatdex' :\r\n\t\t\tthis.formatType === 'svdlc1' ? 'gen9dlc1' :\r\n\t\t\tthis.formatType === 'svdlc1doubles' ? 'gen9dlc1doubles' :\r\n\t\t\tthis.formatType === 'svdlc1natdex' ? 'gen9dlc1natdex' :\r\n\t\t\tthis.formatType === 'natdex' ? `gen${gen}natdex` :\r\n\t\t\tthis.formatType === 'stadium' ? `gen${gen}stadium${gen > 1 ? gen : ''}` :\r\n\t\t\t(this.formatType as any) === 'indigostarstorm' ? 'gen9indigostarstorm' :\r\n\t\t\t`gen${gen}`;\r\n\t\tif (table?.[tableKey]) { table = table[tableKey]; }\r\n\t\tif (!table || !table.overrideTier) return pokemon.tier;\r\n\t\tlet id = pokemon.id;\r\n\t\tif (id in table.overrideTier) { return table.overrideTier[id]; }\r\n\t\tif (id.endsWith('totem') && id.slice(0, -5) in table.overrideTier) { return table.overrideTier[id.slice(0, -5)]; }\r\n\t\tid = toID(pokemon.baseSpecies);\r\n\t\tif (id in table.overrideTier) { return table.overrideTier[id]; }\r\n\t\treturn pokemon.tier;\r\n\t}\r\n\teggMovesOnly(child: ID, father: ID) {\r\n\t\tif (this.dex.species.get(child).baseSpecies === this.dex.species.get(father).baseSpecies) return false;\r\n\t\tconst baseSpecies = father;\r\n\t\twhile (father) {\r\n\t\t\tif (child === father) return false;\r\n\t\t\tfather = this.nextLearnsetid(father, baseSpecies);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\tabstract getTable(): { [id: string]: any };\r\n\tabstract getDefaultResults(): SearchRow[];\r\n\tabstract getBaseResults(): SearchRow[];\r\n\tabstract filter(input: SearchRow, filters: string[][]): boolean;\r\n\tdefaultFilter?(input: SearchRow[]): SearchRow[];\r\n\tabstract sort(input: SearchRow[], sortCol: string, reverseSort?: boolean): SearchRow[];\r\n\t\r\n}\r\n//region Pokemon Search\r\nclass BattlePokemonSearch extends BattleTypedSearch<'pokemon'> {\r\n\toverride sortRow: SearchRow = ['sortpokemon', ''];\r\n\tgetTable() { return BattlePokedex; }\r\n\tgetDefaultResults(): SearchRow[] {\r\n\t\tlet results: SearchRow[] = [];\r\n\t\tfor (let id in BattlePokedex) {\r\n\t\t\tswitch (id) {\r\n\t\t\tcase 'bulbasaur': results.push(['header', \"Generation 1\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'chikorita': results.push(['header', \"Generation 2\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'treecko': results.push(['header', \"Generation 3\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'turtwig': results.push(['header', \"Generation 4\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'victini': results.push(['header', \"Generation 5\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'chespin': results.push(['header', \"Generation 6\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'rowlet': results.push(['header', \"Generation 7\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'grookey': results.push(['header', \"Generation 8\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'sprigatito': results.push(['header', \"Generation 9\"]);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tresults.push(['pokemon', id as ID]);\r\n\t\t}\r\n\t\treturn results;\r\n\t}\r\n\tgetBaseResults(): SearchRow[] {\r\n\t\tconst format = this.format;\r\n\t\tif (!format) return this.getDefaultResults();\r\n\t\tconst isVGCOrBS = format.startsWith('battlespot') || format.startsWith('bss') || format.startsWith('battlestadium') || format.startsWith('vgc');\r\n\t\tconst isHackmons = format.includes('hackmons') || format.endsWith('bh');\r\n\t\tlet isDoublesOrBS = isVGCOrBS || this.formatType?.includes('doubles');\r\n\t\tconst dex = this.dex;\r\n\t\tlet table = BattleTeambuilderTable;\r\n\t\tif ((format.endsWith('cap') || format.endsWith('caplc')) && dex.gen < 9) { table = table[`gen${dex.gen}`]; } \r\n\t\telse if (isVGCOrBS) { table = table[`gen${dex.gen}vgc`]; } \r\n\t\telse if (dex.gen === 9 && isHackmons && !this.formatType) { table = table['bh']; } \r\n\t\telse if (\r\n\t\t\ttable[`gen${dex.gen}doubles`] && dex.gen > 4 &&\r\n\t\t\tthis.formatType !== 'letsgo' && this.formatType !== 'bdspdoubles' &&\r\n\t\t\tthis.formatType !== 'ssdlc1doubles' && this.formatType !== 'predlcdoubles' &&\r\n\t\t\tthis.formatType !== 'svdlc1doubles' && this.formatType !== 'indigostarstorm' &&\r\n\t\t\t!this.formatType?.includes('natdex') &&\r\n\t\t\t(\r\n\t\t\t\tformat.includes('doubles') || format.includes('triples') ||\r\n\t\t\t\tformat === 'freeforall' || format.startsWith('ffa') ||\r\n\t\t\t\tformat === 'partnersincrime'\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\ttable = table[`gen${dex.gen}doubles`];\r\n\t\t\tisDoublesOrBS = true;\r\n\t\t} \r\n\t\telse if (dex.gen < 9 && !this.formatType) { table = table[`gen${dex.gen}`]; } \r\n\t\telse if (this.formatType?.startsWith('bdsp')) { table = table['gen8' + this.formatType]; } \r\n\t\telse if (this.formatType === 'letsgo') { table = table['gen7letsgo']; } \r\n\t\telse if (this.formatType === 'bw1') { table = table['gen5bw1']; } \r\n\t\telse if (this.formatType === 'rs') { table = table['gen3rs']; } \r\n\t\telse if (this.formatType === 'natdex') { table = table[`gen${dex.gen}natdex`]; } \r\n\t\telse if (this.formatType === 'metronome') { table = table[`gen${dex.gen}metronome`]; } \r\n\t\telse if (this.formatType === 'nfe') { table = table[`gen${dex.gen}nfe`]; } \r\n\t\telse if (this.formatType === 'lc') { table = table[`gen${dex.gen}lc`]; } \r\n\t\telse if (this.formatType?.startsWith('ssdlc1')) {\r\n\t\t\tif (this.formatType.includes('doubles')) { table = table['gen8dlc1doubles']; } \r\n\t\t\telse { table = table['gen8dlc1']; }\r\n\t\t} else if (this.formatType?.startsWith('predlc')) {\r\n\t\t\tif (this.formatType.includes('doubles')) { table = table['gen9predlcdoubles']; } \r\n\t\t\telse if (this.formatType.includes('natdex')) { table = table['gen9predlcnatdex']; } \r\n\t\t\telse { table = table['gen9predlc']; }\r\n\t\t} else if (this.formatType?.startsWith('svdlc1')) {\r\n\t\t\tif (this.formatType.includes('doubles')) { table = table['gen9dlc1doubles']; } \r\n\t\t\telse if (this.formatType.includes('natdex')) { table = table['gen9dlc1natdex']; } \r\n\t\t\telse { table = table['gen9dlc1']; }\r\n\t\t} else if ((this.formatType as any) === 'indigostarstorm') {\r\n\t\t\ttable = table['gen9indigostarstorm'];\r\n\t\t\tconsole.log('[DEBUG] Loading gen9indigostarstorm table, table exists:', !!table, 'has tiers:', !!table?.tiers, 'has formatSlices:', !!table?.formatSlices, 'slice keys:', Object.keys(table?.formatSlices || {}));\r\n\t\t\tif (!table) {\r\n\t\t\t\tconsole.error('[DEBUG] gen9indigostarstorm table not found. ISL teambuilder will be empty.');\r\n\t\t\t\ttable = { tierSet: [], formatSlices: {} } as any;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!table || !table.tierSet) {\r\n\t\t\tif (table && table.tiers) {\r\n\t\t\t\ttable.tierSet = table.tiers.map((r: any) => {\r\n\t\t\t\t\tif (typeof r === 'string') return ['pokemon', r];\r\n\t\t\t\t\treturn [r[0], r[1]];\r\n\t\t\t\t});\r\n\t\t\t\tif ((this.formatType as any) !== 'indigostarstorm') table.tiers = null;\r\n\t\t\t} else {\r\n\t\t\t\t// If table doesn't have tiers, create an empty tierSet\r\n\t\t\t\tconsole.log('[DEBUG] Table has no tiers, creating empty tierSet');\r\n\t\t\t\tif (!table) table = {};\r\n\t\t\t\ttable.tierSet = [];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\ttable.tierSet = (table.tierSet || []).filter(([type, id]: any) => {\r\n\t\t// Keep real structural rows only\r\n\t\tif (type === 'header' || type === 'html' || type === 'sortpokemon' || type === 'sortmove') return true;\r\n\r\n\t\t// Treat EVERYTHING ELSE as a pokemon row if it resolves to a species id.\r\n\t\t// (This is the same pipeline Gmax/Past go through.)\r\n\t\tconst sp = this.dex.species.get(id);\r\n\t\tif (!sp || !sp.exists) return false;\r\n\r\n\t\t// Allow customs\r\n\t\tif (sp.num >= 10000 || sp.num < 0) return true;\r\n\r\n\t\tconst bs = this.dex.species.get(sp.baseSpecies || sp.name);\r\n\t\tconst ns = sp.isNonstandard || bs.isNonstandard;\r\n\t\tconst tier = this.getTier(sp as any);\r\n\t\tif (tier.startsWith('CAP')) console.log('[ISL FILTER] dropping', id, tier);\r\n\t\t// Filter-out like other banned groups\r\n\t\tif (tier.startsWith('CAP')) return false;\r\n\t\tif (id.startsWith('pokestar')) return false;\r\n\t\tif (sp.num === 0 || bs.num === 0) return false;\r\n\r\n\t\treturn ns !== 'Past' && ns !== 'Gigantamax';\r\n\t});\r\n\t\tlet tierSet: SearchRow[] = table.tierSet;\r\n\t\tlet slices: { [k: string]: number } = table.formatSlices || {};\r\n\t\t// ISL: derive the list from the Indigo Starstorm mod dex itself (what \"exists\" in the mod).\r\n// ISL: derive the teambuilder list from the Indigo Starstorm mod dex itself,\r\n// AND apply regulation-stage rules based on the format string.\r\nif ((this.formatType as any) === 'indigostarstorm') {\r\n\tconst results: SearchRow[] = [];\r\n\r\n\t// Helpers to compute evolution stage using dex data (no tags required)\r\n\tconst getStage = (sp: Dex.Species) => {\r\n\t\tlet stage = 1;\r\n\t\tlet cur = sp;\r\n\t\twhile (cur.prevo) {\r\n\t\t\tstage++;\r\n\t\t\tconst prev = this.dex.species.get(cur.prevo);\r\n\t\t\tif (!prev || !prev.exists) break;\r\n\t\t\tcur = prev;\r\n\t\t}\r\n\t\treturn stage;\r\n\t};\r\n\tconst canEvolve = (sp: Dex.Species) => !!(sp.evos && sp.evos.length);\r\n\r\n\t// Decide which stages are allowed for this regulation format\r\n\tconst isBabyLeague = format.includes('babyleague');          // Reg α\r\n\tconst isNFELeague = format.includes('nfeleague');            // Reg Δ\r\n\tconst isSingleStage = format.includes('singlestageonly');    // Reg ι\r\n\tconst isSecondStageLeague = format.includes('2ndstageleague'); // Reg β\r\n\r\n\t\tfor (const row of this.getDefaultResults()) {\r\n\t\t// Only keep real structural rows; don't auto-keep tier-labelled pokemon rows like ['CAP LC','syclar']\r\n\t\tif (row[0] !== 'pokemon') {\r\n\t\t\tif (row[0] === 'header' || row[0] === 'html' || row[0] === 'sortpokemon' || row[0] === 'sortmove') {\r\n\t\t\t\tresults.push(row);\r\n\t\t\t}\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tconst id = row[1];\r\n\t\tconst species = this.dex.species.get(id);\r\n\r\n\t\t// Only show Pokémon that exist in the ISL mod dex\r\n\t\tif (!species || !species.exists) continue;\r\n\r\n\t\t// Hide MissingNo / glitchy num=0 entries (prevents 0.png sprite fetch)\r\n\t\tconst base = this.dex.species.get(species.baseSpecies || species.name);\r\n\t\tif (species.num === 0 || base.num === 0) continue;\r\n\r\n\t\t// Always show custom Pokémon\r\n\t\tif (species.num >= 13000) {\r\n\t\t\tresults.push(row);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\t// Hide groups that should not appear in ISL lists\r\n\t\tconst ns = species.isNonstandard || base.isNonstandard;\r\nconst tier = this.getTier(species);\r\n\r\nif (ns === 'CAP' || tier.startsWith('CAP')) continue;\r\nif (ns === 'Pokestar' || id.startsWith('pokestar')) continue;\r\nif (ns === 'Past' || ns === 'Gigantamax') continue;\r\n\r\n\t\t// Apply regulation-stage constraints\r\n\t\tif (isBabyLeague) {\r\n\t\t\t// 1st-stage that can still evolve\r\n\t\t\tif (!(getStage(species) === 1 && canEvolve(species))) continue;\r\n\t\t} else if (isNFELeague) {\r\n\t\t\t// 1st-stage that can evolve OR 2nd-stage that can still evolve\r\n\t\t\tconst stage = getStage(species);\r\n\t\t\tif (!((stage === 1 && canEvolve(species)) || (stage === 2 && canEvolve(species)))) continue;\r\n\t\t} else if (isSingleStage) {\r\n\t\t\t// Single-stage only\r\n\t\t\tif (!(getStage(species) === 1 && !canEvolve(species))) continue;\r\n\t\t} else if (isSecondStageLeague) {\r\n\t\t\t// 1st-stage + 2nd-stage + single-stage, but NOT 3rd stage\r\n\t\t\tconst stage = getStage(species);\r\n\t\t\tif (stage >= 3) continue;\r\n\t\t}\r\n\t\t// else: Reg γ+ => no stage filtering\r\n\r\n\t\tresults.push(row);\r\n\t}\r\n\r\n\treturn results;\r\n}\r\n\t\tif (format === 'ubers' || format === 'uber' || format === 'ubersuu' || format === 'nationaldexdoubles') { tierSet = tierSet.slice(slices.Uber); } \r\n\t\telse if (isVGCOrBS || (isHackmons && dex.gen === 9 && !this.formatType)) {\r\n\t\t\tif (format.endsWith('series13') || format.endsWith('regj') || isHackmons) { } // Show Mythicals\r\n\t\t\telse if (\r\n\t\t\t\tformat === 'vgc2010' || format === 'vgc2016' || format.startsWith('vgc2019') ||\r\n\t\t\t\tformat === 'vgc2022' || format.endsWith('regg') || format.endsWith('regi')\r\n\t\t\t) { tierSet = tierSet.slice(slices[\"Restricted Legendary\"]); } \r\n\t\t\telse { tierSet = tierSet.slice(slices.Regular); }\r\n\t\t\t// Remove DLC Pokemon from Pre-DLC formats\r\n\t\t\tif (this.formatType?.includes('dlc')) { tierSet = tierSet.filter(([type, id]) => { return !['Unreleased', 'Illegal'].includes(this.getTier(this.dex.species.get(id))); }); }\r\n\r\n\t\t\tif (format.endsWith('regh')) {\r\n\t\t\t\ttierSet = tierSet.filter(([type, id]) => {\r\n\t\t\t\t\tconst tags = this.dex.species.get(this.dex.species.get(id).baseSpecies).tags;\r\n\t\t\t\t\treturn !tags.includes('Sub-Legendary') && !tags.includes('Paradox')\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else if (format === 'ou') tierSet = tierSet.slice(slices.OU);\r\n\t\telse if (format === 'uubl') tierSet = tierSet.slice(slices.UUBL);\r\n\t\telse if (format === 'uu') tierSet = tierSet.slice(slices.UU);\r\n\t\telse if (format === 'ru') tierSet = tierSet.slice(slices.RU || slices.UU);\r\n\t\telse if (format === 'nu') tierSet = tierSet.slice(slices.NU || slices.RU || slices.UU);\r\n\t\telse if (format === 'pu') tierSet = tierSet.slice(slices.PU || slices.NU);\r\n\t\telse if (format === 'zu' && dex.gen === 5) tierSet = tierSet.slice(slices.PU || slices.NU);\r\n\t\telse if (format === 'zu') tierSet = tierSet.slice(slices.ZU || slices.PU || slices.NU);\r\n\t\telse if ( format === 'lc' || format === 'lcuu' || format.startsWith('lc') || (format !== 'caplc' && format.endsWith('lc')) ) tierSet = tierSet.slice(slices.LC);\r\n\t\telse if (format === 'cap' || format.endsWith('cap')) { tierSet = tierSet.slice(0, slices.AG || slices.Uber).concat(tierSet.slice(slices.OU)); } \r\n\t\telse if (format === 'caplc') { tierSet = tierSet.slice(slices['CAP LC'], slices.AG || slices.Uber).concat(tierSet.slice(slices.LC)); } \r\n\t\telse if (format === 'anythinggoes' || format.endsWith('ag') || format.startsWith('ag')) { tierSet = tierSet.slice(slices.AG); } \r\n\t\telse if (isHackmons && (dex.gen < 9 || this.formatType === 'natdex')) { tierSet = tierSet.slice(slices.AG || slices.Uber); } \r\n\t\telse if (format === 'monotype' || format.startsWith('monothreat')) tierSet = tierSet.slice(slices.Uber);\r\n\t\telse if (format === 'doublesubers') tierSet = tierSet.slice(slices.DUber);\r\n\t\telse if (format === 'doublesou' && dex.gen > 4) tierSet = tierSet.slice(slices.DOU);\r\n\t\telse if (format === 'doublesuu') tierSet = tierSet.slice(slices.DUU);\r\n\telse if (this.formatType === 'indigostarstorm') {\r\n\tconsole.log('[DEBUG] ISL format detected. Format string:', format, 'Available slices:', Object.keys(slices || {}));\r\n\r\n\t// Defensive: slices must exist and have Reg α, otherwise don't attempt slicing\r\n\tif (!slices || slices['Reg α'] === undefined) {\r\n\t\tconsole.log('[DEBUG] ISL: formatSlices missing Reg α; skipping ISL slicing');\r\n\t\treturn tierSet;\r\n\t}\r\n\r\n\t// Read slice starts AFTER defensive check\r\n\tconst sA = slices['Reg α'];\r\n\tconst sD = slices['Reg Δ'] ?? tierSet.length;\r\n\tconst sI = slices['Reg ι'] ?? tierSet.length;\r\n\tconst sB = slices['Reg β'] ?? tierSet.length;\r\n\tconst sZ = slices['Reg ζ'] ?? tierSet.length;\r\n\tconst sG = slices['Reg γ'] ?? tierSet.length;\r\n\tconst sT = slices['Reg Θ'] ?? tierSet.length;\r\n\tconst sE = slices['Reg ε'] ?? tierSet.length;\r\n\tconst sL = slices['Reg λ'] ?? tierSet.length;\r\n\tconst sP = slices['Reg ψ'] ?? tierSet.length;\r\n\tconst sN = slices['Reg ν'] ?? tierSet.length;\r\n\tconst sF = slices['Reg φ'] ?? tierSet.length;\r\n\r\n\tlet start = sG;\r\n\tlet end = tierSet.length;\r\n\r\n\t// Match by normalized format id fragments\r\n\tif (format.includes('babyleague')) { start = sA; end = sD; }\r\n\telse if (format.includes('nfeleague')) { start = sD; end = sI; }\r\n\telse if (format.includes('singlestageonly')) { start = sI; end = sB; }\r\n\telse if (format.includes('2ndstageleague')) { start = sB; end = sZ; }\r\n\r\n\t// New regs:\r\n\telse if (format.includes('betaparadox') || (format.includes('beta') && format.includes('paradox'))) { start = sZ; end = sG; }\r\n\telse if (format.includes('3rdstageleague')) { start = sG; end = sT; }\r\n\r\n\telse if (format.includes('norestricted') || format.includes('norestrictedspecial')) { start = sT; end = sE; }\r\n\telse if (format.includes('restrictedparadox')) { start = sE; end = sL; }\r\n\r\n\telse if (format.includes('onerestricted') && format.includes('mythical')) { start = sN; end = sF; }\r\n\telse if (format.includes('tworestricted') && format.includes('mythical')) { start = sF; end = tierSet.length; }\r\n\r\n\telse if (format.includes('onerestricted')) { start = sL; end = sP; }\r\n\telse if (format.includes('tworestricted')) { start = sP; end = sN; }\r\n\r\n\telse { start = sG; end = tierSet.length; } // default γ+\r\n\r\n\ttierSet = tierSet.slice(start, end);\r\n\r\n\t// Filter out anything we never want visible in ISL teambuilder lists\r\n\ttierSet = tierSet.filter(([type, id]) => {\r\n\t\tif (type === 'header') return true;\r\n\r\n\t\tconst sp = this.dex.species.get(id);\r\n\t\tif (!sp || !sp.exists) return false;\r\n\r\n\t\t// Hide MissingNo / glitchy num=0 entries (prevents 0.png sprite fetch)\r\n\t\tif (sp.num === 0) return false;\r\n\r\n\t\t// Always keep customs\r\n\t\tif (sp.num >= 10000 || sp.num < 0) return true;\r\n\r\n\t\t// Hard-hide these groups\r\n\t\tif (sp.isNonstandard === 'Past' || sp.isNonstandard === 'Gigantamax' || sp.isNonstandard === 'CAP') return false;\r\n\r\n\t\t// Extra-hard CAP removal (in case isNonstandard isn't set how you expect)\r\n\t\tif (sp.tier === 'CAP' || sp.tier === 'CAP LC' || sp.tier === 'CAP NFE') return false;\r\n\r\n\t\treturn true;\r\n\t});\r\n}\r\n\t// Filter out Gmax Pokemon from standard tier selection\r\n\t\tif (!(/^(battlestadium|vgc|doublesubers)/g.test(format) || (format === 'doubles' && this.formatType === 'natdex'))) {\r\n\t\t\ttierSet = tierSet.filter(([type, id]) => {\r\n\t\t\t\tif (type === 'header' && id === 'DUber by technicality') return false;\r\n\t\t\t\tif (type === 'header' && id === 'Uber by technicality') return false;\r\n\t\t\t\tif (type === 'pokemon') return !id.endsWith('gmax');\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn tierSet;\r\n\t}\r\n\tfilter(row: SearchRow, filters: string[][]) {\r\n\t\tif (!filters) return true;\r\n\t\tif (row[0] !== 'pokemon') return true;\r\n\t\tconst species = this.dex.species.get(row[1]);\r\n\t\tfor (const [filterType, value] of filters) {\r\n\t\t\tswitch (filterType) {\r\n\t\t\tcase 'type': if (species.types[0] !== value && species.types[1] !== value) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'egggroup': if (species.eggGroups[0] !== value && species.eggGroups[1] !== value) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tier': if (this.getTier(species) !== value) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'ability': if (!Dex.hasAbility(species, value)) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'move': if (!this.canLearn(species.id, value as ID)) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'flag': if (value === 'Mega') { if (!species.isMega) return false; } // Special case for Mega since it uses isMega property\r\n\t\t\t\telse { if (!species.tags || !species.tags.includes(value)) return false; }\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\tsort(results: SearchRow[], sortCol: string, reverseSort?: boolean) {\r\n\t\tconst sortOrder = reverseSort ? -1 : 1;\r\n\t\tif (['hp', 'atk', 'def', 'spa', 'spd', 'spe'].includes(sortCol)) {\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tconst stat1 = this.dex.species.get(id1).baseStats[sortCol as Dex.StatName];\r\n\t\t\t\tconst stat2 = this.dex.species.get(id2).baseStats[sortCol as Dex.StatName];\r\n\t\t\t\treturn (stat2 - stat1) * sortOrder;\r\n\t\t\t});\r\n\t\t} else if (sortCol === 'bst') {\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tconst base1 = this.dex.species.get(id1).baseStats;\r\n\t\t\t\tconst base2 = this.dex.species.get(id2).baseStats;\r\n\t\t\t\tlet bst1 = base1.hp + base1.atk + base1.def + base1.spa + base1.spd + base1.spe;\r\n\t\t\t\tlet bst2 = base2.hp + base2.atk + base2.def + base2.spa + base2.spd + base2.spe;\r\n\t\t\t\tif (this.dex.gen === 1) {\r\n\t\t\t\t\tbst1 -= base1.spd;\r\n\t\t\t\t\tbst2 -= base2.spd;\r\n\t\t\t\t}\r\n\t\t\t\treturn (bst2 - bst1) * sortOrder;\r\n\t\t\t});\r\n\t\t} else if (sortCol === 'name') {\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tconst name1 = id1;\r\n\t\t\t\tconst name2 = id2;\r\n\t\t\t\treturn (name1 < name2 ? -1 : name1 > name2 ? 1 : 0) * sortOrder;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthrow new Error(\"invalid sortcol\");\r\n\t}\r\n}\r\n//region Ability Search\r\nclass BattleAbilitySearch extends BattleTypedSearch<'ability'> {\r\n\tgetTable() { return BattleAbilities; }\r\n\tgetDefaultResults(reverseSort?: boolean): SearchRow[] {\r\n\t\tconst results: SearchRow[] = [];\r\n\t\tfor (let id in BattleAbilities) { results.push(['ability', id as ID]); }\r\n\t\tif (reverseSort) results.reverse();\r\n\t\treturn results;\r\n\t}\r\n\tgetBaseResults(): SearchRow[] {\r\n\t\tif (!this.species) return this.getDefaultResults();\r\n\t\tconst format = this.format;\r\n\t\tconst isHackmons = (format.includes('hackmons') || format.endsWith('bh'));\r\n\t\tconst isAAA = (format === 'almostanyability' || format.includes('aaa'));\r\n\t\tconst dex = this.dex;\r\n\t\tconsole.log('[DEBUG] BattleAbilitySearch.getBaseResults() - species:', this.species, 'dex.modid:', dex.modid);\r\n\t\tlet species = dex.species.get(this.species);\r\n\t\tconsole.log('[DEBUG] Got species:', species.name, 'abilities:', species.abilities);\r\n\t\tlet abilitySet: SearchRow[] = [['header', \"Abilities\"]];\r\n\r\nif (species.isMega) {\r\n\tabilitySet.unshift(['html', `Will be <strong>${species.abilities['0']}</strong> after Mega Evolving.`]);\r\n\tspecies = dex.species.get(species.baseSpecies);\r\n}\r\n\r\nconst a0 = species.abilities['0'];\r\nconst a1 = species.abilities['1'];\r\nconst aH = species.abilities['H'];\r\nconst aS = species.abilities['S'];\r\n\r\n// Your mod: abilities are *sets*.\r\n// Set 1 uses keys 0/1, Set 2 uses keys H/S.\r\nif ((this.formatType as any) === 'indigostarstorm') {\r\n\tabilitySet = [['header', \"Ability Set 1\"]];\r\n\tif (a0) abilitySet.push(['ability', toID(a0)]);\r\n\tif (a1) abilitySet.push(['ability', toID(a1)]);\r\n\r\n\tif (aH || aS) {\r\n\t\tabilitySet.push(['header', \"Ability Set 2\"]);\r\n\t\tif (aH) abilitySet.push(['ability', toID(aH)]);\r\n\t\tif (aS) abilitySet.push(['ability', toID(aS)]);\r\n\t}\r\n} else {\r\n\t// vanilla behavior\r\n\tabilitySet.push(['ability', toID(a0)]);\r\n\tif (a1) abilitySet.push(['ability', toID(a1)]);\r\n\tif (aH) {\r\n\t\tabilitySet.push(['header', \"Hidden Ability\"]);\r\n\t\tabilitySet.push(['ability', toID(aH)]);\r\n\t}\r\n\tif (aS) {\r\n\t\tabilitySet.push(['header', \"Special Event Ability\"]);\r\n\t\tabilitySet.push(['ability', toID(aS)]);\r\n\t}\r\n}\r\n\t\tif (isAAA || format.includes('metronomebattle') || isHackmons) {\r\n\t\t\tlet abilities: ID[] = [];\r\n\t\t\tfor (let i in this.getTable()) {\r\n\t\t\t\tconst ability = dex.abilities.get(i);\r\n\t\t\t\tif (ability.isNonstandard) continue;\r\n\t\t\t\tif (ability.gen > dex.gen) continue;\r\n\t\t\t\tabilities.push(ability.id);\r\n\t\t\t}\r\n\r\n\t\t\tlet goodAbilities: SearchRow[] = [['header', \"Abilities\"]];\r\n\t\t\tlet poorAbilities: SearchRow[] = [['header', \"Situational Abilities\"]];\r\n\t\t\tlet badAbilities: SearchRow[] = [['header', \"Unviable Abilities\"]];\r\n\t\t\tfor (const ability of abilities.sort().map(abil => dex.abilities.get(abil))) {\r\n\t\t\t\tlet rating = ability.rating;\r\n\t\t\t\tif (ability.id === 'normalize') rating = 3;\r\n\t\t\t\tif (rating >= 3) { goodAbilities.push(['ability', ability.id]); } \r\n\t\t\t\telse if (rating >= 2) { poorAbilities.push(['ability', ability.id]); } \r\n\t\t\t\telse { badAbilities.push(['ability', ability.id]); }\r\n\t\t\t}\r\n\t\t\tabilitySet = [...goodAbilities, ...poorAbilities, ...badAbilities];\r\n\t\t\t// species is unused after this, so no need to replace\r\n\t\t\tif (species.isMega) { if (isAAA) { abilitySet.unshift(['html', `Will be <strong>${species.abilities['0']}</strong> after Mega Evolving.`]); } }\r\n\t\t}\r\n\t\treturn abilitySet;\r\n\t}\r\n\tfilter(row: SearchRow, filters: string[][]) {\r\n\t\tif (!filters) return true;\r\n\t\tif (row[0] !== 'ability') return true;\r\n\t\tconst ability = this.dex.abilities.get(row[1]);\r\n\t\tfor (const [filterType, value] of filters) { switch (filterType) {\r\n\t\t\tcase 'pokemon': if (!Dex.hasAbility(this.dex.species.get(value), ability.name)) return false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\tsort(results: SearchRow[], sortCol: string | null, reverseSort?: boolean): SearchRow[] { throw new Error(\"invalid sortcol\"); }\r\n}\r\n//region Item Search\r\nclass BattleItemSearch extends BattleTypedSearch<'item'> {\r\n\tgetTable() { return BattleItems; }\r\n\tgetDefaultResults(): SearchRow[] {\r\n\tlet table: any = BattleTeambuilderTable;\r\n\r\n\tif (this.formatType?.startsWith('bdsp')) {\r\n\t\ttable = table['gen8bdsp'];\r\n\t} else if (this.formatType === 'bw1') {\r\n\t\ttable = table['gen5bw1'];\r\n\t} else if (this.formatType === 'rs') {\r\n\t\ttable = table['gen3rs'];\r\n\t} else if ((this.formatType as any) === 'indigostarstorm') {\r\n\t\t// Use the modded teambuilder table when in ISL format\r\n\t\ttable = table['gen9indigostarstorm'] || table;\r\n\t\t// Fallback if something went wrong and the mod table didn't build items\r\n\t\tif (!table.items && !table.itemSet) table = BattleTeambuilderTable['gen9'] || BattleTeambuilderTable[`gen${this.dex.gen}`];\r\n\t} else if (this.formatType === 'natdex') {\r\n\t\ttable = table[`gen${this.dex.gen}natdex`];\r\n\t} else if (this.formatType?.endsWith('doubles')) {\r\n\t\ttable = table[`gen${this.dex.gen}doubles`];\r\n\t} else if (this.formatType === 'metronome') {\r\n\t\ttable = table[`gen${this.dex.gen}metronome`];\r\n\t} else if (this.dex.gen < 9) {\r\n\t\ttable = table[`gen${this.dex.gen}`];\r\n\t} else {\r\n\t\t// gen9 default\r\n\t\ttable = table['gen9'] || table;\r\n\t}\r\n\r\n\t// Build itemSet once from the correct base table\r\n\tif (!table || (!table.items && !table.itemSet)) return [];\r\n\tif (!table.itemSet) {\r\n\t\ttable.itemSet = table.items.map((r: any) => {\r\n\t\t\tif (typeof r === 'string') return ['item', r];\r\n\t\t\treturn [r[0], r[1]];\r\n\t\t});\r\n\t\ttable.items = null;\r\n\t}\r\n\r\n\treturn table.itemSet;\r\n}\r\n\tgetBaseResults(): SearchRow[] {\r\n\t\tif (!this.species) return this.getDefaultResults();\r\n\t\tconst speciesName = this.dex.species.get(this.species).name;\r\n\t\tconst results = this.getDefaultResults();\r\n\t\tconst speciesSpecific: SearchRow[] = [];\r\n\t\tconst abilitySpecific: SearchRow[] = [];\r\n\t\tconst abilityItem = {\r\n\t\t\tprotosynthesis: 'boosterenergy',\r\n\t\t\tquarkdrive: 'boosterenergy',\r\n\t\t\t// poisonheal: 'toxicorb',\r\n\t\t\t// toxicboost: 'toxicorb',\r\n\t\t\t// flareboost: 'flameorb',\r\n\t\t}[toID(this.set?.ability) as string];\r\n\t\tfor (const row of results) {\r\n\t\t\tif (row[0] !== 'item') continue;\r\n\t\t\tconst item = this.dex.items.get(row[1]);\r\n\t\t\tif (item.itemUser?.includes(speciesName)) speciesSpecific.push(row);\r\n\t\t\tif (abilityItem === item.id) abilitySpecific.push(row);\r\n\t\t}\r\n\t\tif (speciesSpecific.length) {\r\n\t\t\treturn [\r\n\t\t\t\t['header', \"Specific to \" + speciesName],\r\n\t\t\t\t...speciesSpecific,\r\n\t\t\t\t...results,\r\n\t\t\t];\r\n\t\t}\r\n\t\tif (abilitySpecific.length) {\r\n\t\t\treturn [\r\n\t\t\t\t['header', `Specific to ${this.set!.ability!}`],\r\n\t\t\t\t...abilitySpecific,\r\n\t\t\t\t...results,\r\n\t\t\t];\r\n\t\t}\r\n\t\treturn results;\r\n\t}\r\n\toverride defaultFilter(results: SearchRow[]) {\r\n\t\tif (this.species && !this.dex.species.get(this.species).nfe) {\r\n\t\t\tresults.splice(results.findIndex(row => row[1] === 'eviolite'), 1);\r\n\t\t\treturn results;\r\n\t\t}\r\n\t\treturn results;\r\n\t}\r\n\t// Static item class lists\r\n\tstatic fragileItems = new Set(['airballoon', 'focussash', 'powerherb', 'electricseed', 'grassyseed', 'mistyseed', 'psychicseed', 'snowball', 'weaknesspolicy', 'absorbbulb', 'cellbattery', 'luminousmoss', 'mentalherb', 'whiteherb', 'redcard']);\r\n\tstatic volatileItems = new Set(['boosterenergy']);\r\n\tstatic berryItems = new Set(['aguavberry', 'apicotberry', 'aspearberry', 'babiriberry', 'belueberry', 'blukberry', 'chartiberry', 'cheriberry', 'chestoberry', 'chilanberry', 'chopleberry', 'cobaberry', 'colburberry', 'cornnberry', 'custapberry', 'durinberry', 'enigmaberry', 'figyberry', 'ganlonberry', 'grepaberry', 'habanberry', 'hondewberry', 'iapapaberry', 'jabocaberry', 'kasibberry', 'kebiaberry', 'kelpsyberry', 'lansatberry', 'leppaberry', 'liechiberry', 'lumberry', 'magoberry', 'magostberry', 'micleberry', 'nanabberry', 'nomelberry', 'occaberry', 'oranberry', 'pamtreberry', 'passhoberry', 'payapaberry', 'pechaberry', 'persimberry', 'petayaberry', 'pinapberry', 'pomegberry', 'qualotberry', 'rabutaberry', 'rawstberry', 'razzberry', 'rindoberry', 'rowapberry', 'salacberry', 'shucaberry', 'sitrusberry', 'spelonberry', 'starfberry', 'tamatoberry', 'tangaberry', 'wacanberry', 'watmelberry', 'wepearberry', 'wikiberry', 'yacheberry']);\r\n\tstatic pokeballItems = new Set(['pokeball', 'greatball', 'ultraball', 'masterball', 'safariball', 'fastball', 'levelball', 'lureball', 'heavyball', 'loveball', 'friendball', 'moonball', 'sportball', 'netball', 'diveball', 'nestball', 'repeatball', 'timerball', 'luxuryball', 'premierball', 'duskball', 'healball', 'quickball', 'cherishball', 'parkball', 'dreamball', 'beastball']);\r\n\tstatic evolutionItems = new Set(['firestone', 'waterstone', 'thunderstone', 'leafstone', 'moonstone', 'sunstone', 'shinystone', 'duskstone', 'dawnstone', 'everstone', 'linkingcord', 'ovalstone', 'icestone']);\r\n\tstatic tradeEvoItems = new Set(['deepseatooth', 'deepseascale', 'dragonscale', 'electirizer', 'magmarizer', 'metalcoat', 'prismscale', 'protector', 'reapercloth', 'sachet', 'upgrade', 'whippeddream']);\r\n\tstatic consumableItems = new Set(['normalgem', 'fightinggem', 'flyinggem', 'poisongem', 'groundgem', 'rockgem', 'buggem', 'ghostgem', 'steelgem', 'firegem', 'watergem', 'grassgem', 'electricgem', 'psychicgem', 'icegem', 'dragongem', 'darkgem', 'fairygem', 'focusband', 'kingsrock', 'razorclaw', 'razorfang']);\r\n\tgetItemClass(item: any) {\r\n\t\tconst id = item.id;\r\n\t\t// Return canonical IDs (used by search + filters)\r\n\t\tif (BattleItemSearch.fragileItems.has(id)) return 'fragile';\r\n\t\tif (BattleItemSearch.volatileItems.has(id)) return 'volatile';\r\n\t\tif (BattleItemSearch.pokeballItems.has(id)) return 'pokeball';\r\n\t\tif (BattleItemSearch.berryItems.has(id)) return 'berry';\r\n\t\tif (BattleItemSearch.tradeEvoItems.has(id)) return 'tradeevo';\r\n\t\tif (BattleItemSearch.evolutionItems.has(id)) return 'evolution';\r\n\t\tif (BattleItemSearch.consumableItems.has(id)) return 'consumable';\r\n\t\treturn '';\r\n\t}\r\n\tfilter(row: SearchRow, filters: string[][]) {\r\n\t\tif (row[0] !== 'item') return true;\r\n\t\tconst item = this.dex.items.get(row[1]);\r\n\t\tfor (const [filterType, value] of filters) {\r\n\t\t\tif (filterType === 'itemclass') {\r\n\t\t\t\tconst itemClass = this.getItemClass(item);\r\n\t\t\t\tconst v = (value === 'berries' ? 'berry' : value);\r\n\t\t\t\tif (itemClass !== v) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\tsort(results: SearchRow[], sortCol: string | null, reverseSort?: boolean): SearchRow[] { throw new Error(\"invalid sortcol\"); }\r\n}\r\n//region Move Search\r\nclass BattleMoveSearch extends BattleTypedSearch<'move'> {\r\n\toverride sortRow: SearchRow = ['sortmove', ''];\r\n\tgetTable() { return BattleMovedex; }\r\n\tgetDefaultResults(): SearchRow[] {\r\n\t\tlet results: SearchRow[] = [];\r\n\t\tresults.push(['header', \"Moves\"]);\r\n\t\tfor (let id in BattleMovedex) {\r\n\t\t\tswitch (id) {\r\n\t\t\tcase 'paleowave':\r\n\t\t\t\tresults.push(['header', \"CAP moves\"]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'magikarpsrevenge':\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tresults.push(['move', id as ID]);\r\n\t\t}\r\n\t\treturn results;\r\n\t}\r\n\t\tprivate getFlagWeightsForTypes(types: readonly string[]): Record<string, number> {\r\n\t\t// TypeAffinityAversion was exported in teambuilder: exports.TypeAffinityAversion = {...}\r\n\t\t// In the browser, exports === window, so this is available as window.TypeAffinityAversion\r\n\t\tconst table = (window as any).TypeAffinityAversion as Record<string, any> | undefined;\r\n\t\tconst weights: Record<string, number> = {};\r\n\t\tif (!table) return weights;\r\n\r\n\t\tfor (const typeName of types) {\r\n\t\t\tconst entry = table[toID(typeName)];\r\n\t\t\tif (!entry) continue;\r\n\r\n\t\t\t// affinity => +weight\r\n\t\t\tif (entry.affinity) {\r\n\t\t\t\tfor (const flag in entry.affinity) {\r\n\t\t\t\t\tconst w = Number(entry.affinity[flag]) || 0;\r\n\t\t\t\t\tweights[flag] = (weights[flag] || 0) + w;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// aversion => -weight\r\n\t\t\tif (entry.aversion) {\r\n\t\t\t\tfor (const flag in entry.aversion) {\r\n\t\t\t\t\tconst w = Number(entry.aversion[flag]) || 0;\r\n\t\t\t\t\tweights[flag] = (weights[flag] || 0) - w;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn weights;\r\n\t}\r\n\r\n\tprivate getMoveAffinityScore(move: Dex.Move, flagWeights: Record<string, number>): number {\r\n\t\tlet score = 0;\r\n\t\tfor (const flag in (move.flags || {})) {\r\n\t\t\tscore += (flagWeights[flag] || 0);\r\n\t\t}\r\n\t\treturn score;\r\n\t}\r\n\tprivate moveIsNotUseless(id: ID, species: Dex.Species, moves: string[], set: Dex.PokemonSet | null) {\r\n\t\t// Please do not mark moves as useless if there is any doubt whatsoever. I don't care if you think it's clutter or whatever. We are not in the\r\n\t\t// business of taking sides in arguments, or making judgments about specific metagames. If it could potentially be useful in some metagame, it is not useless.\r\n\t\tconst dex = this.dex;\r\n\t\tlet abilityid: ID = set ? toID(set.ability) : '' as ID;\r\n\t\tconst itemid: ID = set ? toID(set.item) : '' as ID;\r\n\t\tif (this.formatType === 'metronome') { if (id === 'metronome') return true; }\r\n\t\tif (itemid === 'pidgeotite') abilityid = 'noguard' as ID;\r\n\t\tif (itemid === 'blastoisinite') abilityid = 'megalauncher' as ID;\r\n\t\tif (itemid === 'aerodactylite') abilityid = 'toughclaws' as ID;\r\n\t\tif (itemid === 'glalitite') abilityid = 'refrigerate' as ID;\r\n\t\tswitch (id) {\r\n\t\tcase 'fakeout': case 'flamecharge': case 'nuzzle': case 'poweruppunch': case 'trailblaze':\r\n\t\t\treturn abilityid !== 'sheerforce';\r\n\t\tcase 'solarbeam': case 'solarblade':\r\n\t\t\treturn ['desolateland', 'drought', 'chlorophyll', 'orichalcumpulse'].includes(abilityid) || itemid === 'powerherb';\r\n\t\tcase 'dynamicpunch': case 'grasswhistle': case 'inferno': case 'sing':\r\n\t\t\treturn abilityid === 'noguard';\r\n\t\tcase 'heatcrash': case 'heavyslam':\r\n\t\t\treturn species.weightkg >= (species.evos ? 75 : 130);\r\n\t\tcase 'aerialace':\r\n\t\t\treturn ['technician', 'toughclaws'].includes(abilityid) && !moves.includes('bravebird');\r\n\t\tcase 'ancientpower':\r\n\t\t\treturn ['serenegrace', 'technician'].includes(abilityid) || !moves.includes('powergem');\r\n\t\tcase 'aquajet':\r\n\t\t\treturn !moves.includes('jetpunch');\r\n\t\tcase 'aurawheel':\r\n\t\t\treturn species.baseSpecies === 'Morpeko';\r\n\t\tcase 'axekick':\r\n\t\t\treturn !moves.includes('highjumpkick');\r\n\t\tcase 'barrier':\r\n\t\t\treturn !moves.includes('acidarmor');\r\n\t\tcase 'bellydrum':\r\n\t\t\treturn moves.includes('aquajet') || moves.includes('jetpunch') || moves.includes('extremespeed') || ['iceface', 'unburden'].includes(abilityid);\r\n\t\tcase 'bulletseed':\r\n\t\t\treturn ['skilllink', 'technician'].includes(abilityid);\r\n\t\tcase 'chillingwater':\r\n\t\t\treturn !moves.includes('scald');\r\n\t\tcase 'counter': case 'mirrorcoat':\r\n\t\t\treturn species.baseStats.hp >= 65;\r\n\t\tcase 'dazzlinggleam':\r\n\t\t\treturn !moves.includes('alluringvoice') || this.formatType?.includes('doubles');\r\n\t\tcase 'darkvoid':\r\n\t\t\treturn dex.gen < 7;\r\n\t\tcase 'dualwingbeat':\r\n\t\t\treturn abilityid === 'technician' || !moves.includes('drillpeck');\r\n\t\tcase 'electroshot':\r\n\t\t\treturn true;\r\n\t\tcase 'feint':\r\n\t\t\treturn abilityid === 'refrigerate';\r\n\t\tcase 'futuresight':\r\n\t\t\treturn dex.gen > 5;\r\n\t\tcase 'grassyglide':\r\n\t\t\treturn abilityid === 'grassysurge';\r\n\t\tcase 'gyroball':\r\n\t\t\treturn species.baseStats.spe <= 60;\r\n\t\tcase 'headbutt':\r\n\t\t\treturn abilityid === 'serenegrace';\r\n\t\tcase 'hex':\r\n\t\t\treturn !moves.includes('infernalparade');\r\n\t\tcase 'hiddenpowerelectric':\r\n\t\t\treturn !(dex.gen < 4 && moves.includes('thunderpunch')) && !moves.includes('thunderbolt');\r\n\t\tcase 'hiddenpowerfighting':\r\n\t\t\treturn !(dex.gen < 4 && moves.includes('brickbreak')) && !moves.includes('aurasphere') && !moves.includes('focusblast');\r\n\t\tcase 'hiddenpowerfire':\r\n\t\t\treturn !(dex.gen < 4 && moves.includes('firepunch')) && !moves.includes('flamethrower') && !moves.includes('mysticalfire') && !moves.includes('burningjealousy');\r\n\t\tcase 'hiddenpowergrass':\r\n\t\t\treturn !(dex.gen < 4 && moves.includes('leafblade')) || (dex.gen > 3 && !moves.includes('energyball') && !moves.includes('grassknot') && !moves.includes('gigadrain'));\r\n\t\tcase 'hiddenpowerice':\r\n\t\t\treturn !moves.includes('icebeam') && (dex.gen < 4 && !moves.includes('icepunch')) || (dex.gen > 5 && !moves.includes('aurorabeam') && !moves.includes('glaciate'));\r\n\t\tcase 'hiddenpowerflying':\r\n\t\t\treturn dex.gen < 4 && !moves.includes('drillpeck');\r\n\t\tcase 'hiddenpowerbug':\r\n\t\t\treturn dex.gen < 4 && !moves.includes('megahorn');\r\n\t\tcase 'hiddenpowerpsychic':\r\n\t\t\treturn species.baseSpecies === 'Unown';\r\n\t\tcase 'hyperspacefury':\r\n\t\t\treturn species.id === 'hoopaunbound';\r\n\t\tcase 'hypnosis':\r\n\t\t\treturn (dex.gen < 4 && !moves.includes('sleeppowder')) || (dex.gen > 6 && abilityid === 'baddreams');\r\n\t\tcase 'icepunch':\r\n\t\t\treturn !moves.includes('icespinner') || ['sheerforce', 'ironfist'].includes(abilityid) || itemid === 'punchingglove';\r\n\t\tcase 'iciclecrash':\r\n\t\t\treturn !moves.includes('mountaingale');\r\n\t\tcase 'iciclespear':\r\n\t\t\treturn dex.gen > 3;\r\n\t\tcase 'icywind':\r\n\t\t\t// Keldeo needs Hidden Power for Electric/Ghost\r\n\t\t\treturn species.baseSpecies === 'Keldeo' || this.isDoubles;\r\n\t\tcase 'infestation':\r\n\t\t\treturn moves.includes('stickyweb');\r\n\t\tcase 'irondefense':\r\n\t\t\treturn !moves.includes('acidarmor') && !moves.includes('barrier');\r\n\t\tcase 'irontail':\r\n\t\t\treturn dex.gen > 5 && !moves.includes('ironhead') && !moves.includes('gunkshot') && !moves.includes('poisonjab');\r\n\t\tcase 'jumpkick':\r\n\t\t\treturn !moves.includes('highjumpkick') && !moves.includes('axekick');\r\n\t\tcase 'lastresort':\r\n\t\t\treturn set && set.moves.length < 3;\r\n\t\tcase 'leafblade':\r\n\t\t\treturn true;\r\n\t\tcase 'leechlife':\r\n\t\t\treturn dex.gen > 6;\r\n\t\tcase 'magiccoat':\r\n\t\t\treturn dex.gen > 3;\r\n\t\tcase 'meteorbeam':\r\n\t\t\treturn true;\r\n\t\tcase 'mysticalfire':\r\n\t\t\treturn dex.gen > 6 && !moves.includes('flamethrower');\r\n\t\tcase 'naturepower':\r\n\t\t\treturn dex.gen === 5;\r\n\t\tcase 'needlearm':\r\n\t\t\treturn dex.gen < 4;\r\n\t\tcase 'nightslash':\r\n\t\t\treturn !moves.includes('crunch') && !(moves.includes('knockoff') && dex.gen >= 6);\r\n\t\tcase 'outrage':\r\n\t\t\treturn dex.gen > 3 && !moves.includes('glaiverush');\r\n\t\tcase 'petaldance':\r\n\t\t\treturn abilityid === 'owntempo';\r\n\t\tcase 'phantomforce':\r\n\t\t\treturn (!moves.includes('poltergeist') && !moves.includes('shadowclaw')) || this.isDoubles;\r\n\t\tcase 'poisonfang':\r\n\t\t\treturn species.types.includes('Poison') && !moves.includes('gunkshot') && !moves.includes('poisonjab');\r\n\t\tcase 'raindance':\r\n\t\t\treturn dex.gen < 4;\r\n\t\tcase 'relicsong':\r\n\t\t\treturn species.id === 'meloetta';\r\n\t\tcase 'refresh':\r\n\t\t\treturn !moves.includes('aromatherapy') && !moves.includes('healbell');\r\n\t\tcase 'risingvoltage':\r\n\t\t\treturn abilityid === 'electricsurge' || abilityid === 'hadronengine';\r\n\t\tcase 'rocktomb':\r\n\t\t\treturn abilityid === 'technician';\r\n\t\tcase 'selfdestruct':\r\n\t\t\treturn dex.gen < 5 && !moves.includes('explosion');\r\n\t\tcase 'shadowpunch':\r\n\t\t\treturn abilityid === 'ironfist' && !moves.includes('ragefist');\r\n\t\tcase 'shelter':\r\n\t\t\treturn !moves.includes('acidarmor') && !moves.includes('irondefense');\r\n\t\tcase 'skyuppercut':\r\n\t\t\treturn dex.gen < 4;\r\n\t\tcase 'smackdown':\r\n\t\t\treturn species.types.includes('Ground');\r\n\t\tcase 'smartstrike':\r\n\t\t\treturn species.types.includes('Steel') && !moves.includes('ironhead');\r\n\t\tcase 'soak':\r\n\t\t\treturn abilityid === 'unaware';\r\n\t\tcase 'steelwing':\r\n\t\t\treturn !moves.includes('ironhead');\r\n\t\tcase 'stompingtantrum':\r\n\t\t\treturn (!moves.includes('earthquake') && !moves.includes('drillrun')) || this.isDoubles;\r\n\t\tcase 'stunspore':\r\n\t\t\treturn !moves.includes('thunderwave');\r\n\t\tcase 'sunnyday':\r\n\t\t\treturn dex.gen < 4;\r\n\t\tcase 'technoblast':\r\n\t\t\treturn dex.gen > 5 && itemid.endsWith('drive') || itemid === 'dousedrive';\r\n\t\tcase 'teleport':\r\n\t\t\treturn dex.gen > 7;\r\n\t\tcase 'temperflare':\r\n\t\t\treturn (!moves.includes('flareblitz') && !moves.includes('pyroball') && !moves.includes('sacredfire') && !moves.includes('bitterblade') && !moves.includes('firepunch')) || this.isDoubles;\r\n\t\tcase 'terrainpulse': case 'waterpulse':\r\n\t\t\treturn ['megalauncher', 'technician'].includes(abilityid) && !moves.includes('originpulse');\r\n\t\tcase 'thief':\r\n\t\t\treturn dex.gen === 2;\r\n\t\tcase 'toxicspikes':\r\n\t\t\treturn abilityid !== 'toxicdebris';\r\n\t\tcase 'triattack':\r\n\t\t\treturn dex.gen > 3;\r\n\t\tcase 'trickroom':\r\n\t\t\treturn species.baseStats.spe <= 100;\r\n\t\tcase 'wildcharge':\r\n\t\t\treturn !moves.includes('supercellslam');\r\n\t\tcase 'zapcannon':\r\n\t\t\treturn abilityid === 'noguard' || (dex.gen < 4 && !moves.includes('thunderwave'));\r\n\t\t}\r\n\t\tif (this.isDoubles && BattleMoveSearch.GOOD_DOUBLES_MOVES.includes(id)) { return true; }\r\n\t\tconst move = dex.moves.get(id);\r\n\t\tif (!move.exists) return true;\r\n\t\tif (move.category === 'Status') { return BattleMoveSearch.GOOD_STATUS_MOVES.includes(id); }\r\n\t\tif (move.basePower < 75) { return BattleMoveSearch.GOOD_WEAK_MOVES.includes(id) || (abilityid === 'technician' && move.basePower === 60); }\r\n\t\tif (id === 'skydrop') return true;\r\n\t\tif (move.flags['charge']) { return itemid === 'powerherb'; }\r\n\t\tif (move.flags['recharge']) { return false; }\r\n\t\tif (move.flags['slicing'] && abilityid === 'sharpness') { return true; }\r\n\t\treturn !BattleMoveSearch.BAD_STRONG_MOVES.includes(id);\r\n\t}\r\n\tstatic readonly GOOD_STATUS_MOVES = [\r\n\t\t'acidarmor', 'agility', 'aromatherapy', 'auroraveil', 'autotomize', 'banefulbunker', 'batonpass', 'bellydrum', 'bulkup', 'burningbulwark', 'calmmind', 'chillyreception', 'clangoroussoul', 'coil', 'cottonguard', 'courtchange', 'curse', 'defog', 'destinybond', 'detect', 'disable', 'dragondance', 'encore', 'extremeevoboost', 'filletaway', 'geomancy', 'glare', 'haze', 'healbell', 'healingwish', 'healorder', 'heartswap', 'honeclaws', 'kingsshield', 'leechseed', 'lightscreen', 'lovelykiss', 'lunardance', 'magiccoat', 'maxguard', 'memento', 'milkdrink', 'moonlight', 'morningsun', 'nastyplot', 'naturesmadness', 'noretreat', 'obstruct', 'painsplit', 'partingshot', 'perishsong', 'protect', 'quiverdance', 'recover', 'reflect', 'reflecttype', 'rest', 'revivalblessing', 'roar', 'rockpolish', 'roost', 'shedtail', 'shellsmash', 'shiftgear', 'shoreup', 'silktrap', 'slackoff', 'sleeppowder', 'sleeptalk', 'softboiled', 'spikes', 'spikyshield', 'spore', 'stealthrock', 'stickyweb', 'strengthsap', 'substitute', 'switcheroo', 'swordsdance', 'synthesis', 'tailglow', 'tailwind', 'taunt', 'thunderwave', 'tidyup', 'toxic', 'transform', 'trick', 'victorydance', 'whirlwind', 'willowisp', 'wish', 'yawn',\r\n\t] as ID[] as readonly ID[];\r\n\tstatic readonly GOOD_WEAK_MOVES = [\r\n\t\t'accelerock', 'acrobatics', 'aquacutter', 'avalanche', 'barbbarrage', 'bonemerang', 'bouncybubble', 'bulletpunch', 'buzzybuzz', 'ceaselessedge', 'circlethrow', 'clearsmog', 'doubleironbash', 'dragondarts', 'dragontail', 'drainingkiss', 'endeavor', 'facade', 'firefang', 'flipturn', 'flowertrick', 'freezedry', 'frustration', 'geargrind', 'gigadrain', 'grassknot', 'gyroball', 'icefang', 'iceshard', 'iciclespear', 'infernalparade', 'knockoff', 'lastrespects', 'lowkick', 'machpunch', 'mortalspin', 'mysticalpower', 'naturesmadness', 'nightshade', 'nuzzle', 'pikapapow', 'populationbomb', 'psychocut', 'psyshieldbash', 'pursuit', 'quickattack', 'ragefist', 'rapidspin', 'return', 'rockblast', 'ruination', 'saltcure', 'scorchingsands', 'seismictoss', 'shadowclaw', 'shadowsneak', 'sizzlyslide', 'stoneaxe', 'storedpower', 'stormthrow', 'suckerpunch', 'superfang', 'surgingstrikes', 'tachyoncutter', 'tailslap', 'thunderclap', 'tripleaxel', 'tripledive', 'twinbeam', 'uturn', 'vacuumwave', 'veeveevolley', 'voltswitch', 'watershuriken', 'weatherball',\r\n\t] as ID[] as readonly ID[];\r\n\tstatic readonly BAD_STRONG_MOVES = [\r\n\t\t'belch', 'burnup', 'crushclaw', 'dragonrush', 'dreameater', 'eggbomb', 'firepledge', 'flyingpress', 'futuresight', 'grasspledge', 'hyperbeam', 'hyperfang', 'hyperspacehole', 'jawlock', 'landswrath', 'megakick', 'megapunch', 'mistyexplosion', 'muddywater', 'nightdaze', 'pollenpuff', 'rockclimb', 'selfdestruct', 'shelltrap', 'skyuppercut', 'slam', 'strength', 'submission', 'synchronoise', 'takedown', 'thrash', 'uproar', 'waterpledge',\r\n\t] as ID[] as readonly ID[];\r\n\tstatic readonly GOOD_DOUBLES_MOVES = [\r\n\t\t'allyswitch', 'bulldoze', 'coaching', 'electroweb', 'faketears', 'fling', 'followme', 'healpulse', 'helpinghand', 'junglehealing', 'lifedew', 'lunarblessing', 'muddywater', 'pollenpuff', 'psychup', 'ragepowder', 'safeguard', 'skillswap', 'snipeshot', 'wideguard', 'decorate', 'snarl',\r\n\t] as ID[] as readonly ID[];\r\n\tgetBaseResults() {\r\n\t\tif (!this.species) return this.getDefaultResults();\r\n\t\tconst dex = this.dex;\r\n\t\tlet species = dex.species.get(this.species);\r\n\t\tconst format = this.format;\r\n\t\tconst isHackmons = (format.includes('hackmons') || format.endsWith('bh'));\r\n\t\tconst isSTABmons = (format.includes('stabmons') || format === 'staaabmons');\r\n\t\tconst isTradebacks = format.includes('tradebacks');\r\n\t\tconst regionBornLegality = dex.gen >= 6 && (/^battle(spot|stadium|festival)/.test(format) || format.startsWith('bss') || format.startsWith('vgc') || (dex.gen === 9 && this.formatType !== 'natdex'));\r\n\t\tlet learnsetid = this.firstLearnsetid(species.id);\r\n\t\tlet moves: string[] = [];\r\n\t\tlet sketchMoves: string[] = [];\r\n\t\tlet sketch = false;\r\n\t\tlet gen = `${dex.gen}`;\r\n\t\tlet lsetTable = BattleTeambuilderTable;\r\n\t\tif (this.formatType?.startsWith('bdsp')) lsetTable = lsetTable['gen8bdsp'];\r\n\t\tif (this.formatType === 'letsgo') lsetTable = lsetTable['gen7letsgo'];\r\n\t\tif (this.formatType === 'bw1') lsetTable = lsetTable['gen5bw1'];\r\n\t\tif (this.formatType === 'rs') lsetTable = lsetTable['gen3rs'];\r\n\t\tif (this.formatType?.startsWith('ssdlc1')) lsetTable = lsetTable['gen8dlc1'];\r\n\t\tif ((this.formatType as any) === 'indigostarstorm') lsetTable = lsetTable['gen9indigostarstorm'] || lsetTable;\r\n\t\tif (this.formatType?.startsWith('predlc')) lsetTable = lsetTable['gen9predlc'];\r\n\t\tif (this.formatType?.startsWith('svdlc1')) lsetTable = lsetTable['gen9dlc1'];\r\n\t\tif ((this.formatType as any) === 'indigostarstorm') lsetTable = lsetTable['gen9indigostarstorm'] || lsetTable;\r\n\t\tconsole.log('[DEBUG getMovesList] formatType:', this.formatType, 'has learnsets?', !!lsetTable?.learnsets);\r\n\t\twhile (learnsetid) {\r\n\t\t\tlet learnset = lsetTable.learnsets[learnsetid];\r\n\t\t\tconsole.log('[DEBUG getMovesList] learnsetid:', learnsetid, 'has learnset?', !!learnset, 'move count:', learnset ? Object.keys(learnset).length : 0);\r\n\t\t\tif (learnset) {\r\n\t\t\t\tfor (let moveid in learnset) {\r\n\t\t\t\t\tlet learnsetEntry = learnset[moveid];\r\n\t\t\t\t\tconst move = dex.moves.get(moveid);\r\n\t\t\t\t\tconst minGenCode: { [gen: number]: string } = { 6: 'p', 7: 'q', 8: 'g', 9: 'a' };\r\n\t\t\t\t\tif (regionBornLegality && !learnsetEntry.includes(minGenCode[dex.gen])) { continue; }\r\n\t\t\t\t\tif (this.eggMovesOnly(learnsetid, species.id) &&(!learnsetEntry.includes('e') || dex.gen !== 9)) { continue; }\r\n\t\t\t\t\tif (!learnsetEntry.includes(gen) && (!isTradebacks ? true : !(move.gen <= dex.gen && learnsetEntry.includes(`${dex.gen + 1}`))) ) { continue; }\r\n\t\t\t\t\tif (this.formatType !== 'natdex' && move.isNonstandard === \"Past\") { continue; }\r\n\t\t\t\t\tif (this.formatType?.startsWith('dlc1') && BattleTeambuilderTable['gen8dlc1']?.nonstandardMoves.includes(moveid)) { continue; }\r\n\t\t\t\t\tif (this.formatType?.includes('predlc') && this.formatType !== 'predlcnatdex' && BattleTeambuilderTable['gen9predlc']?.nonstandardMoves.includes(moveid)) { continue; }\r\n\t\t\t\t\tif (this.formatType?.includes('svdlc1') && this.formatType !== 'svdlc1natdex' && BattleTeambuilderTable['gen9dlc1']?.nonstandardMoves.includes(moveid)) { continue; }\r\n\t\t\t\t\tif (moves.includes(moveid)) continue;\r\n\t\t\t\t\tmoves.push(moveid);\r\n\t\t\t\t\tif (moveid === 'sketch') sketch = true;\r\n\t\t\t\t\tif (moveid === 'hiddenpower') {moves.push('hiddenpowerbug', 'hiddenpowerdark', 'hiddenpowerdragon', 'hiddenpowerelectric', 'hiddenpowerfighting', 'hiddenpowerfire', 'hiddenpowerflying', 'hiddenpowerghost', 'hiddenpowergrass', 'hiddenpowerground', 'hiddenpowerice', 'hiddenpowerpoison', 'hiddenpowerpsychic', 'hiddenpowerrock', 'hiddenpowersteel', 'hiddenpowerwater');}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlearnsetid = this.nextLearnsetid(learnsetid, species.id, true);\r\n\t\t}\r\n\t\tif (sketch || isHackmons) {\r\n\t\t\tif (isHackmons) moves = [];\r\n\t\t\tfor (let id in BattleMovedex) {\r\n\t\t\t\tif (!format.startsWith('cap') && (id === 'paleowave' || id === 'shadowstrike')) continue;\r\n\t\t\t\tconst move = dex.moves.get(id);\r\n\t\t\t\tif (move.gen > dex.gen) continue;\r\n\t\t\t\tif (sketch) {\r\n\t\t\t\t\tif (move.flags['nosketch'] || move.isMax || move.isZ) continue;\r\n\t\t\t\t\tif (move.isNonstandard && move.isNonstandard !== 'Past') continue;\r\n\t\t\t\t\tif (move.isNonstandard === 'Past' && this.formatType !== 'natdex') continue;\r\n\t\t\t\t\tsketchMoves.push(move.id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!(dex.gen < 8 || this.formatType === 'natdex') && move.isZ) continue;\r\n\t\t\t\t\tif (typeof move.isMax === 'string') continue;\r\n\t\t\t\t\tif (move.isMax && dex.gen > 8) continue;\r\n\t\t\t\t\tif (move.isNonstandard === 'Past' && this.formatType !== 'natdex') continue;\r\n\t\t\t\t\tif (move.isNonstandard === 'LGPE' && this.formatType !== 'letsgo') continue;\r\n\t\t\t\t\tmoves.push(move.id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.formatType === 'metronome') moves = ['metronome'];\r\n\t\tif (isSTABmons) {\r\n\t\t\tfor (let id in this.getTable()) {\r\n\t\t\t\tconst move = dex.moves.get(id);\r\n\t\t\t\tif (moves.includes(move.id)) continue;\r\n\t\t\t\tif (move.gen > dex.gen) continue;\r\n\t\t\t\tif (move.isZ || move.isMax || (move.isNonstandard && move.isNonstandard !== 'Unobtainable')) continue;\r\n\t\t\t\tconst speciesTypes: string[] = [];\r\n\t\t\t\tconst moveTypes: string[] = [];\r\n\t\t\t\tfor (let i = dex.gen; i >= species.gen && i >= move.gen; i--) {\r\n\t\t\t\t\tconst genDex = Dex.forGen(i);\r\n\t\t\t\t\tmoveTypes.push(genDex.moves.get(move.name).type);\r\n\t\t\t\t\tconst pokemon = genDex.species.get(species.name);\r\n\t\t\t\t\tlet baseSpecies = genDex.species.get(pokemon.changesFrom || pokemon.name);\r\n\t\t\t\t\tif (!pokemon.battleOnly) speciesTypes.push(...pokemon.types);\r\n\t\t\t\t\tlet prevo = pokemon.prevo;\r\n\t\t\t\t\twhile (prevo) {\r\n\t\t\t\t\t\tconst prevoSpecies = genDex.species.get(prevo);\r\n\t\t\t\t\t\tspeciesTypes.push(...prevoSpecies.types);\r\n\t\t\t\t\t\tprevo = prevoSpecies.prevo;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (pokemon.battleOnly && typeof pokemon.battleOnly === 'string') { species = dex.species.get(pokemon.battleOnly); }\r\n\t\t\t\t\tconst excludedForme = (s: Dex.Species) => [ 'Alola', 'Alola-Totem', 'Galar', 'Galar-Zen', 'Hisui', 'Paldea', 'Paldea-Combat', 'Paldea-Blaze', 'Paldea-Aqua', ].includes(s.forme);\r\n\t\t\t\t\tif (baseSpecies.otherFormes && !['Wormadam', 'Urshifu'].includes(baseSpecies.baseSpecies)) {\r\n\t\t\t\t\t\tif (!excludedForme(species)) speciesTypes.push(...baseSpecies.types);\r\n\t\t\t\t\t\tfor (const formeName of baseSpecies.otherFormes) {\r\n\t\t\t\t\t\t\tconst forme = dex.species.get(formeName);\r\n\t\t\t\t\t\t\tif (!forme.battleOnly && !excludedForme(forme)) speciesTypes.push(...forme.types);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet valid = false;\r\n\t\t\t\tfor (let type of moveTypes) { if (speciesTypes.includes(type)) {\r\n\t\t\t\t\tvalid = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (valid) moves.push(id);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\t\tmoves.sort();\r\n\t\tsketchMoves.sort();\r\n\r\n\t\t// Build weights for this Pokemon's typing\r\n\t\tconst flagWeights = this.getFlagWeightsForTypes(species.types);\r\n\r\n\t\ttype Scored = { id: ID; score: number };\r\n\t\tconst affinity: Scored[] = [];\r\n\t\tconst neutral: Scored[] = [];\r\n\t\tconst aversion: Scored[] = [];\r\n\r\n\t\t// Keep current inclusion behavior: learned moves + sketch moves\r\n\t\tconst allMoveIds: ID[] = [\r\n\t\t\t...moves.map(x => x as ID),\r\n\t\t\t...sketchMoves.map(x => x as ID),\r\n\t\t];\r\n\r\n\t\tfor (const id of allMoveIds) {\r\n\t\t\tconst move = dex.moves.get(id);\r\n\t\t\tconst score = this.getMoveAffinityScore(move, flagWeights);\r\n\t\t\tconst entry = { id, score };\r\n\r\n\t\t\tif (score > 0) affinity.push(entry);\r\n\t\t\telse if (score < 0) aversion.push(entry);\r\n\t\t\telse neutral.push(entry);\r\n\t\t}\r\n\r\n\t\t// Sort: score desc for Affinity, score asc (most negative first) for Aversion, id tie-break\r\n\t\taffinity.sort((a, b) => (b.score - a.score) || (a.id < b.id ? -1 : a.id > b.id ? 1 : 0));\r\n\t\tneutral.sort((a, b) => (a.id < b.id ? -1 : a.id > b.id ? 1 : 0));\r\n\t\taversion.sort((a, b) => (a.score - b.score) || (a.id < b.id ? -1 : a.id > b.id ? 1 : 0));\r\n\r\n\t\tconst out: SearchRow[] = [];\r\n\t\tif (affinity.length) {\r\n\t\t\tout.push(['header', 'Affinity']);\r\n\t\t\tout.push(...affinity.map(x => ['move', x.id] as SearchRow));\r\n\t\t}\r\n\t\tif (neutral.length) {\r\n\t\t\tout.push(['header', 'Neutral']);\r\n\t\t\tout.push(...neutral.map(x => ['move', x.id] as SearchRow));\r\n\t\t}\r\n\t\tif (aversion.length) {\r\n\t\t\tout.push(['header', 'Aversion']);\r\n\t\t\tout.push(...aversion.map(x => ['move', x.id] as SearchRow));\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\tfilter(row: SearchRow, filters: string[][]) {\r\n\t\tif (!filters) return true;\r\n\t\tif (row[0] !== 'move') return true;\r\n\t\tconst move = this.dex.moves.get(row[1]);\r\n\t\tfor (const [filterType, value] of filters) {\r\n\t\t\tswitch (filterType) {\r\n\t\t\tcase 'type': {\r\n\t\t\t\tconst type2 = (move as any).type2 as string | undefined;\r\n\t\t\t\tif (move.type !== value && type2 !== value) return false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase 'category': if (move.category !== value) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'flag': if (!(value in move.flags)) return false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pokemon': if (!this.canLearn(value as ID, move.id)) return false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\tsort(results: SearchRow[], sortCol: string, reverseSort?: boolean): SearchRow[] {\r\n\t\tconst sortOrder = reverseSort ? -1 : 1;\r\n\t\tswitch (sortCol) {\r\n\t\tcase 'power':\r\n\t\t\tlet powerTable: { [id: string]: number | undefined } = {\r\n\t\t\t\treturn: 102, frustration: 102, spitup: 300, trumpcard: 200, naturalgift: 80, grassknot: 120,\r\n\t\t\t\tlowkick: 120, gyroball: 150, electroball: 150, flail: 200, reversal: 200, present: 120,\r\n\t\t\t\twringout: 120, crushgrip: 120, heatcrash: 120, heavyslam: 120, fling: 130, magnitude: 150,\r\n\t\t\t\tbeatup: 24, punishment: 1020, psywave: 1250, nightshade: 1200, seismictoss: 1200,\r\n\t\t\t\tdragonrage: 1140, sonicboom: 1120, superfang: 1350, endeavor: 1399, sheercold: 1501,\r\n\t\t\t\tfissure: 1500, horndrill: 1500, guillotine: 1500,\r\n\t\t\t};\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tlet move1 = this.dex.moves.get(id1);\r\n\t\t\t\tlet move2 = this.dex.moves.get(id2);\r\n\t\t\t\tlet pow1 = move1.basePower || powerTable[id1] || (move1.category === 'Status' ? -1 : 1400);\r\n\t\t\t\tlet pow2 = move2.basePower || powerTable[id2] || (move2.category === 'Status' ? -1 : 1400);\r\n\t\t\t\treturn (pow2 - pow1) * sortOrder;\r\n\t\t\t});\r\n\t\tcase 'accuracy':\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tlet accuracy1 = this.dex.moves.get(id1).accuracy || 0;\r\n\t\t\t\tlet accuracy2 = this.dex.moves.get(id2).accuracy || 0;\r\n\t\t\t\tif (accuracy1 === true) accuracy1 = 101;\r\n\t\t\t\tif (accuracy2 === true) accuracy2 = 101;\r\n\t\t\t\treturn (accuracy2 - accuracy1) * sortOrder;\r\n\t\t\t});\r\n\t\tcase 'crit':\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tconst m1 = this.dex.moves.get(id1);\r\n\t\t\t\tconst m2 = this.dex.moves.get(id2);\r\n\r\n\t\t\t\t// Your mod: \"base\" crit is critRatio 4 (+0). Fallback to 4 if unset.\r\n\t\t\t\tconst c1 = (m1.critRatio ?? 4);\r\n\t\t\t\tconst c2 = (m2.critRatio ?? 4);\r\n\r\n\t\t\t\t// Default (1st click) should be highest -> lowest (same convention as power/acc/pp)\r\n\t\t\t\tif (c2 !== c1) return (c2 - c1) * sortOrder;\r\n\r\n\t\t\t\t// Tie-break by name for stable ordering\r\n\t\t\t\treturn (id1 < id2 ? -1 : id1 > id2 ? 1 : 0) * sortOrder;\r\n\t\t\t});\r\n\t\tcase 'pp':\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tlet pp1 = this.dex.moves.get(id1).pp || 0;\r\n\t\t\t\tlet pp2 = this.dex.moves.get(id2).pp || 0;\r\n\t\t\t\treturn (pp2 - pp1) * sortOrder;\r\n\t\t\t});\r\n\t\tcase 'flags:':\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tconst f1 = Object.keys(this.dex.moves.get(id1).flags || {}).sort().join(',');\r\n\t\t\t\tconst f2 = Object.keys(this.dex.moves.get(id2).flags || {}).sort().join(',');\r\n\t\t\t\tif (f1 !== f2) return (f1 < f2 ? -1 : 1) * sortOrder;\r\n\t\t\t\treturn (id1 < id2 ? -1 : id1 > id2 ? 1 : 0) * sortOrder;\r\n\t\t\t});\r\n\t\tcase 'name':\r\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\r\n\t\t\t\tconst name1 = id1;\r\n\t\t\t\tconst name2 = id2;\r\n\t\t\t\treturn (name1 < name2 ? -1 : name1 > name2 ? 1 : 0) * sortOrder;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthrow new Error(\"invalid sortcol\");\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t//region Category Search                      \r\n\tclass BattleCategorySearch extends BattleTypedSearch<'category'> {\r\n\t\tgetTable() { return { physical: 1, special: 1, status: 1 }; }\r\n\t\tgetDefaultResults(reverseSort?: boolean): SearchRow[] {\r\n\t\t\tconst results: SearchRow[] = [\r\n\t\t\t\t['category', 'physical' as ID],\r\n\t\t\t\t['category', 'special' as ID],\r\n\t\t\t\t['category', 'status' as ID],\r\n\t\t\t];\r\n\t\t\tif (reverseSort) results.reverse();\r\n\t\t\treturn results;\r\n\t\t}\r\n\t\tgetBaseResults() { return this.getDefaultResults(); }\r\n\t\tfilter(row: SearchRow, filters: string[][]): boolean { throw new Error(\"invalid filter\"); }\r\n\t\tsort(results: SearchRow[], sortCol: string | null, reverseSort?: boolean): SearchRow[] { throw new Error(\"invalid sortcol\"); }\r\n\t}\r\n\t//region Flag Search\r\n\tclass BattleFlagSearch extends BattleTypedSearch<'flag'> {\r\n\t\tgetTable() {\r\n\t\t\treturn {\r\n\t\t\t\tcontact: 1, binding: 1, bite: 1, bomb: 1, bullet: 1,\r\n\t\t\t\tdrain: 1, explosive: 1, fist: 1, powder: 1, pulse: 1, slicing: 1, sound: 1,\r\n\t\t\t\twind: 1, airborne: 1, aura: 1, beam: 1, breath: 1, claw: 1, crash: 1, crush: 1,\r\n\t\t\t\tkick: 1, launch: 1, light: 1, lunar: 1, magic: 1, pierce: 1, shadow: 1,\r\n\t\t\t\tsolar: 1, spin: 1, sweep: 1, throw: 1, weapon: 1, wing: 1, bypassprotect: 1,\r\n\t\t\t\tnonreflectable: 1, nonmirror: 1, nonsnatchable: 1, bypasssubstitute: 1, maxmove: 1, gmaxmove: 1, zmove: 1\r\n\t\t\t};\r\n\t\t}\r\n\t\tgetDefaultResults(reverseSort?: boolean): SearchRow[] {\r\n\t\t\tconst results: SearchRow[] = [\r\n\t\t\t\t['flag', 'contact' as ID],\r\n\t\t\t\t['flag', 'binding' as ID],\r\n\t\t\t\t['flag', 'bite' as ID],\r\n\t\t\t\t['flag', 'bomb' as ID],\r\n\t\t\t\t['flag', 'bullet' as ID],\r\n\t\t\t\t['flag', 'drain' as ID],\r\n\t\t\t\t['flag', 'explosive' as ID],\r\n\t\t\t\t['flag', 'fist' as ID],\r\n\t\t\t\t['flag', 'powder' as ID],\r\n\t\t\t\t['flag', 'pulse' as ID],\r\n\t\t\t\t['flag', 'slicing' as ID],\r\n\t\t\t\t['flag', 'sound' as ID],\r\n\t\t\t\t['flag', 'wind' as ID],\r\n\t\t\t\t['flag', 'airborne' as ID],\r\n\t\t\t\t['flag', 'aura' as ID],\r\n\t\t\t\t['flag', 'beam' as ID],\r\n\t\t\t\t['flag', 'breath' as ID],\r\n\t\t\t\t['flag', 'claw' as ID],\r\n\t\t\t\t['flag', 'crash' as ID],\r\n\t\t\t\t['flag', 'crush' as ID],\r\n\t\t\t\t['flag', 'kick' as ID],\r\n\t\t\t\t['flag', 'launch' as ID],\r\n\t\t\t\t['flag', 'light' as ID],\r\n\t\t\t\t['flag', 'lunar' as ID],\r\n\t\t\t\t['flag', 'magic' as ID],\r\n\t\t\t\t['flag', 'pierce' as ID],\r\n\t\t\t\t['flag', 'shadow' as ID],\r\n\t\t\t\t['flag', 'solar' as ID],\r\n\t\t\t\t['flag', 'spin' as ID],\r\n\t\t\t\t['flag', 'sweep' as ID],\r\n\t\t\t\t['flag', 'throw' as ID],\r\n\t\t\t\t['flag', 'weapon' as ID],\r\n\t\t\t\t['flag', 'wing' as ID],\r\n\t\t\t\t['flag', 'bypassprotect' as ID],\r\n\t\t\t\t['flag', 'nonreflectable' as ID],\r\n\t\t\t\t['flag', 'nonmirror' as ID],\r\n\t\t\t\t['flag', 'nonsnatchable' as ID],\r\n\t\t\t\t['flag', 'bypasssubstitute' as ID],\r\n\t\t\t\t['flag', 'maxmove' as ID],\r\n\t\t\t\t['flag', 'gmaxmove' as ID],\r\n\t\t\t\t['flag', 'zmove' as ID],\r\n\t\t\t];\r\n\t\t\tif (reverseSort) results.reverse();\r\n\t\t\treturn results;\r\n\t\t}\r\n\t\tgetBaseResults() { return this.getDefaultResults(); }\r\n\t\tfilter(row: SearchRow, filters: string[][]): boolean { throw new Error(\"invalid filter\"); }\r\n\t\tsort(results: SearchRow[], sortCol: string | null, reverseSort?: boolean): SearchRow[] { throw new Error(\"invalid sortcol\"); }\r\n\t}\r\n\t//region Type Search\r\n\tclass BattleTypeSearch extends BattleTypedSearch<'type'> {\r\n\t\tgetTable() { return window.BattleTypeChart; }\r\n\t\tgetDefaultResults(reverseSort?: boolean): SearchRow[] {\r\n\t\t\tconst results: SearchRow[] = [];\r\n\t\t\tfor (let id in window.BattleTypeChart) { results.push(['type', id as ID]); }\r\n\t\t\tif (reverseSort) results.reverse();\r\n\t\t\treturn results;\r\n\t\t}\r\n\t\tgetBaseResults() { return this.getDefaultResults(); }\r\n\t\tfilter(row: SearchRow, filters: string[][]): boolean { throw new Error(\"invalid filter\"); }\r\n\t\tsort(results: SearchRow[], sortCol: string | null, reverseSort?: boolean): SearchRow[] { throw new Error(\"invalid sortcol\"); }\r\n\t}"],"mappings":"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","ignoreList":[]}